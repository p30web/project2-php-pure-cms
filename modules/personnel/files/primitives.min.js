/*
 Basic Primitives Diagram v5.0.4
 Copyright (c) 2013 - 2018 Basic Primitives Inc

 Non-commercial - Free
 http://creativecommons.org/licenses/by-nc/3.0/

 Commercial and government licenses:
 http://www.basicprimitives.com/pdf/license.pdf

*/
(function(){var a=function(a){var a=a.split("."),c=window,d;for(d=0;d<a.length;d+=1)c=c[a[d]]=c[a[d]]||{};return c};a("primitives.common");a("primitives.orgdiagram");a("primitives.famdiagram");a("primitives.text");a("primitives.callout");a("primitives.connector");a("primitives.shape");a("primitives.pdf");a("primitives.pdf.orgdiagram");a("primitives.pdf.famdiagram");primitives.common.version="5.0.4"})();
primitives.common.getElementsByName=function(a,b,c,d){for(var b=b.getElementsByTagName("*"),e=0;e<b.length;e+=1){var f=b[e];f.name==c&&d.call(a,f)}};primitives.common.getFixOfPixelALignment=function(a){var b=a.getBoundingClientRect(),a=b.top+document.body.scrollTop,b=b.left+document.body.scrollLeft;return new primitives.common.Size(-b+Math.floor(b),-a+Math.floor(a))};
primitives.common.getElementOffset=function(a){var b=a.getBoundingClientRect(),a=a.ownerDocument.documentElement;return{top:b.top+window.pageYOffset-a.clientTop,left:b.left+window.pageXOffset-a.clientLeft}};primitives.common.hasClass=function(a,b){var c=a.className;if(null!=c&&"string"==typeof c)for(var c=c.split(" "),d=0;d<c.length;d+=1)if(c[d]==b)return!0;return!1};
primitives.common.stopPropagation=function(a){void 0!==a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble?a.cancelBubble=!0:void 0!==a.preventDefault&&a.preventDefault()};primitives.common.getInnerSize=function(a){a=window.getComputedStyle(a);return new primitives.common.Size(parseInt(a.width,10),parseInt(a.height,10))};primitives.common.isEven=function(a){return 0==a%2};primitives.common.isNullOrEmpty=function(a){var b=!0;void 0!==a&&null!==a&&(a=a.toString(),0<a.length&&(b=!1));return b};
primitives.common.isArray=Array.isArray||function(a){return a instanceof Array};primitives.common.loop=function(a,b,c){var d,e;if(null!=c)if(primitives.common.isArray(b)){d=0;for(e=b.length;d<e&&!c.call(a,d,b[d]);d+=1);}else for(d in b)if(b.hasOwnProperty(d)&&c.call(a,d,b[d]))break};primitives.common.splitCamelCaseName=function(a){for(var b=[],c="",d=0;d<a.length;d+=1){var e=a[d];"A"<=e&&"Z">=e?(""!==c&&b.push(c),c=e):c+=e}""!==c&&b.push(c);return b};
primitives.common.isObject=function(a){return null!==a&&"object"==typeof a};primitives.common.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};
primitives.common.cloneObject=function(a,b){var c;if(null===a)c=null;else if(a instanceof Array)if(b)c=a.slice(0);else{c=[];for(var d=0,e=a.length;d<e;d+=1)c.push(primitives.common.cloneObject(a[d],b))}else switch(typeof a){case "object":c={};for(d in a)a.hasOwnProperty(d)&&(c[d]=b?a[d]:primitives.common.cloneObject(a[d],b));break;default:c=a}return c};
primitives.common.mergeObjects=function(a,b){for(var c=1;c<arguments.length;c+=1){var d=arguments[c];if(null!=d)for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a};primitives.common.hashCode=function(a){var b=0,c,d;if(0<a.length)for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b};primitives.common.indexOf=function(a,b,c){var d,e;for(d=0;d<a.length;d+=1)if(e=a[d],null!=c?c(e,b):e==b)return d;return-1};primitives.common._supportsSVG=null;
primitives.common.supportsSVG=function(){null===primitives.common._supportsSVG&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0"));return primitives.common._supportsSVG};primitives.common._supportsCanvas=null;
primitives.common.supportsCanvas=function(){null===primitives.common._supportsCanvas&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement);return primitives.common._supportsCanvas};
primitives.common.createGraphics=function(a,b){var c=null,d,e;d=[a];for(e in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(e)&&d.push(primitives.common.GraphicsType[e]);for(e=0;null===c&&e<d.length;e+=1)switch(d[e]){case 0:primitives.common.supportsSVG()&&(c=new primitives.common.SvgGraphics(b));break;case 1:primitives.common.supportsCanvas()&&(c=new primitives.common.CanvasGraphics(b))}return c};
primitives.common.isChrome=function(){return null!=navigator?/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor):!1};
primitives.common.getColorHexValue=function(a){var b,c,d;if("#"===a.substr(0,1))return a;b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null!==b&&0<b.length)return a=parseInt(b[2],10),c=parseInt(b[3],10),d=parseInt(b[4],10),a=(a<<16|c<<8|d).toString(16),b[1]+"000000".substr(0,6-a.length)+a;if(void 0===primitives.common.ColorHexs)for(c in primitives.common.ColorHexs={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(c)&&(primitives.common.ColorHexs[c.toUpperCase()]=primitives.common.Colors[c]);
return primitives.common.ColorHexs[a.toUpperCase()]};primitives.common.getColorName=function(a){var b,a=primitives.common.getColorHexValue(a);if(void 0===primitives.common.ColorNames)for(b in primitives.common.ColorNames={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&(primitives.common.ColorNames[primitives.common.Colors[b]]=b);return primitives.common.ColorNames[a]};primitives.common.getRed=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(1,2),16):null};
primitives.common.getGreen=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(3,2),16):null};primitives.common.getBlue=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(5,2),16):null};
primitives.common.beforeOpacity=function(a,b){var c=primitives.common,d,e,a=c.getColorHexValue(a);d=Math.ceil((c.getRed(a)-255*(1-b))/b);e=Math.ceil((c.getGreen(a)-255*(1-b))/b);c=Math.ceil((c.getBlue(a)-255*(1-b))/b);d=(d<<16|e<<8|c).toString(16);return"#"+"000000".substr(0,6-d.length)+d};
primitives.common.highestContrast=function(a,b,c){var d=b,e=primitives.common,f=a+","+b+","+c;void 0===e.highestContrasts&&(e.highestContrasts={});e.highestContrasts.hasOwnProperty(f)?d=e.highestContrasts[f]:(e.luminosity(b,a)<e.luminosity(c,a)&&(d=c),e.highestContrasts[f]=d);return d};
primitives.common.luminosity=function(a,b){var c=primitives.common,d=c.getColorHexValue(a),e=c.getColorHexValue(b),d=0.2126*Math.pow(c.getRed(d)/255,2.2)+0.7152*Math.pow(c.getRed(d)/255,2.2)+0.0722*Math.pow(c.getRed(d)/255,2.2),c=0.2126*Math.pow(c.getRed(e)/255,2.2)+0.7152*Math.pow(c.getRed(e)/255,2.2)+0.0722*Math.pow(c.getRed(e)/255,2.2);return d>c?(d+0.05)/(c+0.05):(c+0.05)/(d+0.05)};
primitives.common.compareArrays=function(a,b,c){var d=!0,e,f,g,h;if(a.length!=b.length)d=!1;else{h={};e=0;for(f=a.length;e<f;e+=1)g=null!=c?c(a[e]):a[e],h[g]=h.hasOwnProperty(g)?h[g]+1:1;e=0;for(f=b.length;e<f;e+=1)if(g=null!=c?c(b[e]):b[e],h.hasOwnProperty(g)){if(h[g]-=1,0>h[g]){d=!1;break}}else{d=!1;break}}return d};primitives.common.JsonML={};
(function(a,b){function c(a){this.value=a}function d(a){return"function"===typeof a}function e(a){switch(typeof a){case "object":return!a?0:l(a)?2:m(a)?5:a instanceof Date?4:3;case "function":return 1;case "undefined":return 0;default:return 4}}var f={accesskey:"accessKey",bgcolor:"bgColor",cellpadding:"cellPadding",cellspacing:"cellSpacing",checked:"defaultChecked","class":"className",colspan:"colSpan",contenteditable:"contentEditable",defaultchecked:"defaultChecked","for":"htmlFor",formnovalidate:"formNoValidate",
hidefocus:"hideFocus",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",readonly:"readOnly",rowspan:"rowSpan",spellcheck:"spellCheck",tabindex:"tabIndex",usemap:"useMap",willvalidate:"willValidate"},g={enctype:"encoding",onscroll:"DOMMouseScroll"},h={autocapitalize:1,autocomplete:1,autocorrect:1},i={async:1,autofocus:1,checked:1,defaultchecked:1,defer:1,disabled:1,formnovalidate:1,hidden:1,indeterminate:1,ismap:1,multiple:1,novalidate:1,readonly:1,required:1,spellcheck:1,willvalidate:1},
j=/^[\r\n]+/,k=/[\r\n]+$/;c.prototype.toString=function(){return this.value};a.raw=function(a){return new c(a)};var m=a.isRaw=function(a){return a instanceof c},l=Array.isArray||function(a){return a instanceof Array},n=function(a){if(a){if("!"===a.charAt(0))return b.createComment("!"===a?"":a.substr(1)+" ")}else{if(b.createDocumentFragment)return b.createDocumentFragment();a=""}return"style"===a.toLowerCase()&&b.createStyleSheet?b.createStyleSheet():b.createElement(a)},p=function(a,b,c){"on"===b.substr(0,
2)&&(b=b.substr(2));switch(typeof c){case "function":if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent&&0!==e(a[b]))a.attachEvent("on"+b,c);else{var g=a["on"+b]||a[b];a["on"+b]=a[b]=!d(g)?c:function(a){return!1!==g.call(this,a)&&!1!==c.call(this,a)}}break;case "string":a["on"+b]=new Function("event",c)}},q=a.applyStyles=function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a.style[d]=b[d]);return a},s=a.appendDOM=function(a,d){if(d){var c=(a.tagName||"").toLowerCase();if(8===a.nodeType)3===
d.nodeType&&(a.nodeValue+=d.nodeValue);else if("table"===c&&a.tBodies)if(d.tagName)if((c=d.tagName.toLowerCase())&&"tbody"!==c&&"thead"!==c){var e=0<a.tBodies.length?a.tBodies[a.tBodies.length-1]:null;e||(e=n("th"===c?"thead":"tbody"),a.appendChild(e));e.appendChild(d)}else!1!==a.canHaveChildren&&a.appendChild(d);else{if(11===d.nodeType)for(;d.firstChild;)s(a,d.removeChild(d.firstChild))}else if("style"===c&&b.createStyleSheet)a.cssText=d;else if(!1!==a.canHaveChildren)a.appendChild(d);else if("object"===
c&&d.tagName&&"param"===d.tagName.toLowerCase()){try{a.appendChild(d)}catch(g){}try{a.object&&(a.object[d.name]=d.value)}catch(h){}}}},r=function(a){return!!a&&3===a.nodeType&&(!a.nodeValue||!/\S/.exec(a.nodeValue))},v=function(a,b){a&&(3===a.nodeType&&b.exec(a.nodeValue))&&(a.nodeValue=a.nodeValue.replace(b,""))},u=function(a){if(a){for(;r(a.firstChild);)a.removeChild(a.firstChild);for(v(a.firstChild,j);r(a.lastChild);)a.removeChild(a.lastChild);v(a.lastChild,k)}},x=function(a){var b=n("div");b.innerHTML=
""+a;u(b);if(1===b.childNodes.length)return b.firstChild;for(a=n("");b.firstChild;)a.appendChild(b.firstChild);return a},w=function(a){return b.createTextNode("["+a+"]")};a.onerror=null;var z=a.patch=function(a,d,c){for(var k=1;k<d.length;k+=1)if(l(d[k])||"string"===typeof d[k])s(a,t(d[k],c));else if(m(d[k]))s(a,x(d[k].value));else if("object"===typeof d[k]&&null!==d[k]&&1===a.nodeType){var j=d[k];if(j.name&&b.attachEvent&&!a.parentNode)try{var r=n("<"+a.tagName+' name="'+j.name+'">');a.tagName===
r.tagName&&(a=r)}catch(H){}var G=void 0;for(G in j)if(j.hasOwnProperty(G)){var w=j[G],v=e(w);if(G)if(0===v&&(w="",v=4),G=f[G.toLowerCase()]||G,"$"===G)w(a);else if("className"==G)if(l(w))for(v=0;v<w.length;v+=1)a.className+=" "+w[v];else a.className+=" "+w;else"style"===G?0!==e(a.style.cssText)?"string"==typeof w?a.style.cssText=w:q(a,w):a.style=w:"on"===G.substr(0,2)?(p(a,G,w),(G=g[G])&&p(a,G,w)):!h[G.toLowerCase()]&&(4!==v||"$"===G.charAt(0)||0!==e(a[G])||0!==e(a[g[G]]))?(a[G]=w,(G=g[G])&&(a[G]=
w)):i[G.toLowerCase()]?w&&(a.setAttribute(G,G),(G=g[G])&&a.setAttribute(G,G)):(a.setAttribute(G,w),(G=g[G])&&a.setAttribute(G,w))}}return a},t=a.toHTML=function(c,e){try{if(!c)return null;if("string"===typeof c)return b.createTextNode(c);if(m(c))return x(c.value);if(!l(c)||"string"!==typeof c[0])throw new SyntaxError("invalid JsonML");var g=c[0];if(!g){for(var h=n(""),g=1;g<c.length;g+=1)s(h,t(c[g],e));u(h);return 1===h.childNodes.length?h.firstChild:h}if("style"===g.toLowerCase()&&b.createStyleSheet)return z(b.createStyleSheet(),
c,e),null;var f=z(n(g),c,e);u(f);return f&&d(e)?e(f):f}catch(k){try{return(d(a.onerror)?a.onerror:w)(k,c,e)}catch(i){return b.createTextNode("["+i+"]")}}};a.toHTMLText=function(a,b){var d=t(a,b);if(d.outerHTML)return d.outerHTML;var c=n("div");c.appendChild(d);var e=c.innerHTML;c.removeChild(d);return e}})(primitives.common.JsonML,document);primitives.common.AdviserPlacementType={Auto:0,Left:2,Right:3};primitives.orgdiagram.AdviserPlacementType=primitives.common.AdviserPlacementType;
primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2};primitives.common.VectorRelationType={None:0,Null:1,Collinear:2,Opposite:3};primitives.common.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2};primitives.orgdiagram.UpdateMode=primitives.common.UpdateMode;primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3};primitives.common.SideFlag={Top:1,Right:2,Bottom:4,Left:8};
primitives.common.ShapeType={Rectangle:0,Oval:1,Triangle:2,CrossOut:3,Circle:4,Rhombus:5,Wedge:7,FramedOval:8,FramedTriangle:9,FramedWedge:10,FramedRhombus:11,None:6};primitives.common.SelectionPathMode={None:0,FullStack:1};primitives.orgdiagram.SelectionPathMode=primitives.common.SelectionPathMode;primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4};primitives.common.RenderingMode={Create:0,Update:1};
primitives.common.PlacementType={Auto:0,TopLeft:8,Top:1,TopRight:2,RightTop:11,Right:3,RightBottom:12,BottomRight:4,Bottom:5,BottomLeft:6,LeftBottom:10,Left:7,LeftTop:9};primitives.common.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3,AutoSize:5,SelectionOnly:6};primitives.orgdiagram.PageFitMode=primitives.common.PageFitMode;primitives.common.OrientationType={Top:0,Bottom:1,Left:2,Right:3,None:4};primitives.orgdiagram.OrientationType=primitives.common.OrientationType;
primitives.common.NeighboursSelectionMode={ParentsAndChildren:0,ParentsChildrenSiblingsAndSpouses:1};primitives.common.NavigationMode={Default:0,CursorOnly:1,HighlightOnly:3,Inactive:2};primitives.common.LineType={Solid:0,Dotted:1,Dashed:2};
primitives.common.Layers={BackgroundAnnotation:2,BackgroundAnnotations:3,BackgroundConnectorAnnotation:4,BackgroundHighlightPathAnnotations:5,Connector:6,ForegroundHighlightPathAnnotations:7,Highlight:8,Marker:9,Label:10,Cursor:11,Item:12,ForegroundAnnotations:13,ForegroundConnectorAnnotation:14,Annotation:15,Controls:16};primitives.common.LabelType={Regular:0,Dummy:1,Fixed:2,None:3};primitives.common.AnnotationType={Connector:0,Shape:1,HighlightPath:2,Label:3,Background:4};
primitives.common.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3};primitives.orgdiagram.ChildrenPlacementType=primitives.common.ChildrenPlacementType;
primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",
DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",
Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",
LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",
Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",
SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"};primitives.common.ConnectorLabelPlacementType={From:0,Between:1,To:2};primitives.common.ConnectorPlacementType={Offbeat:0,Straight:1};primitives.common.ConnectorShapeType={OneWay:0,TwoWay:1,BothWay:2};
primitives.common.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4};primitives.common.ConnectorStyleType={Extra:0,Regular:1,Highlight:2};primitives.common.ElbowType={None:0,Dot:1,Bevel:2,Round:3};primitives.common.Enabled={Auto:0,True:1,False:2};primitives.common.GraphicsType={SVG:0,Canvas:1};primitives.common.GroupByType={None:0,Parents:1,Children:2};primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2};
primitives.orgdiagram.ItemType={Regular:0,Assistant:1,SubAssistant:4,SuperAssistant:10,SuperAdviser:9,SubAdviser:5,Adviser:2,Director:11,GeneralPartner:6,LimitedPartner:7,AdviserPartner:8};primitives.common.ConnectorType={Squared:0,Angular:1,Curved:2};primitives.orgdiagram.ConnectorType=primitives.common.ConnectorType;primitives.common.ZOrderType={Auto:0,Background:1,Foreground:2};
primitives.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=this.id=null;this.isSelected=this.isCursor=!1};primitives.common.BaseShape=function(){};
primitives.common.BaseShape.prototype._getLabelPosition=function(a,b,c,d,e,f,g,h){var i=null;switch(h){case 1:i=new primitives.common.Rect(a+c/2-e/2,b-g-f,e,f);break;case 2:i=new primitives.common.Rect(a+c-e,b-g-f,e,f);break;case 8:i=new primitives.common.Rect(a,b-g-f,e,f);break;case 3:i=new primitives.common.Rect(a+c+g,b+d/2-f/2,e,f);break;case 11:i=new primitives.common.Rect(a+c+g,b,e,f);break;case 12:i=new primitives.common.Rect(a+c+g,b+d-f,e,f);break;case 4:i=new primitives.common.Rect(a+c-e,
b+d+g,e,f);break;case 6:i=new primitives.common.Rect(a,b+d+g,e,f);break;case 7:i=new primitives.common.Rect(a-e-g,b+d/2-f/2,e,f);break;case 9:i=new primitives.common.Rect(a-e-g,b,e,f);break;case 10:i=new primitives.common.Rect(a-e-g,b+d-f,e,f);break;default:i=new primitives.common.Rect(a+c/2-e/2,b+d+g,e,f)}return i};primitives.common.BaseShape.prototype._betweenPoint=function(a,b){return new primitives.common.Point((a.x+b.x)/2,(a.y+b.y)/2)};
primitives.common.BaseShape.prototype._offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};primitives.common.Callout=function(a){this.m_graphics=a;this.pointerPlacement=0;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.lineType=0;this.fillColor="#d3d3d3";this.m_map=[[8,7,6],[1,null,5],[2,3,4]]};
primitives.common.Callout.prototype=new primitives.common.BaseShape;
primitives.common.Callout.prototype.draw=function(a,b){var b=(new primitives.common.Rect(b)).offset(this.offset),c=new primitives.common.Point(b.x,b.y),d=new primitives.common.Point(b.right(),b.y),e=new primitives.common.Point(b.right(),b.bottom()),f=new primitives.common.Point(b.left(),b.bottom()),g=[null,null,null,null,null,null,null,null],f=[c,d,e,f],d=this.m_graphics.getPxSize(this.cornerRadius,Math.min(c.distanceTo(d),d.distanceTo(e))),h,i;h={};null!==this.fillColor&&(h.fillColor=this.fillColor,
h.opacity=this.opacity);null!==this.lineColor&&(h.lineColor=this.borderColor);h.lineWidth=this.lineWidth;h.lineType=this.lineType;i=new primitives.common.PaletteItem(h);h=new primitives.common.PolylinesBuffer;i=h.getPolyline(i);null!==a&&(c=0===this.pointerPlacement?this._getPlacement(a,c,e):this.pointerPlacement,null!==c&&(g[c]=a));for(e=0;e<f.length;e+=1)this._drawSegment(i,f[0],f[1],f[2],this.pointerWidth,d,g[1],g[2]),c=f.shift(),f.push(c),c=g.shift(),g.push(c),c=g.shift(),g.push(c);this.m_graphics.polylinesBuffer(h)};
primitives.common.Callout.prototype._getPlacement=function(a,b,c){var d=null,e=null,d=a.x<b.x?0:a.x>c.x?2:1,e=a.y<b.y?0:a.y>c.y?2:1;return this.m_map[d][e]};
primitives.common.Callout.prototype._drawSegment=function(a,b,c,d,e,f,g,h){var i=this._offsetPoint(b,c,f),j=this._offsetPoint(c,b,f),d=this._offsetPoint(c,d,f),e=this.m_graphics.getPxSize(e,b.distanceTo(c)/2);0===a.length()&&a.addSegment(new primitives.common.MoveSegment(i));null!==g&&(i=this._betweenPoint(b,c),b=this._offsetPoint(i,b,e),e=this._offsetPoint(i,c,e),a.addSegment(new primitives.common.LineSegment(b)),a.addSegment(new primitives.common.LineSegment(g)),a.addSegment(new primitives.common.LineSegment(e)));
a.addSegment(new primitives.common.LineSegment(j));null!==h?(a.addSegment(new primitives.common.LineSegment(h)),a.addSegment(new primitives.common.LineSegment(d))):a.addSegment(new primitives.common.QuadraticArcSegment(c,d))};primitives.common.ConnectorOffbeat=function(){};primitives.common.ConnectorOffbeat.prototype=new primitives.common.BaseShape;
primitives.common.ConnectorOffbeat.prototype.draw=function(a,b,c,d,e,f,g,h,i,j,k,m,l,n){var p,q,s,r,v,u,x,w,l=f=0,z=null,t,A;t=a.getPolyline(b);v=[];switch(i){case 1:v=[-e/2,e/2];A=!1;break;case 0:v=[0];A=!1;break;case 2:v=[0],A=!0}p=Math.max(m?g.width:0,5*e);if(c.right()+p<d.left()||c.left()>d.right()+p)if(c.left()>d.right()?(s=new primitives.common.Point(c.left(),c.verticalCenter()),r=new primitives.common.Point(d.right(),d.verticalCenter())):(s=new primitives.common.Point(c.right(),c.verticalCenter()),
r=new primitives.common.Point(d.left(),d.verticalCenter())),m&&(c.left()>d.right()?(f=7,l=3):(f=3,l=7)),q=new primitives.common.Rect(s,r),w=s.y<=r.y,x=s.x<r.x,q.height<q.width){q.height<2*e&&q.offset(0,w?2*e:0,0,w?0:2*e);h=0;for(p=v.length;h<p;h+=1)u=v[h],a.addInverted(function(d){d=d.getPolyline(b);d.addSegment(new primitives.common.MoveSegment(s.x,s.y+u));d.addSegment(new primitives.common.QuadraticArcSegment(q.horizontalCenter(),(w?q.top():q.bottom())+u,r.x,r.y+u));A&&d.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},
h||0==i),t.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});m&&(i=g.width<2*(q.width/5)?primitives.common.QuadraticArcSegment.prototype.offsetPoint(s.x,s.y,q.horizontalCenter(),w?q.top():q.bottom(),r.x,r.y,0.5):new primitives.common.Point(s.x,w?q.top():q.bottom()),z=new primitives.common.Rect(i.x+(x?e:-g.width-e),w?i.y-g.height-e:i.y+e,g.width,g.height))}else{h=0;for(p=v.length;h<p;h+=1)u=v[h],a.addInverted(function(d){d=d.getPolyline(b);d.addSegment(new primitives.common.MoveSegment(s.x,
s.y+u));d.addSegment(new primitives.common.QuadraticArcSegment(q.horizontalCenter()+u*(w!=x?1:-1),(w?q.top():q.bottom())+u,q.horizontalCenter()+u*(w!=x?1:-1),q.verticalCenter()+u));d.addSegment(new primitives.common.QuadraticArcSegment(q.horizontalCenter()+u*(w!=x?1:-1),(w?q.bottom():q.top())+u,r.x,r.y+u));A&&d.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),t.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});m&&(z=new primitives.common.Rect(q.horizontalCenter()+
(w!=x?e:-(e+g.width)),q.verticalCenter()-g.height/2,g.width,g.height))}else if(c.verticalCenter()<d.top()||c.verticalCenter()>d.bottom()){x=c.x<h.width/2;s=new primitives.common.Point(x?c.right():c.left(),c.verticalCenter());r=new primitives.common.Point(x?d.right():d.left(),d.verticalCenter());q=new primitives.common.Rect(s,r);q.offset(10*e,0,10*e,0);w=s.y<=r.y;h=0;for(p=v.length;h<p;h+=1)u=v[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(s.x,s.y+u));
c.addSegment(new primitives.common.QuadraticArcSegment(x?q.right()+u*(w?-1:1):q.left()-u*(w?-1:1),q.verticalCenter(),x?d.right():d.left(),d.verticalCenter()-u));A&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),t.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});m&&(l=f=x?3:7,i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(s.x,s.y,x?q.right():q.left(),q.verticalCenter(),r.x,r.y,0.5),z=new primitives.common.Rect(i.x+(x?
e/2:-e/2-g.width),i.y-g.height/2,g.width,g.height))}else{s=new primitives.common.Point(c.horizontalCenter(),c.top());r=new primitives.common.Point(d.horizontalCenter(),d.top());q=new primitives.common.Rect(s,r);q.offset(0,7*e,0,0);x=s.x<r.x;h=0;for(p=v.length;h<p;h+=1)u=v[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(s.x+u,s.y));c.addSegment(new primitives.common.QuadraticArcSegment(q.horizontalCenter(),q.top()-u*(x?-1:1),d.horizontalCenter()-u,d.top()));
A&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),t.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});m&&(l=f=1,i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(s.x,s.y,q.horizontalCenter(),q.top(),r.x,r.y,0.5),z=new primitives.common.Rect(i.x-g.width/2,i.y-(j+g.height),g.width,g.height))}if(m)switch(k){case 0:z=this._getLabelPosition(c.x,c.y,c.width,c.height,z.width,z.height,j,f);break;case 2:z=this._getLabelPosition(d.x,
d.y,d.width,d.height,z.width,z.height,j,l)}null!=n&&n(z)};primitives.common.ConnectorStraight=function(){};primitives.common.ConnectorStraight.prototype=new primitives.common.BaseShape;
primitives.common.ConnectorStraight.prototype.draw=function(a,b,c,d,e,f,g,h,i,j,k,m,l,n){var p,q,s,r,v,u=e/2,x=null,w=0,z=0,t=this;r=new primitives.common.Vector(c.centerPoint(),d.centerPoint());c.loopEdges(function(a,b){p=a.getIntersectionPoint(r,!0,1);w=b;return null!=p});d.loopEdges(function(a,b){q=a.getIntersectionPoint(r,!0,1);z=b;return null!=q});if(null!=p&&null!=q){var A=new primitives.common.Vector(p,q);l.getOffset(A,function(d,c,e){A.offset((d*f-(c-1)*f/2)*e);p=A.from;q=A.to;switch(i){case 1:v=
new primitives.common.Vector(q.clone(),p.clone());v.offset(u);t._drawLine(a,b,v.from,v.to,!1);v=new primitives.common.Vector(p.clone(),q.clone());v.offset(u);t._drawLine(a,b,v.from,v.to,!1);break;case 0:t._drawLine(a,b,p,q,!1);break;case 2:t._drawLine(a,b,p,q,!0)}if(m){switch(k){case 0:x=t._getLabelPositionBySnapPoint(p.x,p.y,g.width,g.height,j,w);break;case 1:s=t._betweenPoint(p,q);x=t._getLabelPositionBySnapPoint(s.x,s.y,g.width,g.height,j,3);break;case 2:x=t._getLabelPositionBySnapPoint(q.x,q.y,
g.width,g.height,j,z)}null!=n&&n.call(this,x)}})}};primitives.common.ConnectorStraight.prototype._drawLine=function(a,b,c,d,e){var f;a.addInverted(function(e){f=e.getPolyline(b);f.addSegment(new primitives.common.MoveSegment(c));f.addSegment(new primitives.common.LineSegment(d));f.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},!1);e&&(f=a.getPolyline(b),f.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))}))};
primitives.common.ConnectorStraight.prototype._getLabelPositionBySnapPoint=function(a,b,c,d,e,f){var g=null;switch(f){case 0:case 1:g=new primitives.common.Rect(a-c/2,b-e-d,c,d);break;case 3:g=new primitives.common.Rect(a+e,b-d/2,c,d);break;case 5:g=new primitives.common.Rect(a-c/2,b+e,c,d);break;case 7:g=new primitives.common.Rect(a-c-e,b-d/2,c,d)}return g};primitives.common.Marker=function(){};primitives.common.Marker.Markers={};
primitives.common.Marker.DrawCircle=function(a,b){var c=Math.min(b.width/2,b.height/2),b=new primitives.common.Rect(b.horizontalCenter()-c,b.verticalCenter()-c,2*c,2*c);primitives.common.Marker.DrawOval(a,b)};
primitives.common.Marker.DrawRectangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.verticalCenter()))};
primitives.common.Marker.DrawOval=function(a,b){var c,d;c=0.5522848*(b.width/2);d=0.5522848*(b.height/2);a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.x,b.verticalCenter()-d,b.horizontalCenter()-c,b.y,b.horizontalCenter(),b.y));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()+c,b.y,b.right(),b.verticalCenter()-d,b.right(),b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.right(),
b.verticalCenter()+d,b.horizontalCenter()+c,b.bottom(),b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()-c,b.bottom(),b.x,b.verticalCenter()+d,b.x,b.verticalCenter()))};
primitives.common.Marker.DrawTriangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.left(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawCrossOut=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),
b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawRhombus=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()))};
primitives.common.Marker.DrawWedge=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y))};
primitives.common.Marker.DrawFramedOval=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawOval(a,b)};primitives.common.Marker.DrawFramedTriangle=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawTriangle(a,b)};primitives.common.Marker.DrawFramedWedge=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawWedge(a,b)};
primitives.common.Marker.DrawFramedRhombus=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawRhombus(a,b)};primitives.common.Marker.DrawNone=function(){};primitives.common.Marker.Markers[4]=primitives.common.Marker.DrawCircle;primitives.common.Marker.Markers[0]=primitives.common.Marker.DrawRectangle;primitives.common.Marker.Markers[1]=primitives.common.Marker.DrawOval;primitives.common.Marker.Markers[2]=primitives.common.Marker.DrawTriangle;
primitives.common.Marker.Markers[3]=primitives.common.Marker.DrawCrossOut;primitives.common.Marker.Markers[5]=primitives.common.Marker.DrawRhombus;primitives.common.Marker.Markers[7]=primitives.common.Marker.DrawWedge;primitives.common.Marker.Markers[8]=primitives.common.Marker.DrawFramedOval;primitives.common.Marker.Markers[9]=primitives.common.Marker.DrawFramedTriangle;primitives.common.Marker.Markers[10]=primitives.common.Marker.DrawFramedWedge;primitives.common.Marker.Markers[11]=primitives.common.Marker.DrawFramedRhombus;
primitives.common.Marker.Markers[6]=primitives.common.Marker.DrawNone;primitives.common.Marker.prototype.draw=function(a,b,c,d){a=a.getPolyline(d);primitives.common.Marker.Markers[b](a,c)};primitives.common.MergedRectangles=function(a){this.graphics=a;this.transform=null;this.opacity=this.lineWidth=1;this.fillColor=null;this.lineType=0;this.borderColor=null};primitives.common.MergedRectangles.prototype=new primitives.common.BaseShape;
primitives.common.MergedRectangles.prototype.draw=function(a){var b=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,fillColor:this.fillColor,lineType:this.lineType,opacity:this.opacity}),c=new primitives.common.Polyline(b);primitives.common.getMergedRectangles(this,a,function(a){for(var b=0,f=a.length;b<f;b+=1){var g=a[b];0==b?c.addSegment(new primitives.common.MoveSegment(g.x,g.y)):c.addSegment(new primitives.common.LineSegment(g.x,g.y))}});c.transform(this.transform,
!0);this.graphics.polyline(c)};primitives.common.Shape=function(a){this.m_graphics=a;this.transform=null;this.orientationType=0;this.panelSize=null;this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=1;this.labelOffset=4;this.cornerRadius="10%";this.opacity=1;this.fillColor=null;this.labelSize=new primitives.common.Size(60,30);this.lineType=0;this.borderColor=null;this.hasLabel=!1;this.labelTemplate=null;this.labelPlacement=0};primitives.common.Shape.prototype=new primitives.common.BaseShape;
primitives.common.Shape.prototype.draw=function(a,b){var c,d,e,f,a=(new primitives.common.Rect(a)).offset(this.offset);this.transform=new primitives.common.Transform;this.transform.size=this.panelSize;this.transform.setOrientation(this.orientationType);this.hasLabel&&(c=this._getLabelPosition(a.x,a.y,a.width,a.height,this.labelSize.width,this.labelSize.height,this.labelOffset,this.labelPlacement));switch(this.shapeType){case 0:d=new primitives.common.Callout(this.m_graphics);d.cornerRadius=this.cornerRadius;
d.opacity=this.opacity;d.lineWidth=this.lineWidth;d.lineType=this.lineType;d.borderColor=this.borderColor;d.fillColor=this.fillColor;d.draw(null,a);break;default:d=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,lineType:this.lineType,fillColor:this.fillColor,opacity:this.opacity}),this.transform.transformRect(a.x,a.y,a.width,a.height,!1,this,function(b,d,c,e){a=new primitives.common.Rect(b,d,c,e)}),f=new primitives.common.Marker,e=new primitives.common.PolylinesBuffer,
f.draw(e,this.shapeType,a,d),e.transform(this.transform,!0),this.m_graphics.polylinesBuffer(e)}this.hasLabel&&this.m_graphics.template(c.x,c.y,0,0,0,0,c.width,c.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,b,null)};primitives.common.Point=function(a,b){this.context=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.context=a.context;break;case 2:this.x=a,this.y=b}};
primitives.common.Point.prototype.scale=function(a){this.x*=a;this.y*=a;return this};primitives.common.Point.prototype.distanceTo=function(a,b){var c=0,d=0;switch(arguments.length){case 1:c=a.x;d=a.y;break;case 2:c=a,d=b}c=this.x-c;d=this.y-d;return Math.sqrt(c*c+d*d)};primitives.common.Point.prototype.equalTo=function(a){return this.x==a.x&&this.y==a.y};primitives.common.Point.prototype.swap=function(a){var b=a.x,c=a.y;a.x=this.x;a.y=this.y;this.x=b;this.y=c};
primitives.common.Point.prototype.clone=function(){return new primitives.common.Point(this)};primitives.common.Point.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");return b+="top:"+this.y+a+";"};
primitives.common.Rect=function(a,b,c,d){this.context=this.height=this.width=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;break;case 2:this.x=Math.min(a.x,b.x);this.y=Math.min(a.y,b.y);this.width=Math.abs(b.x-a.x);this.height=Math.abs(b.y-a.y);break;case 4:this.x=a,this.y=b,this.width=c,this.height=d}};primitives.common.Rect.prototype.left=function(){return this.x};primitives.common.Rect.prototype.top=function(){return this.y};
primitives.common.Rect.prototype.right=function(){return this.x+this.width};primitives.common.Rect.prototype.bottom=function(){return this.y+this.height};primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2};primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2};primitives.common.Rect.prototype.centerPoint=function(){return new primitives.common.Point(this.horizontalCenter(),this.verticalCenter())};
primitives.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height};
primitives.common.Rect.prototype.offset=function(a,b,c,d){switch(arguments.length){case 1:null!==a&&"object"==typeof a?(this.x-=a.left,this.y-=a.top,this.width=this.width+a.left+a.right,this.height=this.height+a.top+a.bottom):(this.x-=a,this.y-=a,this.width+=2*a,this.height+=2*a);break;case 4:this.x-=a,this.y-=b,this.width=this.width+a+c,this.height=this.height+b+d}return this};primitives.common.Rect.prototype.scale=function(a){this.x*=a;this.y*=a;this.width*=a;this.height*=a;return this};
primitives.common.Rect.prototype.translate=function(a,b){this.x+=a;this.y+=b;return this};primitives.common.Rect.prototype.invert=function(){var a=this.width,b=this.x;this.width=this.height;this.height=a;this.x=this.y;this.y=b;return this};
primitives.common.Rect.prototype.loopEdges=function(a){var b=[new primitives.common.Point(this.left(),this.top()),new primitives.common.Point(this.right(),this.top()),new primitives.common.Point(this.right(),this.bottom()),new primitives.common.Point(this.left(),this.bottom())],c=[1,3,5,7];b.push(b[0]);if(null!=a)for(var d=1,e=b.length;d<e&&!a(new primitives.common.Vector(b[d-1],b[d]),c[d-1]);d+=1);return this};
primitives.common.Rect.prototype.contains=function(a,b){switch(arguments.length){case 1:return this.x<=a.x&&a.x<=this.x+this.width&&this.y<=a.y&&a.y<=this.y+this.height;case 2:return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+this.height;default:return!1}};
primitives.common.Rect.prototype.cropByRect=function(a){this.x<a.x&&(this.width-=a.x-this.x,this.x=a.x);this.right()>a.right()&&(this.width-=this.right()-a.right());this.y<a.y&&(this.height-=a.y-this.y,this.y=a.y);this.bottom()>a.bottom()&&(this.height-=this.bottom()-a.bottom());this.isEmpty()&&(this.height=this.width=this.y=this.x=null);return this};
primitives.common.Rect.prototype.overlaps=function(a){var b=!0;if(this.x+this.width<a.x||a.x+a.width<this.x||this.y+this.height<a.y||a.y+a.height<this.y)b=!1;return b};
primitives.common.Rect.prototype.addRect=function(a,b,c,d){var e,f;switch(arguments.length){case 1:a.isEmpty()||(this.isEmpty()?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(e=Math.max(this.right(),a.right()),f=Math.max(this.bottom(),a.bottom()),this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.width=e-this.x,this.height=f-this.y));break;case 2:this.isEmpty()?(this.x=a,this.y=b,this.height=this.width=0):(e=Math.max(this.right(),a),f=Math.max(this.bottom(),b),this.x=Math.min(this.x,
a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y);break;case 4:this.isEmpty()?(this.x=a,this.y=b,this.width=c,this.height=d):(e=Math.max(this.right(),a+c),f=Math.max(this.bottom(),b+d),this.x=Math.min(this.x,a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y)}return this};primitives.common.Rect.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};
primitives.common.Rect.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");b+="top:"+this.y+a+";";b+="width:"+this.width+a+";";return b+="height:"+this.height+a+";"};primitives.common.Rect.prototype.validate=function(){if(isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height))throw"Invalid rect position.";};primitives.common.Rect.prototype.equalTo=function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height};
primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=1};primitives.common.MoveSegment.prototype=new primitives.common.Point;primitives.common.MoveSegment.prototype.clone=function(){return new primitives.common.MoveSegment(this)};primitives.common.MoveSegment.prototype.loop=function(a,b){null!=b&&b.call(a,this.x,this.y,0)};primitives.common.MoveSegment.prototype.setPoint=function(a){this.x=a.x;this.y=a.y};
primitives.common.MoveSegment.prototype.getEndPoint=function(){return this};primitives.common.MoveSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};primitives.common.MoveSegment.prototype.transform=function(a,b){var c=this;a.transformPoint(c.x,c.y,b,c,function(a,b){c.x=a;c.y=b})};
primitives.common.CubicArcSegment=function(a,b,c,d,e,f){this.parent=primitives.common.Point.prototype;this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null;switch(arguments.length){case 3:this.parent.constructor.apply(this,[c.x,c.y]);this.cpX1=a.x;this.cpY1=a.y;this.cpX2=b.x;this.cpY2=b.y;break;case 6:this.parent.constructor.apply(this,[e,f]),this.cpX1=a,this.cpY1=b,this.cpX2=c,this.cpY2=d}this.segmentType=3};primitives.common.CubicArcSegment.prototype=new primitives.common.Point;
primitives.common.CubicArcSegment.prototype.clone=function(){return new primitives.common.CubicArcSegment(this.cpX1,this.cpY1,this.cpX2,this.cpY2,this.x,this.y)};primitives.common.CubicArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX1,this.cpY1,0),b.call(a,this.cpX2,this.cpY2,1),b.call(a,this.x,this.y,2))};
primitives.common.CubicArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX1=a.x;this.cpY1=a.y;break;case 1:this.cpX2=a.x;this.cpY2=a.y;break;case 2:this.x=a.x,this.y=a.y}};primitives.common.CubicArcSegment.prototype.getEndPoint=function(){return this};primitives.common.CubicArcSegment.prototype.invert=function(a){var b=this.cpX1,c=this.cpY1;this.x=a.x;this.y=a.y;this.cpX1=this.cpX2;this.cpY1=this.cpY2;this.cpX2=b;this.cpY2=c};
primitives.common.CubicArcSegment.prototype.transform=function(a,b){var c=this;a.transform3Points(c.x,c.y,c.cpX1,c.cpY1,c.cpX2,c.cpY2,b,c,function(a,b,f,g,h,i){c.x=a;c.y=b;c.cpX1=f;c.cpY1=g;c.cpX2=h;c.cpY2=i})};
primitives.common.CubicArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c),e=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/e.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.CubicArcSegment.prototype.offsetPoint=function(a,b,c,d,e,f,g,h,i){return new primitives.common.Point((1-i)*(1-i)*(1-i)*a+3*(1-i)*(1-i)*i*c+3*(1-i)*i*i*e+i*i*i*g,(1-i)*(1-i)*(1-i)*b+3*(1-i)*(1-i)*i*d+3*(1-i)*i*i*f+i*i*i*h)};primitives.common.DotSegment=function(a,b,c,d,e){this.segmentType=4;this.x=a;this.y=b;this.width=c;this.height=d;this.cornerRadius=e};
primitives.common.Label=function(){this.position=this.text=null;this.weight=0;this.isActive=!0;this.horizontalAlignmentType=this.labelOrientation=this.labelType=0;this.verticalAlignmentType=2;this.parent=primitives.common.Rect.prototype;this.parent.constructor.apply(this,arguments)};primitives.common.Label.prototype=new primitives.common.Rect;
primitives.common.LineSegment=function(){this.parent=primitives.common.MoveSegment.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=0};primitives.common.LineSegment.prototype=new primitives.common.MoveSegment;primitives.common.LineSegment.prototype.clone=function(){return new primitives.common.LineSegment(this)};primitives.common.LineSegment.prototype.trim=function(a,b){var c=this.offsetPoint(this,a,b);this.x=c.x;this.y=c.y;return this};
primitives.common.LineSegment.prototype.offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};primitives.common.Matrix=function(a,b,c,d){this.b2=this.a2=this.b1=this.a1=null;switch(arguments.length){case 1:this.a1=a.a1;this.b1=a.b1;this.a2=a.a2;this.b2=a.b2;break;case 4:this.a1=a,this.b1=b,this.a2=c,this.b2=d}};
primitives.common.Matrix.prototype.determinant=function(){return this.a1*this.b2-this.b1*this.a2};primitives.common.PaletteItem=function(a){this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;this.opacity=this.fillColor=null;this._key="";var b,c,d,e;c=["lineColor","lineWidth","lineType","fillColor","opacity"];d=0;for(e=c.length;d<e;d+=1)b=c[d],null!=a&&a.hasOwnProperty(b)&&(this[b]=a[b]),this._key+=(!primitives.common.isNullOrEmpty(this._key)?", ":"")+b+":"+this[b]};
primitives.common.PaletteItem.prototype.toAttr=function(){var a={lineWidth:this.lineWidth,lineType:this.lineType};null!==this.fillColor&&(a.fillColor=this.fillColor);null!==this.opacity&&(a.opacity=this.opacity);null!==this.lineColor&&(a.borderColor=this.lineColor);return a};primitives.common.PaletteItem.prototype.toString=function(){return this._key};
primitives.common.PaletteManager=function(a,b){this.palette=[];this.cursor=0;var c,d;if(0===b.length)this.palette=[new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,lineType:a.linesType})],this.paletteLength=this.palette.length,this.regularIndex=0;else{c=0;for(d=b.length;c<d;c+=1)this.palette.push(new primitives.common.PaletteItem(b[c]));this.paletteLength=this.palette.length;this.palette.push(new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,
lineType:a.linesType}));this.regularIndex=this.palette.length-1}this.palette.push(new primitives.common.PaletteItem({lineColor:a.highlightLinesColor,lineWidth:a.highlightLinesWidth,lineType:a.highlightLinesType}));this.highlightIndex=this.palette.length-1};primitives.common.PaletteManager.prototype.selectPalette=function(a){this.cursor=a%this.paletteLength};
primitives.common.PaletteManager.prototype.getPalette=function(a){var b=null;switch(a){case 1:b=this.regularIndex;break;case 2:b=this.highlightIndex;break;case 0:b=this.cursor}return this.palette[b]};
primitives.common.Polyline=function(a){function b(a,b){var d,c,e;if(null!=b){d=0;for(c=i.length;d<c&&(!(e=i[d])||!b.call(a,e,d));d+=1);}}function c(){return primitives.common.isNullOrEmpty(h.fillColor)}function d(a,b,d,c,e,g){for(var h=new primitives.common.Polyline(k),f,i,e=[new primitives.common.Point(e,-g/2),new primitives.common.Point(0,0),new primitives.common.Point(e,g/2),new primitives.common.Point(3*(e/4),0)],j=Math.atan2(b-c,a-d),a=0,b=e.length;a<b;a+=1)g=e[a],f=g.x*Math.cos(j)-g.y*Math.sin(j),
i=g.x*Math.sin(j)+g.y*Math.cos(j),g.x=f+d,g.y=i+c;h.addSegment(new primitives.common.MoveSegment(e[0].x,e[0].y));h.addSegment(new primitives.common.LineSegment(e[1].x,e[1].y));h.addSegment(new primitives.common.LineSegment(e[2].x,e[2].y));h.addSegment(new primitives.common.QuadraticArcSegment(e[3].x,e[3].y,e[0].x,e[0].y));return h}function e(a,b){this.segment=a;this.pointIndex=b}function f(a,b,d,c,g){var h=a.relateTo(b),f=g?0:d;2==h?b.offset(f):3==h&&0===b.from.context.pointIndex?(h=new primitives.common.LineSegment(b.from),
c.addSegment(h),b.offset(f),c=b.from.clone(),c.context=new e(h,0),f=new primitives.common.Vector(a.to.clone(),c),g||(b.from=c.clone()),f.offset(d),f.intersect(a),f.from.context.pushToSegment(f.from),b.intersect(f),g&&f.to.context.pushToSegment(f.to)):(b.offset(f),b.intersect(a));b.from.context.pushToSegment(b.from)}function g(a,b,d,c){var e,g=a[0],h=g.to.context.segment.getEndPoint().toString();b.hasOwnProperty(h)&&(e=b[h],f(g,e,d,c,!0),delete b[h]);g.to.context.pushToSegment(g.to);a.length=0}var h=
new primitives.common.PaletteItem,i=[],j,k;switch(arguments.length){case 1:h=a}k=new primitives.common.PaletteItem({lineColor:h.lineColor,lineWidth:0,fillColor:h.lineColor,opacity:h.opacity||1});e.prototype.pushToSegment=function(a){this.segment.setPoint(a,this.pointIndex)};return j={paletteItem:h,arrowPaletteItem:k,addSegment:function(a){i.push(a)},addSegments:function(a){i=i.concat(a)},mergeTo:function(a){a.addSegments(i)},length:function(){return i.length},loop:b,loopReversed:function(a,b){var d,
c;if(null!=b)for(d=i.length-1;0<=d&&(!(c=i[d])||!b.call(a,c,d));d-=1);},transform:function(a,d){b(this,function(b){null!=b.transform&&b.transform(a,d)})},isInvertable:c,addInverted:function(a){var b=!1,d=[];c()?a.loopReversed(this,function(a){4!=a.segmentType&&(b||(i.push(new primitives.common.MoveSegment(a.getEndPoint())),b=!0),d.unshift(a),1<d.length&&(d[1].invert(d[0].getEndPoint()),i.push(d[1]),d.length=1))}):a.mergeTo(j)},addArrow:function(a,b){var c,e,g,h;e=i.length;h=3*a;var f=2*a;switch(a){case 1:h=
8;f=6;break;case 2:h=12;f=8;break;case 3:h=16,f=10}null!=b&&1<e&&(c=i[e-2].getEndPoint(),g=i[e-1],null!=g.trim&&(e=new primitives.common.Point(g.getEndPoint()),c=g.trim(c,f),h=d(c.x,c.y,e.x,e.y,h,f),b(h,c)))},addOffsetArrow:function(a,b,c,e,g){var h,f,k;h=i.length;k=3*b;var j=2*b,x;switch(b){case 1:k=8;j=6;break;case 2:k=12;j=8;break;case 3:k=16,j=10}null!=g&&1<h&&(b=i[h-2].getEndPoint(),f=i[h-1],null!=f.offsetPoint&&(h=new primitives.common.Point(f.getEndPoint()),x=b.distanceTo(h),x>e&&(c*=x,a?(a=
f.offsetPoint(b,h,c),k=d(b.x,b.y,a.x,a.y,k,j)):(a=f.offsetPoint(h,b,c),k=d(h.x,h.y,a.x,a.y,k,j)),g(k))))},optimizeMoveSegments:function(){var a,b,d,c,e;d={};var g=[],h=[];a=0;for(b=i.length;a<b-1;a+=1)switch(c=i[a],e=i[a+1],c.segmentType){case 0:case 2:case 3:switch(e.segmentType){case 1:case 4:c=c.x+"&"+c.y,d.hasOwnProperty(c)||(d[c]=a)}break;case 1:c=c.x+"&"+c.y,d.hasOwnProperty(c)&&!g[d[c]]&&(g[d[c]]=a+1,h[a]=!0)}e=[];for(a=0;a<b;a+=1)if(!h[a]&&(c=i[a],e.push(c),h[a]=!0,0<g[a]))for(d=g[a];d<b&&
!h[d];)c=i[d],e.push(c),h[d]=!0,d=0<g[d]?g[d]:d+1;i=e},getOffsetPolyine:function(a){var d=new primitives.common.Polyline(h),c={},k=[],i=[];b(this,function(b){var h=b.clone();switch(h.segmentType){case 4:case 1:0<i.length&&g(i,c,a,d);k.length=0;1==h.segmentType&&(b=new primitives.common.Point(h),b.context=new e(h,0),k.push(b));break;default:h.loop(this,function(b,g,j){b=new primitives.common.Point(b,g);b.context=new e(h,j);k.unshift(b);1<k.length&&(i.unshift(new primitives.common.Vector(k[1].clone(),
k[0].clone())),k.length=1);switch(i.length){case 1:j=i[0];b=j.from.toString();c[b]=j;j.offset(a);j.from.context.pushToSegment(j.from);break;case 2:b=i[1],j=i[0],f(b,j,a,d,!1),i.length=1}})}d.addSegment(h)});0<i.length&&g(i,c,a,d);return d},toString:function(){return h.toString()},getStartPoint:function(){var a=null;0<i.length&&(a=i[0].getEndPoint());return a},getEndPoint:function(){var a=null;0<i.length&&(a=i[i.length-1].getEndPoint());return a},clone:function(){var a,b,d=new primitives.common.Polyline(h),
c=[],e;a=0;for(b=i.length;a<b;a+=1)e=i[a],c.push(e.clone());d.addSegments(c);return d}}};
primitives.common.PolylinesBuffer=function(){function a(a,b){a[b.toString()]||(a[b.toString()]=new primitives.common.Polyline(b));return a[b.toString()]}function b(a,b){var f,g;if(null!=b)for(f in c)if(c.hasOwnProperty(f)&&(g=c[f]))if(g.optimizeMoveSegments(),b.call(a,g))break}var c={};return{getPolyline:function(b){return a(c,b)},loop:b,addInverted:function(d,e){var f,g;f=c;c={};null!=d&&d(this);b(this,function(b){g=a(f,b.paletteItem);e?b.mergeTo(g):g.addInverted(b)});c=f},transform:function(a,c){b(this,
function(b){b.transform(a,c)})}}};primitives.common.QuadraticArcSegment=function(a,b,c,d){this.cpY=this.cpX=this.y=this.x=null;switch(arguments.length){case 2:this.x=b.x;this.y=b.y;this.cpX=a.x;this.cpY=a.y;break;case 4:this.cpX=a,this.cpY=b,this.x=c,this.y=d}this.segmentType=2};primitives.common.QuadraticArcSegment.prototype.clone=function(){return new primitives.common.QuadraticArcSegment(this.cpX,this.cpY,this.x,this.y)};
primitives.common.QuadraticArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX,this.cpY,0),b.call(a,this.x,this.y,1))};primitives.common.QuadraticArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX=a.x;this.cpY=a.y;break;case 1:this.x=a.x,this.y=a.y}};primitives.common.QuadraticArcSegment.prototype.getEndPoint=function(){return this};primitives.common.QuadraticArcSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};
primitives.common.QuadraticArcSegment.prototype.transform=function(a,b){var c=this;a.transformPoints(c.x,c.y,c.cpX,c.cpY,b,c,function(a,b,f,g){c.x=a;c.y=b;c.cpX=f;c.cpY=g})};
primitives.common.QuadraticArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c),e=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/e.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.QuadraticArcSegment.prototype.offsetPoint=function(a,b,c,d,e,f,g){return new primitives.common.Point((1-g)*(1-g)*a+2*(1-g)*g*c+g*g*e,(1-g)*(1-g)*b+2*(1-g)*g*d+g*g*f)};primitives.common.Size=function(a,b){this.height=this.width=0;switch(arguments.length){case 1:this.width=a.width;this.height=a.height;break;case 2:this.width=a,this.height=b}};primitives.common.Size.prototype.invert=function(){var a=this.width;this.width=this.height;this.height=a;return this};
primitives.common.Size.prototype.scale=function(a){this.width*=a;this.height*=a;return this};primitives.common.Size.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};primitives.common.Size.prototype.cropBySize=function(a){this.width=Math.min(this.width,a.width);this.height=Math.min(this.height,a.height);return this};
primitives.common.Size.prototype.addSize=function(a){this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height);return this};primitives.common.Size.prototype.validate=function(){if(isNaN(this.width)||isNaN(this.height))throw"Invalid size.";};primitives.common.Thickness=function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d};primitives.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom};
primitives.common.Thickness.prototype.toString=function(a){a=void 0!==a?a:"px";return this.left+a+", "+this.top+a+", "+this.right+a+", "+this.bottom+a};primitives.common.Vector=function(a,b){this.context=this.to=this.from=null;switch(arguments.length){case 1:this.from=a.from;this.to=a.to;break;case 2:this.from=a,this.to=b}};primitives.common.Vector.prototype.isNull=function(){return this.from.x==this.to&&this.from.y==this.to.y};primitives.common.Vector.prototype.length=function(){return this.from.distanceTo(this.to)};
primitives.common.Vector.prototype.equalTo=function(a){return this.from.equalTo(a.from)&&this.to.equalTo(a.to)};primitives.common.Vector.prototype.getMiddlePoint=function(){return new primitives.common.Point((this.from.x+this.to.x)/2,(this.from.y+this.to.y)/2)};
primitives.common.Vector.prototype.relateTo=function(a){var b=0,c=this.to.x-this.from.x,d=this.to.y-this.from.y,e=a.to.x-a.from.x,a=a.to.y-a.from.y;switch((c?8:0)+(d?4:0)+(e?2:0)+(a?1:0)){case 0:case 1:case 2:case 3:case 4:case 8:case 12:b=1;break;case 5:b=0<d*a?2:3;break;case 10:b=0<c*e?2:3;break;case 15:c/e==d/a&&(b=0<c/e?2:3)}return b};
primitives.common.Vector.prototype.offset=function(a){var b=this.length(),c=(this.to.y-this.from.y)*a/b,a=-(this.to.x-this.from.x)*a/b;this.from.x+=c;this.from.y+=a;this.to.x+=c;this.to.y+=a};primitives.common.Vector.prototype.getLine=function(){var a=this.from.x,b=this.from.y,c=this.to.x,d=this.to.y;return[d-b,a-c,a*(b-d)+b*(c-a)]};
primitives.common.Vector.prototype.getLineKey=function(){var a=this.getLine(),b=a[0],c=a[1],a=a[2],a=0!==c?[Math.floor(1E4*(b/c)),1,Math.floor(1E4*(a/c))]:[1,0,Math.floor(1E4*(a/b))];return a.toString()};
primitives.common.Vector.prototype.intersect=function(a){var b=this.getLine(),c=a.getLine(),d=(new primitives.common.Matrix(b[0],b[1],c[0],c[1])).determinant(),e;e=!1;0!==d&&(e=new primitives.common.Matrix(-b[2],b[1],-c[2],c[1]),e=e.determinant(),b=new primitives.common.Matrix(b[0],-b[2],c[0],-c[2]),b=b.determinant(),c=e/d,d=b/d,a.to.x=c,a.to.y=d,this.from.x=c,this.from.y=d,e=!0);return e};
primitives.common.Vector.prototype.getIntersectionPoint=function(a,b,c){var d=this.getLine(),e=a.getLine(),f=(new primitives.common.Matrix(d[0],d[1],e[0],e[1])).determinant(),g,h=null;0!==f&&(g=new primitives.common.Matrix(-d[2],d[1],-e[2],e[1]),g=g.determinant(),d=new primitives.common.Matrix(d[0],-d[2],e[0],-e[2]),d=d.determinant(),g/=f,f=d/f,b?a._contains(g,f,c)&&this._contains(g,f,c)&&(h=new primitives.common.Point(g,f)):h=new primitives.common.Point(g,f));return h};
primitives.common.Vector.prototype._contains=function(a,b,c){var d=Math.min(this.from.x,this.to.x),e=Math.min(this.from.y,this.to.y),f=Math.max(this.from.x,this.to.x),g=Math.max(this.from.y,this.to.y);return d-c<=a&&a<=f+c&&e-c<=b&&b<=g+c};
primitives.common.Graphics=function(a){this.m_element=a;this.m_placeholders={};this.m_activePlaceholder=null;this.m_cache=new primitives.common.Cache;this.graphicsType=null;this.debug=this.hasGraphics=!1;this.layerNames={};primitives.common.loop(this,primitives.common.Layers,function(a,c){this.layerNames[c]=a})};
primitives.common.Graphics.prototype.clean=function(){var a,b,c,d;this.m_cache.clear();this.m_element=this.m_cache=null;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a)){b=this.m_placeholders[a];for(c in b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],d.canvas.parentNode.removeChild(d.canvas),d.canvas=null);b.layers.length=0;b.activeLayer=null;b.size=null;b.rect=null;b.div=null}this.m_placeholders.length=0;this.m_activePlaceholder=null};
primitives.common.Graphics.prototype.resize=function(a,b,c){a=this.m_placeholders[a];null!=a&&this.resizePlaceholder(a,b,c)};primitives.common.Graphics.prototype.resizePlaceholder=function(a,b,c){var d;a.size=new primitives.common.Size(b,c);a.rect=new primitives.common.Rect(0,0,b,c);for(d in a.layers)a.layers.hasOwnProperty(d)&&(b=a.layers[d],-1!==b.name&&primitives.common.JsonML.applyStyles(b.canvas,{position:"absolute",width:"0px",height:"0px"}))};primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()};
primitives.common.Graphics.prototype.end=function(){this.m_cache.end()};primitives.common.Graphics.prototype.reset=function(a,b){var c="none",d=-1;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.m_cache.reset(c,d)};
primitives.common.Graphics.prototype.activate=function(a,b){switch(arguments.length){case 1:"string"===typeof a?(this._activatePlaceholder(a),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(a));break;case 2:this._activatePlaceholder(a),this._activateLayer(b)}return this.m_activePlaceholder};
primitives.common.Graphics.prototype._activatePlaceholder=function(a){var b=this.m_placeholders[a],c;void 0===b&&("none"===a?c=this.m_element:(b=this.m_element.getElementsByClassName(a),c=0<b.length?b[0]:this.m_element),b=new primitives.common.Placeholder(a),b.div=c,b.size=primitives.common.getInnerSize(c),b.rect=new primitives.common.Rect(0,0,b.size.width,b.size.height),this.m_placeholders[a]=b);this.m_activePlaceholder=b};
primitives.common.Graphics.prototype._activateLayer=function(a){var b=this.m_activePlaceholder.layers[a],c,d,e,f;if(void 0===b){c=this.m_activePlaceholder;if(-1===a)b=new primitives.common.Layer(a),b.canvas=c.div;else{d=primitives.common.JsonML.toHTML(["div",{style:{position:"absolute",width:"0px",height:"0px"},"class":["Layer"+a,"Layer"+this.layerNames[a]]}]);e=null;for(f in c.layers)c.layers.hasOwnProperty(f)&&(b=c.layers[f],b.name<a&&(e=null!==e?Math.max(e,b.name):b.name));b=new primitives.common.Layer(a);
b.canvas=d;null===e?this.prepend(c.div,b.canvas):this.insertAfter(c.layers[e].canvas,b.canvas)}c.layers[a]=b}this.m_activePlaceholder.activeLayer=b};primitives.common.Graphics.prototype.prepend=function(a,b){null==a.firstChild?a.appendChild(b):a.insertBefore(b,a.firstChild)};primitives.common.Graphics.prototype.insertAfter=function(a,b){var c=a.parentNode;c.lastChild==a?c.appendChild(b):c.insertBefore(b,a.nextSibling)};
primitives.common.Graphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j=this.m_activePlaceholder,g={position:"absolute",padding:0,margin:0,textAlign:this._getTextAlign(g),fontSize:i.fontSize,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontStyle:i.fontStyle,color:i.fontColor,lineHeight:1},i="";switch(f){case 0:case 3:g.left=a+"px";g.top=b+"px";g.width=c+"px";g.height=d+"px";break;case 1:g.left=a+Math.round(c/2-d/2)+"px";g.top=b+Math.round(d/2-c/2)+"px";g.width=d+"px";g.height=c+"px";i="rotate(-90deg)";
break;case 2:g.left=a+Math.round(c/2-d/2)+"px",g.top=b+Math.round(d/2-c/2)+"px",g.width=d+"px",g.height=c+"px",i="rotate(90deg)"}g["-webkit-transform-origin"]="center center";g["-moz-transform-origin"]="center center";g["-o-transform-origin"]="center center";g["-ms-transform-origin"]="center center";g["-webkit-transform"]=i;g["-moz-transform"]=i;g["-o-transform"]=i;g["-ms-transform"]=i;g.transform=i;g.maxWidth=g.width;g.maxHeight=g.height;e=e.replace(RegExp("\n","g"),"<br/>");switch(h){case 0:this.debug&&
(g.border="solid 1px black");b=this.m_cache.get(j.name,j.activeLayer.name,"text");null===b?(b=primitives.common.JsonML.toHTML(["div",{style:g,$:function(a){a.innerHTML=e}}]),j.activeLayer.canvas.appendChild(b),this.m_cache.put(j.name,j.activeLayer.name,"text",b)):(primitives.common.JsonML.applyStyles(b,g),b.innerHTML=e);break;default:g.borderCollapse="collapse",a={verticalAlign:this._getVerticalAlignment(h),padding:0},this.debug&&(a.border="solid 1px black"),b=this.m_cache.get(j.name,j.activeLayer.name,
"textintable"),null===b?(b=primitives.common.JsonML.toHTML(["table",{style:g},["tbody",["tr",["td",{style:a,$:function(a){a.innerHTML=e}}]]]]),j.activeLayer.canvas.appendChild(b),this.m_cache.put(j.name,j.activeLayer.name,"textintable",b)):(primitives.common.JsonML.applyStyles(b,g),j=b.getElementsByTagName("td")[0],primitives.common.JsonML.applyStyles(j,a),j.innerHTML=e)}};
primitives.common.Graphics.prototype._getTextAlign=function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b="right"}return b};primitives.common.Graphics.prototype._getVerticalAlignment=function(a){var b=null;switch(a){case 1:b="middle";break;case 0:b="top";break;case 2:b="bottom"}return b};primitives.common.Graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.common.Graphics.prototype.polyline=function(a){var b=null,c=null,d=a.paletteItem.toAttr();a.loop(this,function(a){switch(a.segmentType){case 1:b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 0:this.rightAngleLine(b,c,Math.round(a.x)+0.5,Math.round(a.y)+0.5,d);b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 4:this.dot(a.x,a.y,a.width,a.height,a.cornerRadius,d)}})};
primitives.common.Graphics.prototype.dot=function(a,b,c,d,e,f){var g=this.m_activePlaceholder,h=this.m_cache.get(g.name,g.activeLayer.name,"dot"),i=void 0!==f.lineWidth&&void 0!==f.borderColor,a={position:"absolute",width:c-(i?1:0),top:Math.round(b),left:Math.round(a),padding:0,margin:0,lineHeight:"0px",overflow:"hidden",height:d-(i?1:0),background:f.fillColor,MozBorderRadius:e,WebkitBorderRadius:e,"-khtml-border-radius":e,borderRadius:e,fontSize:"0px",borderStyle:i?"Solid":"None",borderWidth:i?"1px":
"0px",borderColor:i?f.borderColor:""};null===h?(h=primitives.common.JsonML.toHTML(["div",{style:a}]),g.activeLayer.canvas.appendChild(h),this.m_cache.put(g.name,g.activeLayer.name,"dot",h)):primitives.common.JsonML.applyStyles(h,a)};
primitives.common.Graphics.prototype.rightAngleLine=function(a,b,c,d,e){var f=this.m_activePlaceholder,g=Math.abs(d-b)>Math.abs(c-a),h=e.lineWidth,e={position:"absolute",top:Math.round(Math.min(b,d)-(g?0:h/2)),left:Math.round(Math.min(a,c)-(g?h/2:0)),padding:0,margin:0,opacity:0.5,lineHeight:"0px",overflow:"hidden",background:e.borderColor,fontSize:"0px"};g?(e.width=h,e.height=Math.abs(Math.round(d-b))):(e.width=Math.abs(Math.round(c-a)),e.height=h);a=this.m_cache.get(f.name,f.activeLayer.name,"rect");
null===a?(a=primitives.common.JsonML.toHTML(["div",{style:e}]),f.activeLayer.canvas.appendChild(a),this.m_cache.put(f.name,f.activeLayer.name,"rect",a)):primitives.common.JsonML.applyStyles(a,e)};
primitives.common.Graphics.prototype.template=function(a,b,c,d,e,f,g,h,i,j,k,m,l){var c=this.m_activePlaceholder,d="template"+(null!==j?j:primitives.common.hashCode(i)),n=0,p,j=this.m_cache.get(c.name,c.activeLayer.name,d);null!==l&&void 0!==l.borderWidth&&(n=this.getPxSize(l.borderWidth));p={width:g-n+"px",height:h-n+"px",top:b+f+"px",left:a+e+"px"};primitives.common.mergeObjects(p,l);null==m&&(m=new primitives.common.RenderEventArgs);m.x=a+e;m.y=b+f;m.width=g-n;m.height=h-n;null==j?(j=this.getElementByTemplate(i),
p=primitives.common.mergeObjects(p,{position:"absolute",padding:"0px",margin:"0px"},l),primitives.common.JsonML.applyStyles(j,p),m.element=j,m.renderingMode=0,null!==k&&k(null,m),c.activeLayer.canvas.appendChild(j),this.m_cache.put(c.name,c.activeLayer.name,d,j)):(m.element=j,m.renderingMode=1,primitives.common.JsonML.applyStyles(j,p),null!==k&&k(null,m));return j};
primitives.common.Graphics.prototype.getElementByTemplate=function(a){var b=null;primitives.common.isArray(a)?b=primitives.common.JsonML.toHTML(a):(b=document.createElement("div"),b.innerHTML=a,b=b.firstChild);return b};primitives.common.Graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.common.Cache=function(){this.threshold=20;this.m_visible={};this.m_invisible={}};primitives.common.Cache.prototype.begin=function(){var a,b,c,d;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(c=this.m_visible[a][b].length-1;0<=c;c-=1)d=this.m_visible[a][b][c],d.style.visibility="hidden",this.m_invisible[a][b].push(d);this.m_visible[a][b].length=0}};
primitives.common.Cache.prototype.end=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)&&this.m_invisible[a][b].length>this.threshold)for(;void 0!==(c=this.m_invisible[a][b].pop());)c.parentNode.removeChild(c)};
primitives.common.Cache.prototype.reset=function(a,b){var a=a+"-"+b,c=null,d,e;for(d in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(d)){for(e=this.m_visible[a][d].length-1;0<=e;e-=1)c=this.m_visible[a][d][e],this.m_invisible[a][d].push(c),c.style.visibility="hidden";this.m_visible[a][d].length=0}};
primitives.common.Cache.prototype.clear=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(;void 0!==(c=this.m_visible[a][b].pop());)c.parentNode.removeChild(c);for(;void 0!==(c=this.m_invisible[a][b].pop());)c.parentNode.removeChild(c)}};
primitives.common.Cache.prototype.get=function(a,b,c){a=a+"-"+b;b=null;void 0===this.m_visible[a]&&(this.m_visible[a]={},this.m_invisible[a]={});void 0===this.m_visible[a][c]&&(this.m_visible[a][c]=[],this.m_invisible[a][c]=[]);b=this.m_invisible[a][c].pop()||null;null!==b&&(this.m_visible[a][c].push(b),b.style.visibility="inherit");return b};primitives.common.Cache.prototype.put=function(a,b,c,d){this.m_visible[a+"-"+b][c].push(d)};
primitives.common.CanvasGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.graphicsType=1;this.m_maximum=8E3};primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics;
primitives.common.CanvasGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&(d.canvascanvas.parentNode.removeChild(d.canvascanvas),d.canvascanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(a){var b,c,d;this.parent._activatePlaceholder.apply(this,arguments);b=this.m_activePlaceholder;c=b.size.width;d=b.size.height;b.hasGraphics=c>this.m_maximum||d>this.m_maximum?!1:!0};
primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.canvascanvas&&(e.canvascanvas.width=b,e.canvascanvas.height=c))};
primitives.common.CanvasGraphics.prototype.begin=function(){var a,b,c,d,e,f;this.parent.begin.apply(this);for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],e=b.size.width,f=b.size.height,b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,e,f))};
primitives.common.Graphics.prototype._getContext=function(a,b){var c=a.size.width,d=a.size.height;null===b.canvascanvas&&(b.canvascanvas=document.createElement("canvas"),b.canvascanvas.width=c,b.canvascanvas.height=d,this.prepend(a.activeLayer.canvas,b.canvascanvas),b.canvascontext=b.canvascanvas.getContext("2d"));return b.canvascontext};
primitives.common.CanvasGraphics.prototype.reset=function(a,b){var c="none",d=-1,e,f;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.parent.reset.apply(this,arguments);e=this.m_placeholders[c];void 0!==e&&(c=e.size.width,f=e.size.height,d=e.layers[d],void 0!==d&&null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,c,f))};
primitives.common.CanvasGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,e=a.paletteItem.toAttr(),f,g;if(b.hasGraphics){c=b.activeLayer;d=this._getContext(b,c);d.save();void 0!==e.lineWidth&&void 0!==e.borderColor?(d.strokeStyle=e.borderColor,d.lineWidth=e.lineWidth):(d.lineWidth=0,d.strokeStyle="Transparent");if(null!=e.lineType){b=Math.round(e.lineWidth)||1;switch(e.lineType){case 0:f=[];break;case 1:f=[b,b];break;case 2:f=[5*b,3*b]}void 0!==d.setLineDash?d.setLineDash(f):
void 0!==d.webkitLineDash?d.webkitLineDash=f:void 0!==d.mozDash&&(d.mozDash=f)}d.beginPath();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(d.moveTo(Math.round(a.x)+a.width+0.5,Math.round(a.y)+a.height/2+0.5),d.arc(Math.round(a.x)+a.width/2+0.5,Math.round(a.y)+a.height/2+0.5,Math.round(a.width/2),0,2*Math.PI,!1)):0===a.cornerRadius?
(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(g=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.moveTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),Math.PI,-Math.PI/2,!1),d.lineTo(Math.round(a.x+
a.width-g)+0.5,Math.round(a.y)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),-Math.PI/2,0,!1),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height-g)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),0,Math.PI/2,!1),d.lineTo(Math.round(a.x+g)+0.5,Math.round(a.y+a.height)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),Math.PI/2,Math.PI,!1),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5));break;
case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});null!=e.opacity&&(d.globalAlpha=e.opacity);void 0!==e.lineWidth&&d.stroke();void 0!==e.fillColor&&(d.fillStyle=e.fillColor,d.fill());d.restore()}else this.parent.polyline.apply(this,arguments)};
primitives.common.Element=function(a,b){this.name=this.ns=null;this.attr={};this.style={};this.children=[];switch(arguments.length){case 1:this.name=a;break;case 2:this.ns=a,this.name=b}};primitives.common.Element.prototype.setAttribute=function(a,b){this.attr[a]=b};primitives.common.Element.prototype.appendChild=function(a){this.children[this.children.length]=a};
primitives.common.Element.prototype.create=function(a){var b=null,c,d,b=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(c in this.attr)this.attr.hasOwnProperty(c)&&(void 0!==a?b[c]=this.attr[c]:b.setAttribute(c,this.attr[c]));for(c in this.style)this.style.hasOwnProperty(c)&&(b.style[c]=this.style[c]);for(d=0;d<this.children.length;d+=1)c=this.children[d],"string"===typeof c?b.appendChild(document.createTextNode(c)):b.appendChild(c.create(a));return b};
primitives.common.Element.prototype.update=function(a,b){var c,d,e;for(c in this.style)this.style.hasOwnProperty(c)&&(d=this.style[c],a.style[c]!==d&&(a.style[c]=d));for(c in this.attr)this.attr.hasOwnProperty(c)&&(d=this.attr[c],void 0!==b?a[c]!==d&&(a[c]=d):a.getAttribute(c)!==d&&a.setAttribute(c,d));c=this.children.length;for(d=0;d<c;d+=1)e=this.children[d],"string"===typeof e?a.innerHtml!==e&&(a.innerHtml=e):this.children[d].update(a.children[d],b)};
primitives.common.Layer=function(a){this.name=a;this.svgcanvas=this.canvascanvas=this.canvas=null};primitives.common.Placeholder=function(a){this.name=a;this.layers={};this.div=this.rect=this.size=this.activeLayer=null;this.hasGraphics=!0};primitives.common.SvgGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this._svgxmlns="http://www.w3.org/2000/svg";this.graphicsType=0;this.hasGraphics=!0};
primitives.common.SvgGraphics.prototype=new primitives.common.Graphics;primitives.common.SvgGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.svgcanvas&&(d.svgcanvas.parentNode.removeChild(d.svgcanvas),d.svgcanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.SvgGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.svgcanvas&&(primitives.common.JsonML.applyStyles(e.svgcanvas,{position:"absolute",width:b+"px",height:c+"px"}),e.svgcanvas.viewBox="0 0 "+b+" "+c))};
primitives.common.SvgGraphics.prototype._getCanvas=function(){var a=this.m_activePlaceholder,b=a.activeLayer,c=a.rect;null===b.svgcanvas&&(b.svgcanvas=document.createElementNS(this._svgxmlns,"svg"),b.svgcanvas.viewBox=c.x+" "+c.y+" "+c.width+" "+c.height,primitives.common.JsonML.applyStyles(b.svgcanvas,{width:c.width+"px",height:c.height+"px"}),this.prepend(a.activeLayer.canvas,b.svgcanvas));return b.svgcanvas};
primitives.common.SvgGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,e=a.paletteItem.toAttr(),f,g,h;c=new primitives.common.Element(this._svgxmlns,"path");void 0!==e.fillColor?(c.setAttribute("fill",e.fillColor),c.setAttribute("fill-opacity",e.opacity)):c.setAttribute("fill-opacity",0);void 0!==e.lineWidth&&void 0!==e.borderColor?(c.setAttribute("stroke",e.borderColor),c.setAttribute("stroke-width",e.lineWidth),void 0!==e.opacity?c.setAttribute("stroke-opacity",e.opacity):
c.setAttribute("stroke-opacity",1)):(c.setAttribute("stroke","transparent"),c.setAttribute("stroke-width",0));if(null!=e.lineType)switch(f=Math.round(e.lineWidth)||1,e.lineType){case 0:c.setAttribute("stroke-dasharray","");break;case 1:c.setAttribute("stroke-dasharray",f+","+f);break;case 2:c.setAttribute("stroke-dasharray",5*f+","+3*f)}d="";a.loop(this,function(a){switch(a.segmentType){case 1:d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 0:d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+
0.5);break;case 2:d+="Q"+(Math.round(a.cpX)+0.5)+" "+(Math.round(a.cpY)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(g=a.width/2,d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5)):0===a.cornerRadius?(d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+
0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)):(h=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width-
h)+0.5)+" "+(Math.round(a.y)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width-h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),
d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5));break;case 3:d+="C"+(Math.round(a.cpX1)+0.5)+" "+(Math.round(a.cpY1)+0.5)+" "+(Math.round(a.cpX2)+0.5)+" "+(Math.round(a.cpY2)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)}});c.setAttribute("d",d);a=this.m_cache.get(b.name,b.activeLayer.name,"path");null===a?(a=c.create(),c=this._getCanvas(),c.appendChild(a),this.m_cache.put(b.name,b.activeLayer.name,"path",a)):c.update(a)};
primitives.common.Transform=function(){this.invertVertically=this.invertHorizontally=this.invertArea=!1;this.size=null};
primitives.common.Transform.prototype.setOrientation=function(a){switch(a){case 0:this.invertVertically=this.invertHorizontally=this.invertArea=!1;break;case 1:this.invertHorizontally=this.invertArea=!1;this.invertVertically=!0;break;case 2:this.invertArea=!0;this.invertVertically=this.invertHorizontally=!1;break;case 3:this.invertHorizontally=this.invertArea=!0,this.invertVertically=!1}};
primitives.common.Transform.prototype.getOrientation=function(a){var b=a;if(this.invertHorizontally)switch(a){case 2:b=3;break;case 3:b=2}if(this.invertVertically)switch(a){case 0:b=1;break;case 1:b=0}if(this.invertArea)switch(b){case 0:b=2;break;case 1:b=3;break;case 2:b=0;break;case 3:b=1}return b};
primitives.common.Transform.prototype.transformPoint=function(a,b,c,d,e){var f;c&&this.invertArea&&(f=a,a=b,b=f);this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);!c&&this.invertArea&&(f=a,a=b,b=f);e.call(d,a,b)};
primitives.common.Transform.prototype.transformPoints=function(a,b,c,d,e,f,g){var h;e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d);!e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(f,a,b,c,d)};
primitives.common.Transform.prototype.transform3Points=function(a,b,c,d,e,f,g,h,i){var j;g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c,e=this.size.width-e);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d,f=this.size.height-f);!g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);i.call(h,a,b,c,d,e,f)};
primitives.common.Transform.prototype.transformRect=function(a,b,c,d,e,f,g){var h;e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a-c);this.invertVertically&&(b=this.size.height-b-d);!e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(f,a,b,c,d)};
primitives.common.ArrayReader=function(a,b,c,d,e){this.itemTemplate=a;this.containsUniqueItems=b;this.uniquePropertyKey=c;this.containsPrimitiveValues=primitives.common.isNullOrEmpty(c);this.createSourceHash=d;this.isOrdered=e};
primitives.common.ArrayReader.prototype.read=function(a,b,c,d){var e=[],f={},g,h,i={},j={},k,m,l,n,p,q=c+"-seq";if(!b||!primitives.common.isArray(b))b=[];g=d.hash.hasOwnProperty(c)?d.hash[c]:{};h=d.hash.hasOwnProperty(q)?d.hash[q]:{};l=0;for(n=b.length;l<n;l+=1)k=b[l],m=this.containsUniqueItems?this.containsPrimitiveValues?k:k[this.uniquePropertyKey]:l,f.hasOwnProperty(m)||(p=this.itemTemplate.read(g.hasOwnProperty(m)?g[m]:{},k,c+"-"+l,d),e.push(p),f[m]=p,i[l]=m,this.createSourceHash&&(j[m]=k),this.isOrdered&&
h[l]!=i[l]&&(d.isChanged=!0));d.hash[c]=f;d.hash[q]=i;this.createSourceHash&&(d.sourceHash[c]=j);if(null==a||a.length!=e.length)d.isChanged=!0;return e};primitives.common.EnumerationReader=function(a,b,c){this.enumeration=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(var d in a)this.hash[a[d]]=d};
primitives.common.EnumerationReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};primitives.common.FunctionReader=function(){};primitives.common.FunctionReader.prototype.read=function(a,b){return"function"==typeof b?b:null};primitives.common.ObjectReader=function(a,b,c){this.dataTemplate=a;this.isNullable=b;this.defaultValue=c};
primitives.common.ObjectReader.prototype.read=function(a,b,c,d){var e=null,f,g;b||(b=this.isNullable?null:this.defaultValue);if(primitives.common.isObject(b))for(f in e={},this.dataTemplate)this.dataTemplate.hasOwnProperty(f)&&(g=this.dataTemplate[f],e[f]=g.read(primitives.common.isObject(a)?a[f]:null,b[f],c+"-"+f,d));else e=b,a!==b&&(d.isChanged=!0);return e};
primitives.common.ValueReader=function(a,b,c){this.acceptedTypes=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(b=0;b<a.length;b+=1)this.hash[a[b]]=!0};primitives.common.ValueReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(typeof b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};
primitives.famdiagram.EventArgs=function(){this.context=this.oldContext=null;this.parentItems=[];this.childrenItems=[];this.name=this.position=null;this.cancel=!1};
primitives.famdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.famdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.zOrderType=0;this.offset=new primitives.common.Thickness(18,18,18,18);this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.famdiagram.Config=function(a){this.name=void 0!==a?a:"FamDiagram";this.classPrefix="famdiagram";this.graphicsType=this.navigationMode=0;this.pageFitMode=3;this.minimalVisibility=2;this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.showExtraArrows=!0;this.extraArrowsMinimumSpace=30;this.groupByType=2;this.alignBylevels=!0;this.enableMatrixLayout=!1;this.minimumMatrixSize=4;this.maximumColumnsInMatrix=6;this.hideGrandParentsConnectors=!1;this.elbowType=3;this.elbowDotSize=
this.bevelSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=[];this.annotations=[];this.highlightItem=this.cursorItem=null;this.highlightGravityRadius=40;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.neighboursSelectionMode=this.selectionPathMode=0;this.templates=[];this.defaultLabelAnnotationTemplate=this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=
this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=
1;this.linesType=0;this.showNeigboursConnectorsHighlighted=!1;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=0;this.linesPalette=[];this.calloutMaximumVisibility=2;this.showCallout=!0;this.calloutPlacementOffset=100;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.buttonsPanelSize=28;
this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.groupTitleOrientation=this.groupTitlePlacementType=2;this.groupTitleVerticalAlignment=1;this.groupTitleHorizontalAlignment=0;this.groupTitleFontSize="12px";this.groupTitleFontFamily="Arial";this.groupTitleColor="#4169e1";this.groupTitleFontStyle=this.groupTitleFontWeight="normal";this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=1;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=
0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0;this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.famdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorPlacementType=this.connectorShapeType=0;this.labelPlacementType=1;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=
a,this.toItem=b}};primitives.famdiagram.HighlightPathAnnotationConfig=function(a){var b;this.zOrderType=this.annotationType=2;this.items=[];this.lineWidth=2;this.color="#ff0000";this.lineType=0;this.opacity=1;this.showArrows=!0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ItemConfig=function(a,b,c,d,e){var f;this.id=null;this.parents=[];this.spouses=[];this.context=this.image=this.description=this.title=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=!0;this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(f in a)a.hasOwnProperty(f)&&
(this[f]=a[f]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=e}};primitives.famdiagram.LabelAnnotationConfig=function(a,b){var c;this.annotationType=3;this.fromItem=null;this.toItems=[];this.title=null;this.itemTitleColor="#4169e1";this.templateName=null;switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=a,this.toItem=b}};
primitives.famdiagram.PaletteItemConfig=function(a,b,c){var d;this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;switch(arguments.length){case 1:for(d in a)a.hasOwnProperty(d)&&(this[d]=a[d]);break;case 3:this.lineColor=a,this.lineWidth=b,this.lineType=c}};
primitives.famdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.EdgeItem=function(a,b,c,d){this.values=[b,d];this[a]=0;this[c]=1};primitives.famdiagram.EdgeItem.prototype.getNear=function(a){return this.values[this[a]]};primitives.famdiagram.EdgeItem.prototype.getFar=function(a){return this.values[Math.abs(this[a]-1)]};primitives.famdiagram.EdgeItem.prototype.setNear=function(a,b){this.values[this[a]]=b};
primitives.famdiagram.EdgeItem.prototype.setFar=function(a,b){this.values[Math.abs(this[a]-1)]=b};primitives.famdiagram.EdgeItem.prototype.toString=function(){return this.parent+","+this.child};
primitives.famdiagram.FamilyItem=function(a){var b;this.itemConfig=this.familyId=this.id=null;this.isActive=this.isVisible=!0;this.isLevelNeutral=!1;this.level=null;this.levelGravity=0;this.hideChildrenConnection=this.hideParentConnection=!1;switch(arguments.length){case 1:for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.Slot=function(a){this.position=this.next=this.prev=this.id=null;this.balance=0;this.itemId=a;this.left={};this.right={};this.crossings={}};
primitives.famdiagram.Slot.prototype.clone=function(){var a=new primitives.famdiagram.Slot,b;a.itemId=this.itemId;for(b in this.left)this.left.hasOwnProperty(b)&&(a.left[b]=this.left[b]);for(b in this.right)this.right.hasOwnProperty(b)&&(a.right[b]=this.right[b]);for(b in this.crossings)this.crossings.hasOwnProperty(b)&&(a.crossings[b]=this.crossings[b]);return a};primitives.famdiagram.Slots=function(){this.last=this.first=null;this.slots={};this.items={};this.counter=0};
primitives.famdiagram.Slots.prototype.add=function(a){a.id=this.counter;this.counter+=1;this.slots[a.id]=a;null!=a.itemId&&(this.items[a.itemId]=a);null==this.last?this.first=this.last=a.id:(this.slots[this.last].next=a.id,a.prev=this.last,this.last=a.id)};
primitives.famdiagram.Slots.prototype.insertBefore=function(a,b){b.id=this.counter;this.counter+=1;this.slots[b.id]=b;null!=b.itemId&&(this.items[b.itemId]=b);if(null==a.prev)b.next=a.id,this.first=b.id;else{var c=this.slots[a.prev];c.next=b.id;b.next=a.id;a.prev=b.id;b.prev=c.id}};primitives.famdiagram.Slots.prototype.loop=function(a,b){for(var c=null!=b?b.id:this.first;null!=c;){c=this.slots[c];if(a(c))break;c=c.next}};
primitives.famdiagram.Slots.prototype.backwardLoop=function(a,b){for(var c=null!=b?b.id:this.last;null!=c;){c=this.slots[c];if(a(c))break;c=c.prev}};primitives.famdiagram.Slots.prototype.getSlot=function(a){return this.items[a]};
primitives.famdiagram.LabelAnnotationOptionTask=function(a,b,c){var d=[],e={},f=null,g={},h=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,c.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],
!1,c.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)},!1),!1,null,!0);return{process:function(){var c={isChanged:!1,hash:g,sourceHash:{}},j=b.getMaximumId(),k,m,l;d=h.read(d,a.getAnnotations(3),"annotations",c);e={};var n=c.sourceHash.annotations;k=0;for(m=d.length;k<m;k+=1)l=d[k],j+=1,l.id=j,e[l.id]=n[k];f=j;return c.isChanged},getAnnotations:function(){return d},getMaximumId:function(){return f},getConfig:function(a){return e[a]}}};
primitives.famdiagram.LabelAnnotationPlacementOptionTask=function(a){var b=[],c={},d=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id");return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getAnnotations(),"annotations",e);return e.isChanged},
getAnnotations:function(){return b},getMaximumId:function(){return a.getMaximumId()}}};
primitives.famdiagram.LabelAnnotationTemplateOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id");return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(),
"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};primitives.famdiagram.NeighboursSelectionModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({neighboursSelectionMode:new primitives.common.EnumerationReader(primitives.common.NeighboursSelectionMode,!1,b.neighboursSelectionMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getNeighboursSelectionMode:function(){return c.neighboursSelectionMode}}};
primitives.famdiagram.ItemsOptionTask=function(a,b){var c={},d={},e={},f=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parents:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:e};
c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return e["options-items"][a]}}};
primitives.famdiagram.LinePaletteOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({linesPalette:new primitives.common.ArrayReader(new primitives.common.ObjectReader({lineColor:new primitives.common.ValueReader(["string"],!1,b.lineColor),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType)}),!1)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),
"options",b);return b.isChanged},getOptions:function(){return c}}};
primitives.famdiagram.NormalizeOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({groupByType:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.groupByType),alignBylevels:new primitives.common.ValueReader(["boolean"],!1,b.alignBylevels),hideGrandParentsConnectors:new primitives.common.ValueReader(["boolean"],!1,b.hideGrandParentsConnectors),enableMatrixLayout:new primitives.common.ValueReader(["boolean"],!1,b.enableMatrixLayout),minimumMatrixSize:new primitives.common.ValueReader(["number"],
!1,b.minimumMatrixSize),maximumColumnsInMatrix:new primitives.common.ValueReader(["number"],!1,b.maximumColumnsInMatrix)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c}}};primitives.famdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.famdiagram.SpousesOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),spouses:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",e);return e.isChanged},getItems:function(){return b.items}}};
primitives.famdiagram.VisualTreeOptionTask=function(){var a={leavesPlacementType:2,childrenPlacementType:2,maximumColumnsInMatrix:6,horizontalAlignment:0};return{process:function(){return!1},getOptions:function(){return a}}};primitives.famdiagram.CombinedTemplateParamsTask=function(a,b){return{process:function(){return!0},getTemplateParams:function(c){return a.getTemplateParams(c)||b.getTemplateParams(c)}}};
primitives.famdiagram.LabelAnnotationTemplateParamsTask=function(a,b,c){var d={};return{process:function(){var e=a.getOptions(),f=b.getAnnotations(),g,h;d={};g=0;for(h=f.length;g<h;g+=1){var i=f[g],j=new primitives.orgdiagram.TemplateParams,k=c.getTemplate(i.templateName,e.defaultLabelAnnotationTemplate,c.DefaultWidgetLabelAnnotationTemplateName);j.template=k;d[i.id]=j}return!0},getTemplateParams:function(a){return d[a]}}};primitives.famdiagram.BaseTransformer=function(a){this.debug=a};
primitives.famdiagram.BaseTransformer.prototype.validate=function(a,b){if(!a.validate())throw"Family structure failed to pass validation!";a.loop(this,function(c,d){a.loopChildren(this,c,function(c,f){if(null===f.level||null===d.level||(b?f.level!=d.level+1:f.level<=d.level))throw"Family tree is broken. Children/Parents or levels mismatch!";return a.SKIP})})};primitives.famdiagram.FamilyBalance=function(){this.properties="title description image itemTitleColor groupTitle groupTitleColor isActive hasSelectorCheckbox hasButtons templateName showCallout calloutTemplateName label showLabel labelSize labelOrientation labelPlacement minimizedItemShapeType".split(" ")};
primitives.famdiagram.FamilyBalance.prototype.balance=function(a){var b={maximumId:null,treeLevels:primitives.common.TreeLevels(),bundles:[],connectorStacks:[]},c={orgTree:primitives.common.tree(),maximumId:a.maximumId,orgPartners:{},itemByChildrenKey:{},minimumLevel:null,maximumLevel:null};this.createOrgTree(a,c);c.orgTree.loopLevels(this,function(a,c,f){b.treeLevels.addItem(f,a,c)});this.recalcLevelsDepth(b.bundles,b.connectorStacks,b.treeLevels,c.orgTree,c.orgPartners);b.maximumId=c.maximumId;
return b};primitives.famdiagram.FamilyBalance.prototype.Family=function(a){this.id=null;this.familyPriority=1;this.childFamilies=[];this.items=[];this.links=[];this.backLinks=[];1==arguments.length&&(this.id=a)};primitives.famdiagram.FamilyBalance.prototype.FamLink=function(a,b){this.fromItem=a;this.toItem=b};
primitives.famdiagram.FamilyBalance.prototype.createOrgTree=function(a,b){var c,d,e,f,g,h,i,j,k=[],m,l,n,p,q,s,r,v,u,x,w=[],z;if(0<a.logicalFamily.hasNodes()){x={};l=0;z=[];a.logicalFamily.loopRoots(this,function(d){n=new this.Family(l);this.extractOrgChart(d,a.logicalFamily,a.defaultItemConfig,b.orgTree,b.orgPartners,b.itemByChildrenKey,x,n);w.push(n);z.push(n);l+=1});z.sort(function(a,b){var d=a.items[0].level,c=b.items[0].level;return d!=c?d-c:b.items.length-a.items.length});k=[];m={};if(0<w.length){g=
primitives.common.graph();c=0;for(d=w.length;c<d;c+=1){n=w[c];e=0;for(f=n.links.length;e<f;e+=1)h=n.links[e],i=a.logicalFamily.node(h.fromItem).familyId,j=a.logicalFamily.node(h.toItem).familyId,i!=j&&(g.addEdge(i,j,{weight:0}),g.edge(i,j).weight+=1),w[j].backLinks.push(new this.FamLink(h.toItem,h.fromItem))}for(;k.length<w.length;){c=0;for(d=z.length;c<d;c+=1)n=z[c],m.hasOwnProperty(n.id)||(v=g.getSpanningTree(n.id,function(a){return-a.weight}),null!=v.node(n.id)?(v.loopPostOrder(this,function(a,
b,d){var b=w[a],c=w[d],e=[];null!=d&&(c.familyPriority+=b.familyPriority);e=[];v.loopChildren(this,a,function(a){e.push(a)});e.sort(function(a,b){return w[a].familyPriority-w[b].familyPriority});v.arrangeChildren(a,e)}),v.loopPreOrder(this,function(a){k.push(a);m[a]=!0})):(k.push(n.id),m[n.id]=!0))}}b.maximumId+=1;u=this.createOrgItem(b.orgTree,a.defaultItemConfig,b.maximumId,null,null,b.minimumLevel-1,null);u.hideParentConnection=!0;u.hideChildrenConnection=!0;u.title="internal root";u.isVisible=
!1;u.isActive=!1;u.childIndex=0;g={};c=0;for(d=k.length;c<d;c+=1){n=w[k[c]];j={};s=u;r=0;f=n.links.concat(n.backLinks);for(e=0;e<f.length;e+=1)h=f[e],i=b.orgTree.node(h.toItem),b.orgTree.node(h.fromItem),!0===g[i.familyId]&&(p=n.items[0],q=i,q.level>=p.level&&b.orgTree.loopParents(this,q.id,function(a,b){q=b;if(b.level<p.level)return!0}),j[q.id]=j.hasOwnProperty(q.id)?j[q.id]+1:1,r<j[q.id]&&(s=q,r=j[q.id]));this.attachFamilyToOrgChart(b,a.defaultItemConfig,s,n);g[n.id]=!0}c=this.getExtraGravity(b);
d=this.getGrandChildren(b);this.balanceOrgTree(b.orgTree,c,d)}};
primitives.famdiagram.FamilyBalance.prototype.getGrandChildren=function(a){var b={};a.orgTree.loopPostOrder(this,function(c,d,e){a.minimumLevel=null!=a.minimumLevel?Math.min(a.minimumLevel,d.level):d.level;a.maximumLevel=null!=a.maximumLevel?Math.max(a.maximumLevel,d.level):d.level;if(null!=e&&(b[e]||(b[e]={}),d=d.level-1,b[e][d]=b[e][d]?b[e][d]+1:1,null!=b[c]))for(d in b[c])b[c].hasOwnProperty(d)&&(b[e][d]=b[e][d]?b[e][d]+b[c][d]:b[c][d])});return b};
primitives.famdiagram.FamilyBalance.prototype.balanceOrgTree=function(a,b,c){var d,e,f,g,h,i,j,k,m,l,n;a.loopLevels(this,function(p,q){var s=primitives.common.graph(),r={},v=null,u;j=[];a.loopChildren(this,q.id,function(c,g,f){var k;null==v&&(v=g);r[g.id]={};if(b.hasOwnProperty(g.id))for(k in i=b[g.id],i)if(i.hasOwnProperty(k)){l=i[k];r[g.id][k]={};d=0;for(e=l.length;d<e;d+=1)h=l[d],u=h.commonParent==q.id?h.toParent:a.node(h.fromParent).childIndex<a.node(h.toParent).childIndex?"__right__":"__left__",
g.id!=u&&(s.addEdge(g.id,u,{weight:0}),s.edge(g.id,u).weight+=1,null==r[g.id][k][u]&&(r[g.id][k][u]=0),r[g.id][k][u]+=1)}0<f&&s.addEdge(g.id,v.id,{weight:0})});if(null!=v){n=[];s.getTotalWeightGrowthSequence(this,function(a){return a.weight},function(a){n.push(a)});0===n.length&&(n=[v.id]);k=this.balanceItems(n,"__left__","__right__",r,c);f=0;for(g=k.length;f<g;f+=1)m=a.node(k[f]),m.childIndex=f,j.push(m.id)}a.arrangeChildren(q.id,j)})};
primitives.famdiagram.FamilyBalance.prototype.balanceItems=function(a,b,c,d,e){var f=[],g,h,i,j,k,m,l,n,p,q,s,r,v,u,x,w,z,t,A,y;h=new primitives.famdiagram.Slots;h.add(new primitives.famdiagram.Slot(b));h.add(new primitives.famdiagram.Slot(null));h.add(new primitives.famdiagram.Slot(c));i=0;h.loop(function(a){i+=1;a.position=i});for(g=0;g<a.length;g+=1)if(j=a[g],j!=b&&j!=c)for(z in p=n=l=m=k=null,h.loop(function(a){var b,c,g,f;if(null==a.itemId){u=e[j];v=r=s=q=0;for(b in a.crossings)a.crossings.hasOwnProperty(b)&&
(u&&null!=u[b]&&(q+=a.crossings[b]*u[b]),v+=a.crossings[b]);for(b in d[j])if(d[j].hasOwnProperty(b))for(c in g=d[j][b],g)g.hasOwnProperty(c)&&(f=h.getSlot(c),null!=f&&(f.position<a.position?(q+=(a.left[b]||0)-(f.left[b]||0),r+=Math.abs(f.balance+1)):(q+=(a.right[b]||0)-(f.right[b]||0),r+=Math.abs(f.balance-1)),s+=Math.abs(f.position-a.position)));if(null==m||m>q||m==q&&(l>s||l==s&&(n>r||n==r&&p>v)))m=q,k=a,l=s,n=r,p=v}}),x=k.clone(),w=k.clone(),w.itemId=j,h.insertBefore(k,x),h.insertBefore(k,w),i=
w.position=0,h.loop(function(a){var b,d;if(a.id!=w.id){d=e[j];for(b in d)d.hasOwnProperty(b)&&(a.left[b]=a.left[b]?a.left[b]+d[b]:d[b]);i+=1;a.position=i}},w),i=0,h.backwardLoop(function(a){var b,d;if(a.id!=w.id){d=e[j];for(b in e[j])e[j].hasOwnProperty(b)&&(a.right[b]=a.right[b]?a.right[b]+d[b]:d[b]);i-=1;a.position=i}},w),d[j])if(d[j].hasOwnProperty(z))for(A in t=d[j][z],t)t.hasOwnProperty(A)&&(y=h.getSlot(A),null!=y&&(0>y.position?(y.balance+=1,w.balance-=1,h.backwardLoop(function(a){if(a.id!=
w.id)if(a.id!=y.id)a.crossings[z]=a.crossings[z]?a.crossings[z]+t[A]:t[A];else return!0},w)):(y.balance-=1,w.balance+=1,h.loop(function(a){if(a.id!=w.id)if(a.id!=y.id)a.crossings[z]=a.crossings[z]?a.crossings[z]+t[A]:t[A];else return!0},w))));h.loop(function(a){a=a.itemId;null!=a&&(a!=b&&a!=c)&&f.push(a)});return f};primitives.famdiagram.FamilyBalance.prototype.ExtraGravity=function(a){this.toParent=this.fromParent=this.commonParent=null;this.level=a};
primitives.famdiagram.FamilyBalance.prototype.getExtraGravity=function(a){var b,c,d={},e,f,g,h;for(b in a.orgPartners)if(a.orgPartners.hasOwnProperty(b)){c=a.orgTree.node(b);g=a.orgPartners[b];e=0;for(f=g.length;e<f;e+=1)h=a.orgTree.node(g[e]),this.addExtraGravitiesForConnection(a.orgTree,d,h,c)}return d};
primitives.famdiagram.FamilyBalance.prototype.addExtraGravitiesForConnection=function(a,b,c,d){var e=new this.ExtraGravity(c.level),f=new this.ExtraGravity(d.level);a.zipUp(this,c.id,d.id,function(a,d,c,j){this.addExtraGravityForItem(b,a,e);this.addExtraGravityForItem(b,c,f);if(d==j)return e.commonParent=d,e.fromParent=a,e.toParent=c,f.commonParent=d,f.fromParent=c,f.toParent=a,!0})};
primitives.famdiagram.FamilyBalance.prototype.addExtraGravityForItem=function(a,b,c){a.hasOwnProperty(b)||(a[b]={});null==a[b][c.level]&&(a[b][c.level]=[]);a[b][c.level].push(c)};
primitives.famdiagram.FamilyBalance.prototype.attachFamilyToOrgChart=function(a,b,c,d){for(var e=d.items[0],f=null,f=c,c=c.level+1;c<e.level;c+=1)a.maximumId+=1,f=this.createOrgItem(a.orgTree,b,a.maximumId,f.id,null,c,null),f.title="shift",f.isVisible=!1,f.isActive=!1,f.hideParentConnection=!0,f.hideChildrenConnection=!0,d.items.push(f);e.hideParentConnection=!0;a.orgTree.adopt(f.id,e.id,e)};
primitives.famdiagram.FamilyBalance.prototype.extractOrgChart=function(a,b,c,d,e,f,g,h){var i,j=[],k,m,a=b.node(a),j=this.createOrgItem(d,c,a.id,null,h.id,a.level,a.itemConfig);j.hideParentConnection=!0;j.isVisible=a.isVisible;j.isActive=a.isActive;j.hideParentConnection=a.hideParentConnection;j.hideChildrenConnection=a.hideChildrenConnection;h.items.push(j);g[a.id]=!0;a.familyId=h.id;for(j=this.extractChildren(a,b,c,d,e,f,g,h);0<j.length;){k=[];a=0;for(i=j.length;a<i;a+=1)m=j[a],k=k.concat(this.extractChildren(m,
b,c,d,e,f,g,h));j=k}};
primitives.famdiagram.FamilyBalance.prototype.extractChildren=function(a,b,c,d,e,f,g,h){var i=[],j=null,k=null,m;1==b.countChildren(a.id)&&(j=b.firstChild(a.id));null!=f[j]?(k=f[j],null==e[k.id]&&(e[k.id]=[]),e[k.id].push(a.id),h.links.push(new this.FamLink(a.id,j))):(null!=j&&(f[j]=a),b.loopChildren(this,a.id,function(e,f){if(g[f.id])throw"Many to many relations should not exist at this stage";i.push(f);m=this.createOrgItem(d,c,f.id,a.id,h.id,f.level,f.itemConfig);m.hideParentConnection=f.hideParentConnection;
m.hideChildrenConnection=f.hideChildrenConnection;m.isVisible=f.isVisible;m.isActive=f.isActive;h.items.push(m);g[f.id]=!0;f.familyId=h.id;return b.SKIP}));return i};primitives.famdiagram.FamilyBalance.prototype.createOrgItem=function(a,b,c,d,e,f,g){var h=new primitives.orgdiagram.OrgItem({});h.id=c;h.familyId=e;h.level=f;c=0;for(e=this.properties.length;c<e;c+=1)f=this.properties[c],h[f]=null!=g&&void 0!==g[f]?g[f]:b[f];a.add(d,h.id,h);return h};
primitives.famdiagram.FamilyBalance.prototype.recalcLevelsDepth=function(a,b,c,d,e){var f,g,h,i,j,k,m,l,n,p={},q,s,r;c.loopLevels(this,function(v){var u=new primitives.orgdiagram.TreeLevelConnectorStackSize;b[v]=u;n=[];c.loopLevelItems(this,v,function(b,c){var h=[],k=[],j;if(!p.hasOwnProperty(b)){p[b]=!0;c.hideChildrenConnection||h.push(b);j=e[b];if(null!=j){f=0;for(g=j.length;f<g;f+=1){var m=j[f];p[m]=!0;h.push(m)}}d.loopChildren(this,b,function(a,b){b.hideParentConnection||k.push(a)});if(1<h.length||
0<k.length)l=new primitives.common.VerticalConnectorBundle(h,k),a.push(l),1<h.length&&n.push(l)}});if(0<n.length){r=primitives.common.pile();h=0;for(i=n.length;h<i;h+=1){l=n[h];s=q=null;j=0;for(k=l.fromItems.length;j<k;j+=1)m=c.getItemPosition(l.fromItems[j]),q=null!=q?Math.min(q,m):m,s=null!=s?Math.max(s,m):m;r.add(q,s,l)}u.parentsStackSize=r.resolve(this,function(a,b,d,c,e){d.fromOffset=c+1;d.fromStackSize=e})}})};
primitives.famdiagram.FamilyMatrixesExtractor=function(a){this.parent=primitives.famdiagram.BaseTransformer.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.FamilyMatrixesExtractor.prototype=new primitives.famdiagram.BaseTransformer;
primitives.famdiagram.FamilyMatrixesExtractor.prototype.extract=function(a,b,c,d,e,f){0<b.hasNodes()&&a.enableMatrixLayout&&b.groupBy(this,Math.max(2,a.minimumMatrixSize),function(g,h,i,j){var k=f+=1,m=f+=1,l=b.node(i[0]),l=new primitives.famdiagram.FamilyItem({id:k,level:l.level,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+k,description:"This is item used as aggregator of matrixed nodes."},levelGravity:1,hideParentConnection:!0,hideChildrenConnection:!0});d[k]=m;for(var n=0,p=i.length;n<
p;n+=1)b.removeNode(i[n]);null!=g?(b.add([g],k,l),l.hideParentConnection=!1,e.push(new primitives.common.MatrixConnectorBundle(!0,i,k,k,this.getMatrixWidth(a.maximumColumnsInMatrix,i.length)))):b.add(null,k,l);null!=h&&(b.adopt([k],h),l.hideChildrenConnection=!1,e.push(new primitives.common.MatrixConnectorBundle(!1,i,k,m,this.getMatrixWidth(a.maximumColumnsInMatrix,i.length))));c[k]=j});return f};
primitives.famdiagram.FamilyMatrixesExtractor.prototype.getMatrixWidth=function(a,b){return Math.min(a,Math.ceil(Math.sqrt(b)))};primitives.famdiagram.FamilyNormalizer=function(a){this.parent=primitives.famdiagram.BaseTransformer.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.FamilyNormalizer.prototype=new primitives.famdiagram.BaseTransformer;
primitives.famdiagram.FamilyNormalizer.prototype.normalize=function(a,b,c){if(0<b.hasNodes()){b.loopLevels(this,1==a.groupByType,function(a,b,c){b.level=c});b.optimizeReferences(function(){c+=1;return new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!1,itemConfig:{title:"bundle #"+c,description:" This item was created by references optimizer."},levelGravity:2})});if(this.debug&&!b.validate())throw"References are broken in family structure!";if(this.debug&&b.hasLoops())throw"Structure has loops!";
b.eliminateManyToMany(function(){c+=1;return new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+c,description:"This is item used to eliminate M:M relations."},levelGravity:2,hideParentConnection:!1,hideChildrenConnection:!1})});if(this.debug&&!b.validate())throw"References are broken in family structure!";a.alignBylevels?this.resortItemsBylevels(b):b.loopLevels(this,1==a.groupByType,function(a,b,c){b.level=c});this.debug&&this.validate(b,!1);this.fillInItems(b,
function(){c+=1;return new primitives.famdiagram.FamilyItem({id:c,levelGravity:2,isVisible:!1,isActive:!1,itemConfig:{title:"extension #"+c,description:"This is item used to fill gaps in levels."}})});this.debug&&this.validate(b,!0)}return c};
primitives.famdiagram.FamilyNormalizer.prototype.resortItemsBylevels=function(a){var b=[],c=null,d=null,e,f;a.loop(this,function(a,e){e.originalLevel=e.level;e.level=null;null!=e.originalLevel&&(b[e.originalLevel]||(b[e.originalLevel]={}),b[e.originalLevel][a]=e,c=null!=c?Math.min(e.originalLevel,c):e.originalLevel,d=null!=d?Math.max(e.originalLevel,d):e.originalLevel)});for(e=c;e<=d;e+=1)f=b[e],this.setLevelsForItems(f,a);a.loopTopo(this,function(b,d){var c;1==d.levelGravity&&(c=null,a.loopParents(this,
b,function(b,d){c=null==c?d.level+1:Math.max(d.level+1,c);return a.SKIP}),d.level=!c?d.level:c)})};
primitives.famdiagram.FamilyNormalizer.prototype.setLevelsForItems=function(a,b){var c=0,d,e,f;for(d in a)a.hasOwnProperty(d)&&b.loopParents(this,d,function(a,d){c=Math.max(d.level+1,c);return b.SKIP});for(d in a)a.hasOwnProperty(d)&&(e=a[d],e.level=c);for(;!primitives.common.isEmptyObject(a);){f={};for(d in a)a.hasOwnProperty(d)&&(e=a[d],b.loopChildren(this,d,function(a,d){if(null==d.originalLevel||d.isLevelNeutral)d.level=null==d.level?e.level+1:Math.max(d.level,e.level+1),f[a]=d;return b.SKIP}));
a=f}};
primitives.famdiagram.FamilyNormalizer.prototype.fillInItems=function(a,b){var c;a.loop(this,function(d,e){for(var f=!0,g;f;)f=!1,g=[],a.loopParents(this,d,function(b,d){e.level-1>d.level&&g.push(b);return a.SKIP}),1<g.length&&(c=b(e),c.level=e.level-1,c.hideParentConnection=!1,c.hideChildrenConnection=!1,a.bundleParents(d,g,c.id,c),f=!0,d=c.id,e=c)});a.loop(this,function(d,e){for(var f=!0,g,h=!0;f;)f=!1,g=[],a.loopChildren(this,d,function(b,d){e.level+1<d.level?g.push(b):h=!1;return a.SKIP}),1<g.length&&
(c=b(e),c.level=e.level+1,h&&(c.hideParentConnection=!1,c.hideChildrenConnection=!1),a.bundleChildren(d,g,c.id,c),f=!0,d=c.id,e=c)});a.loop(this,function(d,e){for(var f=!0,g;f;)f=!1,g=[],a.loopParents(this,d,function(b,d){e.level-1>d.level&&g.push(b);return a.SKIP}),0<g.length&&(c=b(e),c.level=e.level-1,c.hideParentConnection=!1,c.hideChildrenConnection=!1,a.bundleParents(d,g,c.id,c),f=!0,d=c.id,e=c)})};
primitives.common.BaseLayout=function(a,b){this._children={};if(null!=this.params)for(var c in this.params)this.params.hasOwnProperty(c)&&a.hasOwnProperty(c)&&(this.params[c]=a[c]);if(null!=this.options){for(c in this.options)this.options.hasOwnProperty(c)&&b.hasOwnProperty(c)&&(this.options[c]=b[c]);this.options.shifts=this.getShifts(this.options);this.options.intervals=this.getIntervals(this.options)}};primitives.common.BaseLayout.prototype.add=function(a,b){this._children[a]=b};
primitives.common.BaseLayout.prototype.getLayout=function(a){return this._children[a]||null};primitives.common.BaseLayout.prototype.getShifts=function(a){var b=[];b[1]=a.normalLevelShift;b[2]=a.dotLevelShift;b[3]=a.lineLevelShift;b[4]=a.lineLevelShift;return b};primitives.common.BaseLayout.prototype.getIntervals=function(a){var b=[];b[1]=a.normalItemsInterval;b[2]=a.dotItemsInterval;b[3]=a.lineItemsInterval;b[4]=a.lineItemsInterval;return b};
primitives.common.BaseLayout.prototype.getItemSize=function(a,b,c,d){var e,f;switch(a){case 1:a=c.template.templateConfig;e=new primitives.common.Size(a.itemSize);f=new primitives.common.Rect(0,0,e.width,e.height);b&&(e.height+=a.cursorPadding.top+a.cursorPadding.bottom,e.width+=a.cursorPadding.left+a.cursorPadding.right,f.x=a.cursorPadding.left,f.y=a.cursorPadding.top);c.hasSelectorCheckbox&&(e.height+=d.checkBoxPanelSize);if(c.hasButtons)switch(e.width+=d.buttonsPanelSize,d.groupTitlePlacementType){case 3:f.x+=
d.buttonsPanelSize}if(c.hasGroupTitle)switch(e.width+=d.groupTitlePanelSize,d.groupTitlePlacementType){case 3:break;default:f.x+=d.groupTitlePanelSize}break;case 2:a=c.template.templateConfig;e=new primitives.common.Size(a.minimizedItemSize);break;case 3:case 4:e=new primitives.common.Size}switch(d.orientationType){case 2:case 3:e.invert()}return{actualSize:e,contentPosition:f}};
primitives.famdiagram.FamilyLayout=function(a,b){this.params={logicalFamily:null,treeLevels:null,getConnectorsStacksSizes:null,isItemSelected:null,cursorItemId:null,getTemplateParams:null};this.options={verticalAlignment:1,pageFitMode:0,minimalVisibility:2,orientationType:0,arrowsDirection:0,linesWidth:1,checkBoxPanelSize:24,buttonsPanelSize:28,groupTitlePanelSize:24,groupTitlePlacementType:2,normalLevelShift:20,dotLevelShift:20,lineLevelShift:20,normalItemsInterval:10,dotItemsInterval:1,lineItemsInterval:2};
this.data={treeItemsPositions:{},treeLevelsPositions:[]};this.parent=primitives.common.BaseLayout.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.FamilyLayout.prototype=new primitives.common.BaseLayout;
primitives.famdiagram.FamilyLayout.prototype.measure=function(a){var b=new primitives.common.Rect(0,0,0,0),c,d,e={treeItemsPositions:{},treeLevelsPositions:[]};switch(this.options.orientationType){case 2:case 3:a.invert()}if(!this.params.treeLevels.isEmpty())switch(this.options.pageFitMode){case 0:case primitives.common.PageFitMode.PrintPreview:case 5:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=this.setTreeLevelsVisibilityAndPositionTreeItems(e,this.params,this.options,c,0);break;default:c=
this.getLevelVisibilities(this.params.treeLevels,this.options.minimalVisibility),d=this.setTreeLevelsVisibilityAndPositionTreeItems(e,this.params,this.options,c,c.length-1),this.checkDiagramSize(d,a,this.options.pageFitMode)?(d.addRect(a),d.offset(0,0,5,5),this.findOptimalSize(this,c.length-1,function(a){b=this.setTreeLevelsVisibilityAndPositionTreeItems(e,this.params,this.options,c,a);return this.checkDiagramSize(b,d,this.options.pageFitMode)})):b=d}this.data=e;return b};
primitives.famdiagram.FamilyLayout.prototype.getLevelVisibilities=function(a,b){var c=[new primitives.orgdiagram.LevelVisibility(0,1)],d=[];switch(b){case 2:d.push(2);break;case 0:case 3:case 4:d.push(2),d.push(3)}a.loopLevelsReversed(this,function(a){for(var b=0;b<d.length;b+=1)c.push(new primitives.orgdiagram.LevelVisibility(a,d[b]))});return c};
primitives.famdiagram.FamilyLayout.prototype.findOptimalSize=function(a,b,c){var d=0,e;if(!c.call(a,d)){for(e=b;1<b-d;)e=Math.floor((b+d)/2),c.call(a,e)?b=e:d=e;b!==e&&c.call(a,b)}};
primitives.famdiagram.FamilyLayout.prototype.setTreeLevelsVisibilityAndPositionTreeItems=function(a,b,c,d,e){var f,g;a.treeLevelsPositions=[];b.treeLevels.loopLevels(this,function(){var b=new primitives.orgdiagram.TreeLevelPosition;b.currentvisibility=1;a.treeLevelsPositions.push(b)});for(f=0;f<=e;f+=1)g=d[f],a.treeLevelsPositions[g.level].currentvisibility=g.currentvisibility;a.treeItemsPositions={};this.recalcItemsSize(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions,b.isItemSelected,b.cursorItemId,
b.getTemplateParams,c);this.setOffsets(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions,b.logicalFamily,c.intervals);this.recalcLevelsDepth(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions,c.verticalAlignment);this.shiftLevels(a.treeLevelsPositions,c.shifts[3],c.shifts,c.arrowsDirection,c.linesWidth,b.getConnectorsStacksSizes);return this.getLayoutSize(b.treeLevels,a.treeItemsPositions,a.treeLevelsPositions)};
primitives.famdiagram.FamilyLayout.prototype.checkDiagramSize=function(a,b,c){var d=!1;switch(c){case 1:b.width>=a.width&&(d=!0);break;case 2:b.height>=a.height&&(d=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(d=!0)}return d};primitives.famdiagram.FamilyLayout.prototype.getLayoutSize=function(a,b,c){return new primitives.common.Rect(0,0,Math.round(this.getLayoutWidth(a,b)),Math.round(this.getLayoutHeight(c)))};
primitives.famdiagram.FamilyLayout.prototype.getLayoutWidth=function(a,b){var c=0;a.loopLevels(this,function(d){var e=a.getLevelLength(d);0<e&&(d=a.getItemAtPosition(d,e-1),d=b[d],c=Math.max(c,d.offset+d.actualSize.width+d.rightPadding))});return c};primitives.famdiagram.FamilyLayout.prototype.getLayoutHeight=function(a){a=a[a.length-1];return a.shift+a.nextLevelShift};
primitives.famdiagram.FamilyLayout.prototype.recalcItemsSize=function(a,b,c,d,e,f,g){a.loopLevels(this,function(h){var i=c[h];a.loopLevelItems(this,h,function(a,c){var h=new primitives.orgdiagram.TreeItemPosition,l=this.getLayout(a);if(null==l){var n=d(a)?1:!c.isVisible?4:0,l=f(a),n=0===n?i.currentvisibility:n,l=this.getItemSize(n,e==a,l,g);h.actualVisibility=n;h.actualSize=l.actualSize;h.contentPosition=l.contentPosition}else l=l.measure(i.currentvisibility),h.actualVisibility=4,h.actualSize=l;b[a]=
h})})};
primitives.famdiagram.FamilyLayout.prototype.recalcLevelsDepth=function(a,b,c,d){var e,f;a.loopLevels(this,function(g){var h=c[g];h.shift=0;h.depth=0;h.actualVisibility=4;f=e=null;a.loopLevelItems(this,g,function(a){a=b[a];h.depth=Math.max(h.depth,a.actualSize.height);switch(a.actualVisibility){case 2:case 3:case 4:f=!f?a.actualSize.height:Math.min(f,a.actualSize.height);break;default:e=!e?a.actualSize.height:Math.min(e,a.actualSize.height)}h.actualVisibility=Math.min(h.actualVisibility,a.actualVisibility)});null==
e&&(e=h.depth);null!=f&&f>e&&(e=f);switch(d){case 0:h.horizontalConnectorsDepth=e/2;break;case 1:h.horizontalConnectorsDepth=h.depth/2;break;case 2:h.horizontalConnectorsDepth=h.depth-e/2}})};primitives.famdiagram.FamilyLayout.prototype.shiftLevels=function(a,b,c,d,e,f){var g,h,i=0,j=0,e=8*e;switch(d){case 1:i=e;j=0;break;case 2:i=0,j=e}d=0;for(e=a.length;d<e;d+=1)g=a[d],h=f(d),b+=g.setShift(b,c[g.actualVisibility],j,i,h.parentsStackSize)};
primitives.famdiagram.FamilyLayout.prototype.setOffsets=function(a,b,c,d,e){var f,g;f=0;for(g=c.length;f<g;f+=1)c[f].currentOffset=0;var c=d.getPlanarFamily(a),h=new primitives.common.FamilyAlignment(this,c,a,function(a){var a=b[a],d=e[a.actualVisibility]/2;a.leftPadding=d;a.rightPadding=d;return a.leftPadding+a.actualSize.width+a.rightPadding}),i=null;a.loopLevels(this,function(d){d=a.getItemAtPosition(d,0);if(null!=d){var c=b[d],d=h.getOffset(d)-c.leftPadding-c.actualSize.width/2;i=null==i?d:Math.min(i,
d)}});a.loopLevels(this,function(d){a.loopLevelItems(this,d,function(a){var d=b[a],a=h.getOffset(a);d.offset=a-d.actualSize.width/2;d.offset-=i})})};
primitives.famdiagram.FamilyLayout.prototype.arrange=function(a,b){var c=null;null!=b&&this.params.treeLevels.loopLevels(this,function(d){var e=this.data.treeLevelsPositions[d];this.params.treeLevels.loopLevelItems(this,d,function(d){var g=this.data.treeItemsPositions[d],h=this.getItemPosition(g.actualVisibility,g.offset,g.actualSize,c,e,this.options.verticalAlignment);g.actualPosition=h.position;g.horizontalConnectorsShift=h.horizontalConnectorsShift;g.topConnectorShift=h.topConnectorShift;g.topConnectorInterval=
h.topConnectorInterval;g.bottomConnectorShift=h.bottomConnectorShift;g.bottomConnectorInterval=h.bottomConnectorInterval;b.call(a,d,g);d=this.getLayout(d);null!=d&&d.arrange(a,h.position,b)});c=e})};
primitives.famdiagram.FamilyLayout.prototype.getItemPosition=function(a,b,c,d,e,f){var g=0;switch(a){case 1:switch(f){case 0:g=0;break;case 1:g=(e.depth-c.height)/2;break;case 2:g=e.depth-c.height}break;case 2:case 3:case 4:g=e.horizontalConnectorsDepth-c.height/2}return{position:new primitives.common.Rect(b,e.shift+g,c.width,c.height),horizontalConnectorsShift:e.shift+e.horizontalConnectorsDepth,topConnectorShift:null!=d?d.shift+d.connectorShift:null,topConnectorInterval:null!=d?d.levelSpace/2:null,
bottomConnectorShift:e.shift+e.connectorShift,bottomConnectorInterval:e.levelSpace/2}};
primitives.famdiagram.MatrixLayout=function(a,b){this.params={items:[],isItemSelected:null,cursorItemId:null,getTemplateParams:null,hideParentConnection:!1,hideChildrenConnection:!1};this.options={verticalAlignment:1,orientationType:0,arrowsDirection:0,linesWidth:1,checkBoxPanelSize:24,buttonsPanelSize:28,groupTitlePanelSize:24,groupTitlePlacementType:2,normalLevelShift:20,dotLevelShift:20,lineLevelShift:20,normalItemsInterval:10,dotItemsInterval:1,lineItemsInterval:2,maximumColumnsInMatrix:6};this.data=
{treeItemsPositions:{},columns:[],rows:[]};this.parent=primitives.common.BaseLayout.prototype;this.parent.constructor.apply(this,arguments)};primitives.famdiagram.MatrixLayout.prototype=new primitives.common.BaseLayout;primitives.famdiagram.MatrixLayout.prototype.Column=function(){this.rightPadding=this.leftPadding=this.offset=this.depth=0};primitives.famdiagram.MatrixLayout.prototype.Row=function(){this.horizontalConnectorsDepth=this.offset=this.depth=0;this.dotsDepth=this.minimalDepth=null};
primitives.famdiagram.MatrixLayout.prototype.getMatrixWidth=function(a,b){return Math.min(a,Math.ceil(Math.sqrt(b)))};primitives.famdiagram.MatrixLayout.prototype.measure=function(a){var b={treeItemsPositions:{},columns:[],rows:[]};this.measureItems(b,this.params,this.options,a);this.measureColumns(b,this.params,this.options);this.measureRows(b,this.params,this.options);this.data=b;return this.getLayoutSize(b)};
primitives.famdiagram.MatrixLayout.prototype.measureItems=function(a,b,c,d){for(var e=0,f=b.items.length;e<f;e+=1){var g=b.items[e],h=g.id,i=new primitives.orgdiagram.TreeItemPosition,j=b.isItemSelected(h)?1:!g.isVisible?4:0,g=b.getTemplateParams(h),j=0===j?d:j,g=this.getItemSize(j,b.cursorItemId==h,g,c);i.actualVisibility=j;i.actualSize=g.actualSize;i.contentPosition=g.contentPosition;a.treeItemsPositions[h]=i}};
primitives.famdiagram.MatrixLayout.prototype.measureColumns=function(a,b,c){var d,e,f,g=this.getMatrixWidth(c.maximumColumnsInMatrix,b.items.length);e=0;for(f=b.items.length;e<f;e+=1){var h=a.treeItemsPositions[b.items[e].id];d=c.intervals[h.actualVisibility]/2;h.leftPadding=d;h.rightPadding=d;var i=e%g;d=a.columns[i];null==d&&(d=new this.Column,a.columns[i]=d);d.depth=Math.max(d.depth,h.leftPadding+h.actualSize.width+h.rightPadding)}g=8*c.linesWidth;e=h=0;for(f=a.columns.length;e<f;e+=1){d=a.columns[e];
if(0==e%2)switch(c.arrowsDirection){case 1:d.leftPadding=b.hideChildrenConnection?0:g;d.rightPadding=0;break;case 2:d.leftPadding=0,d.rightPadding=b.hideParentConnection?0:g}else switch(c.arrowsDirection){case 1:d.leftPadding=0;d.rightPadding=b.hideChildrenConnection?0:g;break;case 2:d.leftPadding=b.hideParentConnection?0:g,d.rightPadding=0}d.offset=h+d.leftPadding+d.depth/2;h=d.offset+d.depth/2+d.rightPadding}};
primitives.famdiagram.MatrixLayout.prototype.measureRows=function(a,b,c){var d,e,f,g=this.getMatrixWidth(c.maximumColumnsInMatrix,b.items.length);d=0;for(e=b.items.length;d<e;d+=1){var h=a.treeItemsPositions[b.items[d].id],i=Math.floor(d/g),j=c.shifts[h.actualVisibility]/2;f=a.rows[i];null==f&&(f=new this.Row,a.rows[i]=f);f.depth=Math.max(f.depth,j+h.actualSize.height+j);switch(h.actualVisibility){case 2:case 3:case 4:f.dotsDepth=!f.dotsDepth?h.actualSize.height:Math.min(f.dotsDepth,h.actualSize.height);
break;default:f.minimalDepth=!f.minimalDepth?h.actualSize.height:Math.min(f.minimalDepth,h.actualSize.height)}}d=b=0;for(e=a.rows.length;d<e;d+=1)switch(f=a.rows[d],f.offset=b+f.depth/2,b=f.offset+f.depth/2,null==f.minimalDepth&&(f.minimalDepth=f.depth),null!=f.dotsDepth&&f.dotsDepth>f.minimalDepth&&(f.minimalDepth=f.dotsDepth),c.verticalAlignment){case 0:f.horizontalConnectorsDepth=f.minimalDepth/2;break;case 1:f.horizontalConnectorsDepth=f.depth/2;break;case 2:f.horizontalConnectorsDepth=f.depth-
f.minimalDepth/2}};primitives.famdiagram.MatrixLayout.prototype.getLayoutSize=function(a){return new primitives.common.Rect(0,0,Math.round(this.getLayoutWidth(a)),Math.round(this.getLayoutHeight(a)))};primitives.famdiagram.MatrixLayout.prototype.getLayoutWidth=function(a){var b=0,c=a.columns.length;0<c&&(a=a.columns[c-1],b=a.offset+a.depth/2+a.rightPadding);return b};
primitives.famdiagram.MatrixLayout.prototype.getLayoutHeight=function(a){var b=0,c=a.rows.length;0<c&&(a=a.rows[c-1],b=a.offset+a.depth/2);return b};
primitives.famdiagram.MatrixLayout.prototype.arrange=function(a,b,c){if(null!=c)for(var d=this.getMatrixWidth(this.options.maximumColumnsInMatrix,this.params.items.length),e=0,f=this.params.items.length;e<f;e+=1){var g=this.params.items[e].id,h=this.data.columns[e%d],i=this.data.rows[Math.floor(e/d)],j=this.data.treeItemsPositions[g],k=this.getItemPosition(j.actualVisibility,h,i,j.actualSize,this.options);k.translate(b.x,b.y);j.actualPosition=k;j.horizontalConnectorsShift=b.y+i.offset-i.depth/2+i.horizontalConnectorsDepth;
j.leftMedianOffset=h.depth/2+h.leftPadding;j.rightMedianOffset=h.depth/2+h.rightPadding;j.topConnectorShift=i.depth/2;j.bottomConnectorShift=i.depth/2;c.call(a,g,j)}};
primitives.famdiagram.MatrixLayout.prototype.getItemPosition=function(a,b,c,d,e){var f=0;switch(a){case 1:switch(e.verticalAlignment){case 0:f=0;break;case 1:f=(c.depth-d.height)/2;break;case 2:f=c.depth-d.height}break;case 2:case 3:case 4:f=c.horizontalConnectorsDepth-d.height/2}return new primitives.common.Rect(b.offset-d.width/2,c.offset-c.depth/2+f,d.width,d.height)};
primitives.famdiagram.CursorNeighboursTask=function(a,b,c,d){function e(a,b,d,c){var e=[],g={};if(null!==a)switch(b){case 0:d.loopParents(this,a,function(a){g.hasOwnProperty(a)||(g[a]=!0,e.push(a));if(c.hasOwnProperty(a))return d.SKIP});d.loopChildren(this,a,function(a){g.hasOwnProperty(a)||(g[a]=!0,e.push(a));if(c.hasOwnProperty(a))return d.SKIP});break;case 1:d.loopNeighbours(this,a,function(a){g.hasOwnProperty(a)||(g[a]=!0,e.push(a));if(c.hasOwnProperty(a))return!0})}return e}var f=[],g={},h=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string",
"number"],!0),!0);return{process:function(){var i={isChanged:!1,hash:g},j=a.getCursorTreeItem(),k=c.getNavigationFamily(),m=b.getNeighboursSelectionMode(),l=d.getActiveItems();f=h.read(f,e(j,m,k,l),"items",i);return i.isChanged},getItems:function(){return f}}};
primitives.famdiagram.AddLabelAnnotationsTask=function(a,b){function c(a,b){var d=primitives.common.graph(),c={},e,k,m,l;if(0<b.length){l=0;for(e=b.length;l<e;l+=1)k=b[l],c.hasOwnProperty(k.fromItem)?c[k.fromItem].push(k):(c[k.fromItem]=[k],a.loopChildren(this,k.fromItem,function(b){d.addEdge(k.fromItem,b,new primitives.famdiagram.EdgeItem(k.fromItem,k.fromItem,b,b));return a.SKIP}),a.loopParents(this,k.fromItem,function(b){d.addEdge(b,k.fromItem,new primitives.famdiagram.EdgeItem(b,b,k.fromItem,
k.fromItem));return a.SKIP}));for(m in c)if(c.hasOwnProperty(m)){e=c[m];e.sort(function(a,b){return b.toItems.length-a.toItems.length});for(l=0;l<e.length;l+=1){k=e[l];for(var n=a,p=d,q=k.fromItem,s=k.toItems,r=void 0,v=!0,u=null,x=void 0,w=void 0,z=void 0,t=void 0,A=[],w=0,z=s.length;w<z;w+=1)if(x=s[w],r=p.edge(q,x),null!=r){if(null==u)u=r.getFar(x);else if(u!=r.getFar(x)){v=!1;break}A.push(r.getNear(x))}else{v=!1;break}if(v&&(t=new primitives.famdiagram.FamilyItem({id:k.id,isVisible:!0,isLevelNeutral:!0,
isActive:!1,itemConfig:k}),n.bundleParents(u,A,t.id,t)?(t.levelGravity=2,v=!0):n.bundleChildren(u,A,t.id,t)?(t.levelGravity=1,v=!0):n.bundleParents(u,s,t.id,t)?(t.levelGravity=2,v=!0):n.bundleParents(u,s,t.id,t)&&(t.levelGravity=1,v=!0),v)){w=0;for(z=s.length;w<z;w+=1)x=s[w],r=p.edge(q,x),r.setFar(x,t.id)}}}}}var d=null,e=null;return{process:function(f){var g=b.getLogicalFamily(),h=a.getAnnotations(),g=g.clone();c(g,h);d=g;e=a.getMaximumId();if(f&&!g.validate())throw"References are broken in family structure!";
return!0},getNavigationFamily:function(){return d},getMaximumId:function(){return e}}};
primitives.famdiagram.AddSpousesTask=function(a,b){var c=null,d=null;return{process:function(e){var f=b.getLogicalFamily(),g=b.getMaximumId(),h=a.getItems(),i=f=f.clone(),j,k,m,l,n,p,q,s;m=0;for(l=h.length;m<l;m+=1){n=h[m];s=n.spouses.slice(0);p=0;for(q=s.length;p<q;p+=1)j=[n.id,s[p]],i.hasCommonChild(j)||(g+=1,k=new primitives.famdiagram.FamilyItem({id:g,isVisible:!1,isActive:!1,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+g,description:"This is fake child keeps spouses together."},
levelGravity:1}),i.add(j,k.id,k))}c=f;d=g;if(e&&!f.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return c},getMaximumId:function(){return d}}};
primitives.famdiagram.ItemsPositionsTask=function(a,b,c,d,e,f,g,h,i,j){var k={},m=null;return{process:function(){var l=d.getOptions(),n=e.getOptions(),p=f.getOptions(),q={logicalFamily:g.getLogicalFamily(),treeLevels:g.getTreeLevels(),getConnectorsStacksSizes:g.getConnectorsStacksSizes,isItemSelected:j.isItemSelected,cursorItemId:i.getCursorTreeItem(),getTemplateParams:h.getTemplateParams},l={verticalAlignment:l.verticalAlignment,pageFitMode:l.pageFitMode,minimalVisibility:l.minimalVisibility,normalLevelShift:l.normalLevelShift,
dotLevelShift:l.dotLevelShift,lineLevelShift:l.lineLevelShift,normalItemsInterval:l.normalItemsInterval,dotItemsInterval:l.dotItemsInterval,lineItemsInterval:l.lineItemsInterval,orientationType:c.getOptions().orientationType,arrowsDirection:n.arrowsDirection,linesWidth:n.linesWidth,checkBoxPanelSize:l.checkBoxPanelSize,buttonsPanelSize:l.buttonsPanelSize,groupTitlePanelSize:l.groupTitlePanelSize,groupTitlePlacementType:l.groupTitlePlacementType,maximumColumnsInMatrix:p.maximumColumnsInMatrix},n=a.getOptimalPanelSize(),
p=b.getOptions().scale;n.scale(1/p);var n=new primitives.common.Rect(0,0,n.width,n.height),p=new primitives.famdiagram.FamilyLayout(q,l),s=g.getMatrixes(),r;for(r in s)if(s.hasOwnProperty(r)){var v=q.logicalFamily.node(r);p.add(r,new primitives.famdiagram.MatrixLayout({items:s[r],isItemSelected:q.isItemSelected,cursorItemId:q.cursorItemId,getTemplateParams:q.getTemplateParams,hideParentConnection:v.hideParentConnection,hideChildrenConnection:v.hideChildrenConnection},l))}m=p.measure(n);k={};p.arrange(this,
function(a,b){k[a]=b});return!0},getItemsPositions:function(){return k},getItemPosition:function(a){return k[a]},getContentSize:function(){return m}}};
primitives.famdiagram.LevelsTask=function(a,b){var c={maximumId:null,treeLevels:null,bundles:null,connectorStacks:null},d=new primitives.famdiagram.FamilyBalance,e=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var e={logicalFamily:a.getLogicalFamily(),maximumId:a.getMaximumId(),defaultItemConfig:b};c=d.balance(e);return!0},getMaximumId:function(){return c.maximumId},getTreeLevels:function(){return c.treeLevels},getBundles:function(){return c.bundles},getConnectorsStacksSizes:function(a){return c.connectorStacks[a]||
e}}};
primitives.famdiagram.LogicalFamilyTask=function(a){var b=null,c=null;return{process:function(d){var e,f,g,h,i=a.getItems(),j=primitives.common.family(),k=0;if(0<i.length){e=0;for(f=i.length;e<f;e+=1)g=i[e],null!=g&&(h=new primitives.famdiagram.FamilyItem({id:g.id,itemConfig:g,isActive:g.isActive}),j.add(g.parents,h.id,h),g=parseInt(g.id,10),k=Math.max(isNaN(g)?0:g,k))}b=j;c=k;if(d&&!j.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return b},getMaximumId:function(){return c}}};
primitives.famdiagram.NormalizeLogicalFamilyTask=function(a,b,c){var d=null,e=null,f={},g={},h=null,i=null,j=null,k=new primitives.famdiagram.FamilyBalance,m=new primitives.famdiagram.FamilyNormalizer(!1),l=new primitives.famdiagram.FamilyMatrixesExtractor(!1),n=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var n=b.getLogicalFamily(),q=b.getMaximumId(),s={},r={},v=[],u=a.getOptions(),u={hideGrandParentsConnectors:u.hideGrandParentsConnectors,groupByType:u.groupByType,
alignBylevels:u.alignBylevels,enableMatrixLayout:u.enableMatrixLayout,minimumMatrixSize:u.minimumMatrixSize,maximumColumnsInMatrix:u.maximumColumnsInMatrix},n=!0==u.hideGrandParentsConnectors?n.getFamilyWithoutGrandParentsRelations():n.clone(),q=m.normalize(u,n,q),q=l.extract(u,n,s,r,v,q);e=n;f=s;g=r;i=v;n=k.balance({logicalFamily:n,maximumId:q,defaultItemConfig:c});d=n.maximumId;h=n.treeLevels;i=i.concat(n.bundles);j=n.connectorStacks;return!0},getLogicalFamily:function(){return e},getMatrixes:function(){return f},
getNestedLayoutBottomConnectorIds:function(){return g},getMaximumId:function(){return d},getTreeLevels:function(){return h},getBundles:function(){return i},getConnectorsStacksSizes:function(a){return j[a]||n}}};
primitives.famdiagram.RemoveLoopsTask=function(a,b){function c(a,b,d){var c,e,k,m,l,n,p,q,s;c=b.clone();b.loopTopo(this,function(a){c.removeNode(a)});if(c.hasNodes()){m=0;for(l=a.length;m<l;m+=1)if(e=a[m],null!=c.node(e.id)){s=[];c.loopParents(this,e.id,function(a){s.push(a);return c.SKIP});n=0;for(p=s.length;n<p;n+=1)c.removeRelation(s[n],e.id),b.removeRelation(s[n],e.id);d+=1;k=new primitives.famdiagram.FamilyItem({id:d,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,
itemConfig:{title:"fake parent #"+d,description:"This is fake parent item was created by loops reversal."}});b.add([],k.id,k);b.adopt([k.id],e.id);n=0;for(p=s.length;n<p;n+=1)d+=1,e=new primitives.famdiagram.FamilyItem({id:d,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+d,description:"This is fake child item was created by loops reversal."}}),b.add([k.id,s[n]],e.id,e);q=[];c.loopTopo(this,function(a){q.push(a)});n=0;for(p=
q.length;n<p;n+=1)c.removeNode(q[n])}}return d}var d=null,e=null;return{process:function(f){var g=b.getNavigationFamily(),h=b.getMaximumId(),i=a.getItems(),g=g.clone(),h=c(i,g,h,f);d=g;e=h;if(f&&!g.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return d},getMaximumId:function(){return e}}};
primitives.common.LabelAnnotationTemplate=function(){var a=["div",{"class":["bp-item","bp-label-annotation"]}];return{template:function(){return a},getHashCode:function(){return"defaultLabelAnnotationTemplate"},render:function(a,c){c.element.innerHTML=c.context.title}}};
primitives.famdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,primitives.famdiagram.TaskManagerFactory,primitives.famdiagram.EventArgsFactory,{AnnotationLabelTemplate:primitives.common.AnnotationLabelTemplate,ButtonsTemplate:primitives.common.ButtonsTemplate,CheckBoxTemplate:primitives.common.CheckBoxTemplate,CursorTemplate:primitives.common.CursorTemplate,DotHighlightTemplate:primitives.common.DotHighlightTemplate,GroupTitleTemplate:primitives.common.GroupTitleTemplate,
HighlightTemplate:primitives.common.HighlightTemplate,ItemTemplate:primitives.common.ItemTemplate,UserTemplate:primitives.common.UserTemplate,LabelAnnotationTemplate:primitives.common.LabelAnnotationTemplate})};
primitives.famdiagram.EventArgsFactory=function(a,b,c,d){var e=new primitives.famdiagram.EventArgs,f=a.tasks.getTask("CombinedContextsTask"),g=a.tasks.getTask("AlignDiagramTask"),h=a.tasks.getTask("LogicalFamilyTask"),b=f.getConfig(b),i=f.getConfig(c),j=h.getLogicalFamily();b&&null!=b.id&&(e.oldContext=b);i&&null!=i.id&&(e.context=i,j.loopParents(this,i.id,function(a,b,d){if(0<d)return j.BREAK;e.parentItems.push(f.getConfig(a))}),j.loopChildren(this,i.id,function(a,b,d){if(0<d)return j.BREAK;e.childrenItems.push(f.getConfig(a))}),
h=primitives.common.getElementOffset(a.layout.mousePanel),a=primitives.common.getElementOffset(a.layout.element),c=g.getItemPosition(c),e.position=(new primitives.common.Rect(c.actualPosition)).translate(h.left,h.top).translate(-a.left,-a.top));null!=d&&(e.name=d);return e};primitives.famdiagram.getProcessDiagramConfig=function(){var a=function(){};return primitives.famdiagram.TaskManagerFactory(a,a,a).getProcessDiagramConfig()};
primitives.famdiagram.TaskManagerFactory=function(a,b,c,d){var e=new primitives.common.TaskManager;e.addDependency("options",a);e.addDependency("graphics",b);e.addDependency("layout",c);e.addDependency("templates",d);e.addDependency("defaultConfig",new primitives.famdiagram.Config);e.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);e.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);e.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
e.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);e.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);e.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);e.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);e.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
e.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);e.addDependency("isFamilyChartMode",!0);e.addDependency("showElbowDots",!0);e.addDependency("null",null);e.addDependency("foreground",2);e.addDependency("background",1);e.addTask("OptionsTask",["options"],primitives.famdiagram.OptionsTask,"#000000");e.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");e.addTask("CurrentScrollPositionTask",
["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");e.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");e.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");e.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");e.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],
primitives.famdiagram.SpousesOptionTask,"#000080");e.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");e.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,"#000080");e.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");
e.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");e.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");e.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,"#000080");e.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NormalizeOptionTask,"#000080");e.addTask("LinePaletteOptionTask",["OptionsTask",
"defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");e.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");e.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");e.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");e.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],
primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");e.addTask("NeighboursSelectionModeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NeighboursSelectionModeOptionTask,"#000080");e.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");e.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");
e.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");e.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig",
"background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");e.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");e.addTask("BackgroundAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");e.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");e.addTask("LogicalFamilyTask",["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");e.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,
"#000080");e.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");e.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");e.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");e.addTask("AddLabelAnnotationsTask",
["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");e.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");e.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");e.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","AddSpousesTask","defaultItemConfig"],primitives.famdiagram.NormalizeLogicalFamilyTask,
"#ff0000");e.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");e.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ActiveItemsTask,"#00ffff");e.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");e.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask",
"ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff");e.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");e.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");e.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");e.addTask("ButtonsTemplateTask",
["ItemsSizesOptionTask","templates"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");e.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");e.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","NormalizeLogicalFamilyTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");e.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],primitives.orgdiagram.HighlightItemTask,
"#00ffff");e.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");e.addTask("CursorNeighboursTask",["CursorItemTask","NeighboursSelectionModeOptionTask","AddLabelAnnotationsTask","ActiveItemsTask"],primitives.famdiagram.CursorNeighboursTask,"#00ffff");e.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");e.addTask("SelectionPathItemsTask",["AddLabelAnnotationsTask","CursorItemTask",
"SelectedItemsTask","CursorSelectionPathModeOptionTask"],primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",
["BackgroundAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",
["ForegroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");e.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask NormalizeOptionTask NormalizeLogicalFamilyTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.famdiagram.ItemsPositionsTask,"#ff0000");e.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask ActiveItemsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");e.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");e.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");e.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,
"#00ffff");e.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#00ffff");e.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics",
"ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");e.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");e.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");e.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");e.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),primitives.orgdiagram.DrawTreeItemsTask,"#008000");e.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask CombinedTemplateParamsTask AlignDiagramTask".split(" "),
primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");e.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],primitives.orgdiagram.DrawConnectorsTask,"#008000");e.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],primitives.orgdiagram.DrawItemLabelsTask,"#008000");return e};
primitives.orgdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.orgdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.includeChildren=!1;this.zOrderType=0;this.offset=new primitives.common.Thickness(18,18,18,18);this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.orgdiagram.Config=function(a){this.name=void 0!==a?a:"OrgDiagram";this.classPrefix="orgdiagram";this.graphicsType=this.navigationMode=0;this.pageFitMode=3;this.minimalVisibility=2;this.horizontalAlignment=this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.showExtraArrows=!1;this.extraArrowsMinimumSpace=30;this.showHorizontalArrows=!1;this.connectorType=0;this.bevelSize=4;this.elbowType=0;this.elbowDotSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=
[];this.annotations=[];this.highlightItem=this.cursorItem=null;this.highlightGravityRadius=40;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.selectionPathMode=1;this.templates=[];this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=
this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=1;this.linesType=0;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=0;this.calloutMaximumVisibility=2;this.showCallout=
!0;this.calloutPlacementOffset=100;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.leavesPlacementType=this.childrenPlacementType=2;this.maximumColumnsInMatrix=6;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.groupTitleOrientation=this.groupTitlePlacementType=2;this.groupTitleVerticalAlignment=
1;this.groupTitleHorizontalAlignment=0;this.groupTitleFontSize="12px";this.groupTitleFontFamily="Arial";this.groupTitleColor="#4169e1";this.groupTitleFontStyle=this.groupTitleFontWeight="normal";this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=2;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight=
"normal";this.enablePanning=!0;this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.orgdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorPlacementType=this.connectorShapeType=0;this.labelPlacementType=1;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=
a,this.toItem=b}};primitives.orgdiagram.HighlightPathAnnotationConfig=function(a){var b;this.zOrderType=this.annotationType=2;this.items=[];this.lineWidth=2;this.color="#ff0000";this.lineType=0;this.opacity=1;this.showArrows=!0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ItemConfig=function(a,b,c,d,e){var f;this.context=this.image=this.description=this.title=this.parent=this.id=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=this.isVisible=!0;this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=this.groupName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=
0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=e}};
primitives.orgdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null;this.cancel=!1};primitives.common.BaseConnectorBundle=function(){this.NORMAL_ITEM_WEIGHT=10010;this.LINE_ITEM_WEIGHT=1E4};primitives.common.BaseConnectorBundle.prototype.trace=function(){};primitives.common.BaseConnectorBundle.prototype.getId=function(a){var b="_"+a.nodeid;a.nodeid+=1;return b};
primitives.common.BaseConnectorBundle.prototype.ConnectorEdge=function(a,b,c,d,e,f,g,h,i,j){this.polyline=c;this.from=a;this.to=b;this.weight=g||0;this.fromOffset=h||0;this.parentsArrowId=d;this.childrenArrowId=e;this.dotId=f;this.hasMiddle=i;this.middleParent=j};
primitives.common.BaseConnectorBundle.prototype.ConnectorDestination=function(a){this.bundleid=this.y=this.x=this.id=null;this.hasElbow=!1;this.visibility=this.elbowPoint2=this.elbowPoint1=null;this.isSquared=!0;for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};
primitives.common.BaseConnectorBundle.prototype.traceFork=function(a,b,c,d,e,f,g,h,i){var j,k,m,l=[],n,p,q;if(f){l=[];f=0;for(k=e.length;f<k;f+=1)if(m=e[f],m.x<d.x&&!m.isSquared)l.push(m);else break;k=l.length;0<k&&(m=l[k-1],m=m.x==d.x?d:new this.ConnectorDestination({id:m.bundleid,x:m.x,y:d.y}),this.traceAngularSegments(a,b,c,m,l,!1));l=[];for(j=e.length-1;j>=f;j-=1)if(m=e[j],m.x>d.x&&!m.isSquared)l.push(m);else break;k=l.length;0<k&&(m=l[k-1],m=m.x==d.x?d:new this.ConnectorDestination({id:m.bundleid,
x:m.x,y:d.y}),this.traceAngularSegments(a,b,c,m,l,!1));for(l=f;l<=j;l+=1){m=e[l];k=c.bevelSize;2>k&&(k=0);if(b.hasGraphics)switch(c.elbowType){case 2:case 3:0<k&&(Math.abs(d.x-m.x)>k&&Math.abs(d.y-m.y)>k)&&(m.hasElbow=!0,m.elbowPoint1=new primitives.common.Point(m.x,d.y+(d.y>m.y?-k:k)),m.elbowPoint2=new primitives.common.Point(m.x+(d.x>m.x?k:-k),d.y))}n=new primitives.common.Polyline;m.hasElbow?(b.transform.transform3Points(m.elbowPoint2.x,m.elbowPoint2.y,m.elbowPoint1.x,m.elbowPoint2.y,m.elbowPoint1.x,
m.elbowPoint1.y,!0,this,function(a,b,d,e,g,f){switch(c.elbowType){case 2:n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(g,f));break;case 3:n.addSegment(new primitives.common.MoveSegment(a,b)),n.addSegment(new primitives.common.CubicArcSegment(a,b,d,e,g,f))}}),b.transform.transformPoints(m.elbowPoint1.x,m.elbowPoint1.y,m.x,m.y,!0,this,function(a,b,d,c){n.addSegment(new primitives.common.LineSegment(d,c))})):b.transform.transformPoints(m.x,d.y,m.x,
m.y,!0,this,function(a,b,d,c){n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(d,c))});k=m.x==d.x?d.id:m.bundleid;p=4!==m.visibility;a.graph.addEdge(k,m.id,new this.ConnectorEdge(k,m.id,n,g&&p?m.id:null,!g&&p?m.id:null,null,p?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT,h))}f=Math.max(f-1,0);j=Math.min(j+1,e.length-1);m=d;k=d.id;for(l=f;l<=j;l+=1)p=e[l],q=p.bundleid,p.x>m.x&&(n=new primitives.common.Polyline,b.transform.transformPoints(m.x,d.y,null!=
p.elbowPoint2?p.elbowPoint2.x:p.x,d.y,!0,this,function(a,b,d,c){n.addSegment(new primitives.common.MoveSegment(a,b));n.addSegment(new primitives.common.LineSegment(d,c))}),a.graph.addEdge(k,q,new this.ConnectorEdge(k,q,n,null,null,k,Math.abs(p.x-m.x)/1E4,h,i,g?q:k)),m=p,k=q);m=d;k=d.id;for(l=j;l>=f;l-=1)p=e[l],q=p.bundleid,p.x<m.x&&(n=new primitives.common.Polyline,b.transform.transformPoints(m.x,d.y,null!=p.elbowPoint2?p.elbowPoint2.x:p.x,d.y,!0,this,function(a,b,d,c){n.addSegment(new primitives.common.MoveSegment(a,
b));n.addSegment(new primitives.common.LineSegment(d,c))}),a.graph.addEdge(k,q,new this.ConnectorEdge(k,q,n,null,null,k,Math.abs(p.x-m.x)/1E4,h,i,g?q:k)),m=p,k=q)}else this.traceAngularSegments(a,b,c,d,e,!0)};
primitives.common.BaseConnectorBundle.prototype.traceAngularSegments=function(a,b,c,d,e,f){var g,h,i,j,k;g=0;for(h=e.length;g<h;g+=1){j=e[g];k=new primitives.common.Polyline;b.transform.transformPoint(d.x,d.y,!0,this,function(a,b){k.addSegment(new primitives.common.MoveSegment(a,b))});switch(c.connectorType){case 1:b.transform.transformPoint(j.x,j.y,!0,this,function(a,b){k.addSegment(new primitives.common.LineSegment(a,b))});break;case 2:i=new primitives.common.Rect(d,j),f?d.x>i.x?b.transform.transform3Points(i.right(),
i.verticalCenter(),i.x,i.verticalCenter(),i.x,i.bottom(),!0,this,function(a,b,d,c,e,g){k.addSegment(new primitives.common.CubicArcSegment(a,b,d,c,e,g))}):b.transform.transform3Points(i.x,i.verticalCenter(),i.right(),i.verticalCenter(),i.right(),i.bottom(),!0,this,function(a,b,d,c,e,g){k.addSegment(new primitives.common.CubicArcSegment(a,b,d,c,e,g))}):d.x>i.x?b.transform.transformPoints(i.x,i.y,i.x,i.bottom(),!0,this,function(a,b,d,c){k.addSegment(new primitives.common.QuadraticArcSegment(a,b,d,c))}):
b.transform.transformPoints(i.right(),i.y,i.right(),i.bottom(),!0,this,function(a,b,d,c){k.addSegment(new primitives.common.QuadraticArcSegment(a,b,d,c))})}i=4!==j.visibility;a.graph.addEdge(d.id,j.id,new this.ConnectorEdge(d.id,j.id,k,null,i?j.id:null,i?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT))}};primitives.common.HorizontalConnectorBundle=function(a,b){this.fromItem=a;this.toItem=b};primitives.common.HorizontalConnectorBundle.prototype=new primitives.common.BaseConnectorBundle;
primitives.common.HorizontalConnectorBundle.prototype.trace=function(a,b){var c=this.fromItem,d=this.toItem,e=b.treeItemsPositions[c],f=b.treeItemsPositions[d],g=new primitives.common.Polyline;e.actualPosition.x<f.actualPosition.x?b.transform.transformPoints(e.actualPosition.right(),e.horizontalConnectorsShift,f.actualPosition.x,f.horizontalConnectorsShift,!0,this,function(a,b,d,c){g.addSegment(new primitives.common.MoveSegment(a,b));g.addSegment(new primitives.common.LineSegment(d,c))}):b.transform.transformPoints(e.actualPosition.x,
e.horizontalConnectorsShift,f.actualPosition.right(),e.horizontalConnectorsShift,!0,this,function(a,b,d,c){g.addSegment(new primitives.common.MoveSegment(a,b));g.addSegment(new primitives.common.LineSegment(d,c))});f=4!==f.actualVisibility;e=4!==e.actualVisibility;a.graph.addEdge(c,d,new this.ConnectorEdge(c,d,g,f?d:null,e?c:null,f||e?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT))};
primitives.common.MatrixConnectorBundle=function(a,b,c,d,e){this.isChildren=a;this.items=b;this.len=b.length;this.matrixNodeId=c;this.connectionId=d;this.matrixWidth=e;this.blocksCount=Math.ceil(this.matrixWidth/2);this.rowsCount=Math.ceil(this.len/this.matrixWidth)};primitives.common.MatrixConnectorBundle.prototype=new primitives.common.BaseConnectorBundle;
primitives.common.MatrixConnectorBundle.prototype.trace=function(a,b,c){this.isChildren?this.traceChildrenLayout(a,b,c):this.traceParentsLayout(a,b,c)};
primitives.common.MatrixConnectorBundle.prototype.traceChildrenLayout=function(a,b,c){for(var d,e=[],f=0;f<this.blocksCount;f+=1){for(var g=null,h=this.rowsCount-1;0<=h;h-=1){var i=this.getNodeIndex(f,h,!0,!0),j=null;d=null;i<this.len&&(j=this.items[i],d=b.treeItemsPositions[j]);var k=this.getNodeIndex(f,h,!1,!0),m=null,i=null;k<this.len&&(m=this.items[k],i=b.treeItemsPositions[m]);var l=null;null==l&&null!=d&&(l=new this.ConnectorDestination({id:this.getId(a),x:d.actualPosition.horizontalCenter()+
d.rightMedianOffset,y:d.horizontalConnectorsShift}));null==l&&null!=i&&(l=new this.ConnectorDestination({id:this.getId(a),x:i.actualPosition.horizontalCenter()-i.leftMedianOffset,y:i.horizontalConnectorsShift}));null!=d&&(d=d.actualPosition,b.transform.transformPoints(d.right(),d.verticalCenter(),l.x,l.y,!0,this,function(b,d,c,e){var g=new primitives.common.Polyline;g.addSegment(new primitives.common.MoveSegment(b,d));g.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(j,l.id,new this.ConnectorEdge(j,
l.id,g,null,j,null,10))}));null!=i&&(d=i.actualPosition,b.transform.transformPoints(d.left(),d.verticalCenter(),l.x,l.y,!0,this,function(b,d,c,e){var g=new primitives.common.Polyline;g.addSegment(new primitives.common.MoveSegment(b,d));g.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(m,l.id,new this.ConnectorEdge(m,l.id,g,null,m,null,10))}));null!=g&&null!=l&&b.transform.transformPoints(g.x,g.y,l.x,l.y,!0,this,function(b,d,c,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,
d));f.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(g.id,l.id,new this.ConnectorEdge(g.id,l.id,f,null,null,null,0))});null!=l&&(g=l)}null!=g&&e.push(new this.ConnectorDestination({id:g.id,bundleid:this.getId(a),x:g.x,y:g.y,isSquared:!0,visibility:4}))}d=b.treeItemsPositions[this.matrixNodeId].actualPosition;f=new this.ConnectorDestination({id:this.matrixNodeId,x:d.horizontalCenter(),y:d.top()});this.traceFork(a,b,c,f,e,!0,!1,0,c.showExtraArrows)};
primitives.common.MatrixConnectorBundle.prototype.traceParentsLayout=function(a,b,c){for(var d,e=[],f=0;f<=this.blocksCount;f+=1){for(var g=null,h=0;h<this.rowsCount;h+=1){var i=this.getNodeIndex(f,h,!0,!1),j=null;d=null;i<this.len&&(j=this.items[i],d=b.treeItemsPositions[j]);var k=this.getNodeIndex(f,h,!1,!1),m=null,i=null;k<this.len&&(m=this.items[k],i=b.treeItemsPositions[m]);var l=null;null==l&&null!=d&&(l=new this.ConnectorDestination({id:this.getId(a),x:d.actualPosition.horizontalCenter()+d.rightMedianOffset,
y:d.horizontalConnectorsShift}));null==l&&null!=i&&(l=new this.ConnectorDestination({id:this.getId(a),x:i.actualPosition.horizontalCenter()-i.leftMedianOffset,y:i.horizontalConnectorsShift}));null!=d&&(d=d.actualPosition,b.transform.transformPoints(d.right(),d.verticalCenter(),l.x,l.y,!0,this,function(b,d,c,e){var g=new primitives.common.Polyline;g.addSegment(new primitives.common.MoveSegment(b,d));g.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(j,l.id,new this.ConnectorEdge(j,
l.id,g,j,null,null,10))}));null!=i&&(d=i.actualPosition,b.transform.transformPoints(d.left(),d.verticalCenter(),l.x,l.y,!0,this,function(b,d,c,e){var g=new primitives.common.Polyline;g.addSegment(new primitives.common.MoveSegment(b,d));g.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(m,l.id,new this.ConnectorEdge(m,l.id,g,m,null,null,10))}));null!=g&&null!=l&&b.transform.transformPoints(g.x,g.y,l.x,l.y,!0,this,function(b,d,c,e){var f=new primitives.common.Polyline;f.addSegment(new primitives.common.MoveSegment(b,
d));f.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(g.id,l.id,new this.ConnectorEdge(g.id,l.id,f,null,null,null,0))});null!=l&&(g=l)}null!=g&&e.push(new this.ConnectorDestination({id:g.id,bundleid:this.getId(a),x:g.x,y:g.y,isSquared:!0,visibility:4}))}d=b.treeItemsPositions[this.matrixNodeId].actualPosition;f=new this.ConnectorDestination({id:this.connectionId,x:d.horizontalCenter(),y:d.bottom()});this.traceFork(a,b,c,f,e,!0,!0,0,c.showExtraArrows)};
primitives.common.MatrixConnectorBundle.prototype.getNodeIndex=function(a,b,c,d){var e=null;d?(a=2*a+(c?0:1),this.matrixWidth>a&&(e=b*this.matrixWidth+a)):(a=2*a+(c?-1:0),0<=a&&a<this.matrixWidth&&(e=b*this.matrixWidth+a));return e};primitives.common.VerticalConnectorBundle=function(a,b){this.fromItems=a;this.toItems=b;this.childConnectorId={};this.fromStackSize=this.fromOffset=0};primitives.common.VerticalConnectorBundle.prototype=new primitives.common.BaseConnectorBundle;
primitives.common.VerticalConnectorBundle.prototype.trace=function(a,b,c){var d,e,f,g,h,i,j,k,m,l=0===c.connectorType;d=[];if(0<this.fromItems.length){f=this.fromItems;i=0;for(e=f.length;i<e;i+=1)g=f[i],h=b.treeItemsPositions[g],g=new this.ConnectorDestination({id:b.nestedLayoutBottomConnectorIds.hasOwnProperty(g)?b.nestedLayoutBottomConnectorIds[g]:g,bundleid:this.getId(a),x:h.actualPosition.horizontalCenter(),y:h.actualPosition.bottom(),isSquared:!0,visibility:h.actualVisibility}),d.push(g);d.sort(function(a,
b){return a.x-b.x});m=h.bottomConnectorShift-h.bottomConnectorInterval*(this.fromStackSize-this.fromOffset+1)}e=[];if(0<this.toItems.length){k=!1;f=this.toItems;for(i=0;i<f.length;i+=1){g=f[i];h=b.treeItemsPositions[g];j=!0;if(b.hasGraphics)switch(h.actualVisibility){case 2:case 3:j=l}g=new this.ConnectorDestination({id:g,bundleid:this.getId(a),x:h.actualPosition.horizontalCenter()+0,y:h.actualPosition.top(),isSquared:j,visibility:h.actualVisibility});e.push(g);k=k||g.isSquared}e.sort(function(a,
b){return a.x-b.x});j=h.topConnectorShift}f=1==e.length?e[0].x:1==d.length?d[0].x:0<e.length&&0<d.length?(d[0].x+d[d.length-1].x+e[0].x+e[e.length-1].x)/4:0<e.length?(e[0].x+e[e.length-1].x)/2:(d[0].x+d[d.length-1].x)/2;var n=null;0<d.length&&(n=new this.ConnectorDestination({id:this.getId(a),x:f,y:m}),this.traceFork(a,b,c,n,d,!0,!0,this.fromOffset,c.showExtraArrows&&0<e.length));var p=null;0<e.length&&(p=new this.ConnectorDestination({id:this.getId(a),x:f,y:j}),null!=n&&p.y==n.y&&(p=n),this.traceFork(a,
b,c,p,e,k,!1,0,c.showExtraArrows&&0<d.length));null!=n&&(null!=p&&n.id!=p.id)&&b.transform.transformPoints(n.x,n.y,p.x,p.y,!0,this,function(b,d,c,e){var g=new primitives.common.Polyline;g.addSegment(new primitives.common.MoveSegment(b,d));g.addSegment(new primitives.common.LineSegment(c,e));a.graph.addEdge(n.id,p.id,new this.ConnectorEdge(n.id,p.id,g,null,null,null,0))})};primitives.orgdiagram.LevelVisibility=function(a,b){this.level=a;this.currentvisibility=b};
primitives.orgdiagram.OrgItem=function(a){var b,c,d;this.id=null;this.isActive=this.isVisible=!0;this.hasVisibleChildren=!1;this.childrenPlacementType=this.adviserPlacementType=this.itemType=0;this.level=null;this.hideChildrenConnection=this.hideParentConnection=!1;this.childIndex=null;var e="id parent isVisible isActive itemType adviserPlacementType childrenPlacementType".split(" ");b=0;for(c=e.length;b<c;b+=1)d=e[b],a.hasOwnProperty(d)&&(this[d]=a[d])};
primitives.orgdiagram.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.common.ItemTemplate(a,b):new primitives.common.UserTemplate(a,b.itemTemplate,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.common.HighlightTemplate(a,b):new primitives.common.UserTemplate(a,
b.highlightTemplate,a.onHighlightRender),this.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.common.CursorTemplate(a,b):new primitives.common.UserTemplate(a,b.cursorTemplate,a.onCursorRender))};primitives.orgdiagram.TemplateParams=function(){this.template=null;this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isActive=!1;this.buttons=[]};
primitives.orgdiagram.TreeItem=function(){this.visualAggregatorId=this.id=null;this.visualDepth=1;this.partners=[];this.visibility=1;this.actualItemType=null;this.relationDegree=this.gravity=this.connectorPlacement=0};
primitives.orgdiagram.TreeItemPosition=function(a){this.partnerConnectorOffset=0;this.levelPosition=this.level=null;this.rightPadding=this.leftPadding=this.offset=0;this.actualVisibility=1;this.topConnectorShift=this.horizontalConnectorsShift=this.contentPosition=this.actualPosition=this.actualSize=null;this.topConnectorInterval=0;this.bottomConnectorShift=null;this.bottomConnectorInterval=0;this.rightMedianOffset=this.leftMedianOffset=null;if(null!=a)for(var b in a)if(a.hasOwnProperty(b))switch(b){case "actualPosition":this.actualPosition=
new primitives.common.Rect(a.actualPosition);break;default:this[b]=a[b]}};primitives.orgdiagram.TreeLevelConnectorStackSize=function(){this.parentsStackSize=0};
primitives.orgdiagram.TreeLevelPosition=function(a){this.actualVisibility=this.currentvisibility=1;this.currentOffset=this.levelSpace=this.connectorShift=this.topConnectorShift=this.horizontalConnectorsDepth=this.nextLevelShift=this.depth=this.shift=0;this.labels=[];this.labelsRect=null;this.showLabels=!0;this.hasFixedLabels=!1;if(null!=a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};
primitives.orgdiagram.TreeLevelPosition.prototype.setShift=function(a,b,c,d,e){this.shift=a;this.levelSpace=b;this.topConnectorShift=-b/2-c;this.connectorShift=this.depth+d+(e+1)*(b/2);return this.nextLevelShift=c+this.depth+d+b+e*b/2};primitives.orgdiagram.TreeLevelPosition.prototype.shiftDown=function(a){this.shift+=a};primitives.orgdiagram.TreeLevelPosition.prototype.toString=function(){return this.currentvisibility};
primitives.orgdiagram.AlignDiagramTask=function(a,b,c,d,e,f,g,h){function i(){var a=[],b={},d;for(d in j.treeItemsPositions)if(j.treeItemsPositions.hasOwnProperty(d)){var c=j.treeItemsPositions[d];switch(c.actualVisibility){case 1:case 2:case 3:c=c.actualPosition,c=Math.max(c.width,c.height),b.hasOwnProperty(c)||(b[c]=!0,a.push(c))}}return a}var j={treeItemsPositions:{},panelSize:null},k,m,l,n,p,q,s,r;return{process:function(){var i=new primitives.common.Size(g.getContentSize()),u=new primitives.common.Size(e.getOptimalPanelSize());
r=s=null;k=null!=f?f.getActiveItems():{};m=g.getItemsPositions();l=b.getOptions();n=a.getOptions();p=c.getOptions();q=d.getOptions();switch(n.orientationType){case 2:case 3:u.invert()}u.scale(1/q.scale);j.panelSize=u;j.treeItemsPositions=m;switch(l.pageFitMode){case 5:j.panelSize=new primitives.common.Size(i);break;default:j.panelSize=new primitives.common.Size(i);if(i.width<u.width){j.treeItemsPositions={};var x=i.width,w=u.width,z;if(h)z=(w-x)/2;else switch(p.horizontalAlignment){case 1:z=0;break;
case 2:z=w-x;break;case 0:z=(w-x)/2}var x=j.treeItemsPositions,t;for(t in m)m.hasOwnProperty(t)&&(w=new primitives.orgdiagram.TreeItemPosition(m[t]),w.actualPosition.translate(z,0),x[t]=w);j.panelSize.width=u.width}i.height<u.height&&(j.panelSize.height=u.height)}switch(n.orientationType){case 2:case 3:j.panelSize.invert()}return!0},getItemPosition:function(a){return j.treeItemsPositions[a]},getItemsPositions:function(){return j.treeItemsPositions},getContentSize:function(){return j.panelSize},getTreeItemForMousePosition:function(a,
b,d){var c=null,e=null,g=q.scale,f;if(null==s)for(f in s=primitives.common.SpatialIndex(i()),j.treeItemsPositions)if(j.treeItemsPositions.hasOwnProperty(f)){var h=j.treeItemsPositions[f];if(k.hasOwnProperty(f))switch(h.actualVisibility){case 1:case 2:case 3:h=new primitives.common.Rect(h.actualPosition),h.context=f,s.addRect(h)}}f=s;var m,a=a/g,b=b/g,g=new primitives.common.Rect(a,b,0,0);m=new primitives.common.Point(a,b);g.offset(d,d,d,d);f.loopArea(this,g,function(d){var g=d.context;if(d.contains(a,
b))return c=g,!0;switch(j.treeItemsPositions[g].actualVisibility){case 2:case 3:if(d=m.distanceTo(d.horizontalCenter(),d.verticalCenter()),null==e||d<e)e=d,c=g}});return c},getNextItem:function(a,b){var d;if(null==r)for(d in r=primitives.common.KeyboardNavigationManager(),j.treeItemsPositions)if(j.treeItemsPositions.hasOwnProperty(d)){var c=j.treeItemsPositions[d];if(k.hasOwnProperty(d))switch(c.actualVisibility){case 1:c=new primitives.common.Rect(c.actualPosition),r.addRect(c,d)}}d=r;var e;switch(b){case 0:e=
d.getItemAbove(a);break;case 1:e=d.getItemBelow(a);break;case 2:e=d.getItemOnLeft(a);break;case 3:e=d.getItemOnRight(a)}return e}}};
primitives.orgdiagram.ApplyLayoutChangesTask=function(a,b,c,d,e,f){var g=null,h;return{process:function(){var i=b(),j=a(),k=e.getOptions().scale;h=c.getOptions();var m=new primitives.common.Size(f.getContentSize());m.scale(1*k);primitives.common.JsonML.applyStyles(i.mousePanel,m.getCSS());var l=new primitives.common.Size(f.getContentSize());primitives.common.JsonML.applyStyles(i.placeholder,l.getCSS());j.resize("placeholder",l.width,l.height);switch(h.pageFitMode){case 5:g=new primitives.common.Size(m.width+
25,m.height+25);g.cropBySize(h.autoSizeMaximum);g.addSize(h.autoSizeMinimum);primitives.common.JsonML.applyStyles(i.element,g.getCSS());break;default:g=new primitives.common.Size(d.getScrollPanelSize())}j=primitives.common.getFixOfPixelALignment(i.element);primitives.common.JsonML.applyStyles(i.scrollPanel,{top:"0px",left:"0px",width:g.width+"px",height:g.height+"px",marginBottom:"0px",marginRight:"0px",marginLeft:j.width+"px",marginTop:j.height+"px"});k="scale("+k+","+k+")";primitives.common.JsonML.applyStyles(i.placeholder,
{"transform-origin":"0 0",transform:k,"-ms-transform":k,"-webkit-transform":k,"-o-transform":k,"-moz-transform":k});return!0},getOptimalPanelSize:function(){return new primitives.common.Size(g.width-25,g.height-25)}}};
primitives.orgdiagram.CenterOnCursorTask=function(a,b,c,d,e,f,g){function h(a){var b=!1;j.transformRect(a.x,a.y,a.width,a.height,!0,this,function(a,d,c,e){b=new primitives.common.Rect(a,d,c,e)});return b}var i=null,j;return{process:function(){var k;k=a();var m=d.getCursorTreeItem(),l=e.getItemPosition(m),m=e.getContentSize(),n;n=g.getOptions().scale;i=c.getPlaceholderOffset();k.forceCenterOnCursor&&(j=f.getTransform(),null!=l&&(k=h(l.actualPosition),k.scale(n),m.scale(n),n=b.getScrollPanelSize(),
i=new primitives.common.Point(Math.max(Math.min(k.horizontalCenter()-n.width/2,m.width-n.width),0),Math.max(Math.min(k.verticalCenter()-n.height/2,m.height-n.height),0))));return!0},getPlaceholderOffset:function(){return i}}};
primitives.orgdiagram.CreateTransformTask=function(a,b){var c=null;return{process:function(){var d=a.getOptions(),e=new primitives.common.Size(b.getContentSize());c=new primitives.common.Transform;c.setOrientation(d.orientationType);c.size=new primitives.common.Size(e);return!0},getTransform:function(){return c},getTreeItemForMousePosition:function(a,e,f){var g=null;c.transformPoint(a,e,!1,this,function(a,d){g=b.getTreeItemForMousePosition(a,d,f)});return g},description:"Create oordiante system tranfromation object."}};
primitives.orgdiagram.CurrentControlSizeTask=function(a,b,c){var d={scrollPanelSize:null},e={},f=new primitives.common.ObjectReader({scrollPanelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!0),height:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var b={isChanged:!1,hash:e},h=a(),h={scrollPanelSize:primitives.common.getInnerSize(h.element)},i=!1,j=c.getOptions();d=f.read(d,h,"layout",b);switch(j.pageFitMode){case 1:case 2:case 3:case 0:i=
b.isChanged}return i},getScrollPanelSize:function(){return d.scrollPanelSize},getOptimalPanelSize:function(){return new primitives.common.Size(d.scrollPanelSize.width-25,d.scrollPanelSize.height-25)}}};
primitives.orgdiagram.CurrentScrollPositionTask=function(a){var b={placeholderOffset:null},c={},d=new primitives.common.ObjectReader({placeholderOffset:new primitives.common.ObjectReader({x:new primitives.common.ValueReader(["number"],!0),y:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var e={isChanged:!1,hash:c},f=a(),f={placeholderOffset:new primitives.common.Point(f.scrollPanel.scrollLeft,f.scrollPanel.scrollTop)};b=d.read(b,f,"layout",e);return e.isChanged},
getPlaceholderOffset:function(){return b.placeholderOffset}}};
primitives.orgdiagram.BackgroundAnnotationOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),includeChildren:new primitives.common.ValueReader(["boolean"],!1,b.includeChildren),zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,
b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],
!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems)}),!1);return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(4,null),"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};
primitives.orgdiagram.ConnectorAnnotationOptionTask=function(a,b,c){var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItem:new primitives.common.ValueReader(["string","number"],!0),connectorShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.connectorShapeType),connectorPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorPlacementType,
!1,b.connectorPlacementType),labelPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorLabelPlacementType,!1,b.labelPlacementType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],
!1,b.lineWidth),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string","object"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},
!1,b.labelSize)}),!1);return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getAnnotations(0,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.HighlightPathAnnotationOptionTask=function(a,b,c){var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,b.lineType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!1),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),showArrows:new primitives.common.ValueReader(["boolean"],!1,b.showArrows)},!1));return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getAnnotations(2,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.ShapeAnnotationOptionTask=function(a,b,c){var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),shapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.shapeType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],
!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),cornerRadius:new primitives.common.ValueReader(["string"],!1,b.cornerRadius),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],
!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string","object"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,
b.labelSize.height)},!1,b.labelSize),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset)},!1));return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getAnnotations(1,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.SplitAnnotationsOptionTask=function(a){var b={};return{process:function(){var c=a.getOptions().annotations,d,e,f,g,h,i={};if(primitives.common.isArray(c)){d=0;for(e=c.length;d<e;d+=1){f=c[d];g=f.annotationType;switch(g){case 1:case 0:case 2:switch(f.zOrderType){case 1:h=1;break;default:h=2}break;default:h=null}null!=g&&(g=1E3*g+(h||0),i.hasOwnProperty(g)||(i[g]=[]),i[g].push(f))}}b=i;return!0},getAnnotations:function(a,d){return b[1E3*a+(d||0)]}}};
primitives.orgdiagram.CursorItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({cursorItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getCursorItem:function(){return c.cursorItem},hasCursorEnabled:function(){switch(c.navigationMode){case 0:case 1:return!0}return!1},
description:"Checks currenct cursor item option."}};primitives.orgdiagram.CursorSelectionPathModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,!1,b.selectionPathMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getSelectionPathMode:function(){return c.selectionPathMode},description:"Checks cursor selection path option."}};
primitives.orgdiagram.HighlightItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({highlightItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode),highlightGravityRadius:new primitives.common.ValueReader(["number"],!1,b.highlightGravityRadius)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getHighlightItem:function(){return c.highlightItem},
hasHighlightEnabled:function(){switch(c.navigationMode){case 0:case 3:return!0}return!1},getGravityRadius:function(){return c.highlightGravityRadius},description:"Checks highlight item option."}};
primitives.orgdiagram.SelectedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({selectedItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)});return{process:function(){var e={isChanged:!1,hash:c},f=a.getOptions();b=d.read(b,f,"options",e);return e.isChanged},getSelectedItems:function(){return b.selectedItems},description:"Checks user selected items option."}};
primitives.orgdiagram.CalloutOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({calloutMaximumVisibility:new primitives.common.EnumerationReader(primitives.common.Visibility,!1,b.calloutMaximumVisibility),showCallout:new primitives.common.ValueReader(["boolean"],!1,b.showCallout),calloutPlacementOffset:new primitives.common.ValueReader(["number"],!1,b.calloutPlacementOffset),orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType),
defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultCalloutTemplateName:new primitives.common.ValueReader(["string"],!0),calloutfillColor:new primitives.common.ValueReader(["string"],!1,b.calloutfillColor),calloutBorderColor:new primitives.common.ValueReader(["string"],!0),calloutOffset:new primitives.common.ValueReader(["number"],!1,b.calloutOffset),calloutCornerRadius:new primitives.common.ValueReader(["string"],!1,b.calloutCornerRadius),calloutPointerWidth:new primitives.common.ValueReader(["string"],
!1,b.calloutPointerWidth),calloutLineWidth:new primitives.common.ValueReader(["number"],!1,b.calloutLineWidth),calloutOpacity:new primitives.common.ValueReader(["number"],!1,b.calloutOpacity),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),showCallout:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.showCallout),calloutTemplateName:new primitives.common.ValueReader(["string"],!0),templateName:new primitives.common.ValueReader(["string"],
!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},getItemOptions:function(a){return d["options-items"][a]},description:"Checks item callout options."}};
primitives.orgdiagram.ConnectorsOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),showExtraArrows:new primitives.common.ValueReader(["boolean"],!1,b.showExtraArrows),extraArrowsMinimumSpace:new primitives.common.ValueReader(["number"],!1,b.extraArrowsMinimumSpace),connectorType:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("connectorType")?
b.connectorType:0),showNeigboursConnectorsHighlighted:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("showNeigboursConnectorsHighlighted")?b.showNeigboursConnectorsHighlighted:!1),elbowType:new primitives.common.EnumerationReader(primitives.common.ElbowType,!1,b.elbowType),bevelSize:new primitives.common.ValueReader(["number"],!1,b.bevelSize),elbowDotSize:new primitives.common.ValueReader(["number"],!1,b.elbowDotSize),linesColor:new primitives.common.ValueReader(["string"],
!1,b.linesColor),linesWidth:new primitives.common.ValueReader(["number"],!1,b.linesWidth),linesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.linesType),highlightLinesColor:new primitives.common.ValueReader(["string"],!1,b.highlightLinesColor),highlightLinesWidth:new primitives.common.ValueReader(["number"],!1,b.highlightLinesWidth),highlightLinesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.highlightLinesType)});return{process:function(){var b=
{isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks connector lines drawing options."}};
primitives.orgdiagram.ItemsOptionTask=function(a,b){var c={},d={},e={},f=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parent:new primitives.common.ValueReader(["string","number"],!0),itemType:new primitives.common.EnumerationReader(primitives.orgdiagram.ItemType,!1,b.itemType),adviserPlacementType:new primitives.common.EnumerationReader(primitives.common.AdviserPlacementType,
!1,b.adviserPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),isVisible:new primitives.common.ValueReader(["boolean"],!1,b.isVisible),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0,!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:e};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return e["options-items"][a]},
description:"Checks items configuration options effecting their placement in layout."}};
primitives.orgdiagram.ItemsSizesOptionTask=function(a,b,c,d){var e={},f={},g=new primitives.common.ObjectReader({defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultLabelAnnotationTemplate:new primitives.common.ValueReader(["string"],!0),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasButtons),buttonsPanelSize:new primitives.common.ValueReader(["number"],
!1,b.buttonsPanelSize),groupTitlePanelSize:new primitives.common.ValueReader(["number"],!1,b.groupTitlePanelSize),groupTitlePlacementType:new primitives.common.EnumerationReader(primitives.common.AdviserPlacementType,!1,b.groupTitlePlacementType),checkBoxPanelSize:new primitives.common.ValueReader(["number"],!1,b.checkBoxPanelSize),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],
!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.size.width),height:new primitives.common.ValueReader(["number"],!1,d.size.height)},!1,d.size)}),!0,"name"),pageFitMode:new primitives.common.EnumerationReader(primitives.common.PageFitMode,!1,b.pageFitMode),minimalVisibility:new primitives.common.EnumerationReader(primitives.common.Visibility,
!1,b.minimalVisibility),selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,!1,b.selectionPathMode),autoSizeMinimum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.width),height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.height)},!1,b.autoSizeMinimum),autoSizeMaximum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.width),
height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.height)},!1,b.autoSizeMaximum),scale:new primitives.common.ValueReader(["number"],!1,b.scale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),normalLevelShift:new primitives.common.ValueReader(["number"],!1,b.normalLevelShift),dotLevelShift:new primitives.common.ValueReader(["number"],!1,b.dotLevelShift),lineLevelShift:new primitives.common.ValueReader(["number"],
!1,b.lineLevelShift),normalItemsInterval:new primitives.common.ValueReader(["number"],!1,b.normalItemsInterval),dotItemsInterval:new primitives.common.ValueReader(["number"],!1,b.dotItemsInterval),lineItemsInterval:new primitives.common.ValueReader(["number"],!1,b.lineItemsInterval),cousinsIntervalMultiplier:new primitives.common.ValueReader(["number"],!1,b.cousinsIntervalMultiplier),verticalAlignment:new primitives.common.EnumerationReader(primitives.common.VerticalAlignmentType,!1,b.verticalAlignment),
items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),groupTitle:new primitives.common.ValueReader(["string","number"],!0),isVisible:new primitives.common.ValueReader(["boolean","number"],!1,c.isVisible),isActive:new primitives.common.ValueReader(["boolean","number"],!1,c.isActive),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,
!1,c.hasButtons),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:f};e=g.read(e,a.getOptions(),"options",b);return b.isChanged},getItemOptions:function(a){return f["options-items"][a]},getOptions:function(){return e},description:"Checks items size options."}};
primitives.orgdiagram.LabelsOptionTask=function(a,b,c){var d={},e={},f=new primitives.common.ObjectReader({showLabels:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.showLabels),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset),labelFontSize:new primitives.common.ValueReader(["string"],!1,b.labelFontSize),labelFontFamily:new primitives.common.ValueReader(["string"],!1,b.labelFontFamily),labelFontStyle:new primitives.common.ValueReader(["string"],!1,
b.labelFontStyle),labelFontWeight:new primitives.common.ValueReader(["string"],!1,b.labelFontWeight),labelColor:new primitives.common.ValueReader(["string"],!1,b.labelColor),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},!1,b.labelSize),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,b.labelOrientation),
labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),label:new primitives.common.ValueReader(["string","number"],!0),showLabel:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.showLabel),
labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,0),height:new primitives.common.ValueReader(["number"],!1,0)},!0),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,c.labelOrientation),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,c.labelPlacement)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getOptions(),"options",b);return b.isChanged},
getItemOptions:function(a){return e["options-items"][a]},getItemsOptions:function(){return e["options-items"]},getOptions:function(){return d},description:"Checks items labels options."}};
primitives.orgdiagram.MinimizedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),itemTitleColor:new primitives.common.ValueReader(["string"],!0)}),
!0,"id")});return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",e);return e.isChanged},getItemOptions:function(a){return c["options-items"][a]},getOptions:function(){return b},description:"Checks minimized items drawing options."}};primitives.orgdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.orgdiagram.OrientationOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks diagram orientation options."}};
primitives.orgdiagram.ScaleOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({scale:new primitives.common.ValueReader(["number"],!1,b.scale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks control scale options."}};
primitives.orgdiagram.TemplatesOptionTask=function(a,b,c,d){var e={},f={},g=new primitives.common.ObjectReader({groupTitleVerticalAlignment:new primitives.common.EnumerationReader(primitives.common.VerticalAlignmentType,!1,b.groupTitleVerticalAlignment),groupTitleHorizontalAlignment:new primitives.common.EnumerationReader(primitives.common.HorizontalAlignmentType,!1,b.groupTitleHorizontalAlignment),groupTitleOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,
b.groupTitleOrientation),groupTitleFontSize:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontSize),groupTitleFontFamily:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontFamily),groupTitleColor:new primitives.common.ValueReader(["string"],!1,b.groupTitleColor),groupTitleFontWeight:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontWeight),groupTitleFontStyle:new primitives.common.ValueReader(["string"],!1,b.groupTitleFontStyle),itemTitleFirstFontColor:new primitives.common.ValueReader(["string"],
!1,b.itemTitleFirstFontColor),itemTitleSecondFontColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleSecondFontColor),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),onItemRender:new primitives.common.FunctionReader,onCursorRender:new primitives.common.FunctionReader,onHighlightRender:new primitives.common.FunctionReader,templates:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],
!0),isActive:new primitives.common.ValueReader(["boolean"],!1,d.isActive),itemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.itemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.itemSize.height)},!1,d.itemSize),itemBorderWidth:new primitives.common.ValueReader(["number"],!1,d.itemBorderWidth),itemTemplate:new primitives.common.ValueReader(["string","object"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,
!0),minimizedItemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.height)},!1,d.minimizedItemSize),minimizedItemCornerRadius:new primitives.common.ValueReader(["number"],!0),minimizedItemLineWidth:new primitives.common.ValueReader(["number"],!1,d.minimizedItemLineWidth),minimizedItemBorderColor:new primitives.common.ValueReader(["string"],!0),minimizedItemLineType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,d.minimizedItemLineType),minimizedItemFillColor:new primitives.common.ValueReader(["string"],!0),minimizedItemOpacity:new primitives.common.ValueReader(["number"],!1,d.minimizedItemOpacity),highlightPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.left),top:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.right),bottom:new primitives.common.ValueReader(["number"],
!1,d.highlightPadding.bottom)},!1,d.highlightPadding),highlightBorderWidth:new primitives.common.ValueReader(["number"],!1,d.highlightBorderWidth),highlightTemplate:new primitives.common.ValueReader(["string","object"],!0),cursorPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.left),top:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.right),bottom:new primitives.common.ValueReader(["number"],
!1,d.cursorPadding.bottom)},!1,d.cursorPadding),cursorBorderWidth:new primitives.common.ValueReader(["number"],!1,d.cursorBorderWidth),cursorTemplate:new primitives.common.ValueReader(["string","object"],!0),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],!1,!1),tooltip:new primitives.common.ValueReader(["string"],
!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,c.size.width),height:new primitives.common.ValueReader(["number"],!1,c.size.height)},!1,c.size)}),!0,"name")}),!0,"name")});return{process:function(){var b={isChanged:!1,hash:f};e=g.read(e,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return e},description:"Checks items template options."}};
primitives.orgdiagram.VisualTreeOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({leavesPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.leavesPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),maximumColumnsInMatrix:new primitives.common.ValueReader(["number"],!1,b.maximumColumnsInMatrix),horizontalAlignment:new primitives.common.EnumerationReader(primitives.common.HorizontalAlignmentType,
!1,b.horizontalAlignment)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks items layout options."}};
primitives.orgdiagram.CollinearVectorBundle=function(){var a=new primitives.common.Rect,b=[],c=[];return{addVector:function(d,e){b.push(d);c.push(e);a.addRect(d.from.x,d.from.y);a.addRect(d.to.x,d.to.y)},resolve:function(){if(1==b.length)c[0](0,1,1);else{var d=primitives.common.pile(),e,f,g;if(a.width>a.height){e=0;for(f=b.length;e<f;e+=1)g=b[e],d.add(g.from.x,g.to.x,c[e])}else{e=0;for(f=b.length;e<f;e+=1)g=b[e],d.add(g.from.y,g.to.y,c[e])}d.resolve(this,function(a,b,d,c,e,g){d(c,e,g)})}}}};
primitives.orgdiagram.ConnectorAnnotationOffsetResolver=function(){var a={};return{getOffset:function(b,c){var d=b.getLineKey();a.hasOwnProperty(d)||(a[d]=new primitives.orgdiagram.CollinearVectorBundle);a[d].addVector(b,c)},resolve:function(){for(var b in a)a.hasOwnProperty(b)&&a[b].resolve()}}};
primitives.orgdiagram.DrawBackgroundAnnotationTask=function(a,b,c,d,e,f){function g(a,b,d){var c,e,g,i,r,v,u,x,w,z,t,A,b=0;for(c=a.length;b<c;b+=1)if(t=a[b],null!=t.items&&0<t.items.length){i=new primitives.common.MergedRectangles(h);i.transform=j;r=new primitives.orgdiagram.BackgroundAnnotationConfig;w=["opacity","lineWidth","borderColor","fillColor","lineType"];e=0;for(g=w.length;e<g;e+=1)z=w[e],i[z]=t.hasOwnProperty(z)?t[z]:r[z];h.activate("placeholder",2);v=[];x={};e=0;for(g=t.items.length;e<
g;e+=1)r=t.items[e],A=f.getItemPosition(r),null!=A&&(x[r]=!0,u=new primitives.common.Rect(A.actualPosition),u.offset(t.offset),v.push(u),t.includeChildren&&d.loopChildren(this,r,function(a){x[a]||(x[a]=!0,A=f.getItemPosition(a),u=new primitives.common.Rect(A.actualPosition),u.offset(t.offset),v.push(u))}));i.draw(v)}}var h,i,j;return{process:function(){var c=d.getAnnotations(),m;h=a();h.reset("placeholder",2);0<c.length&&(i=f.getItemsPositions(),j=b.getTransform(),m=e.getNavigationFamily(),g(c,i,
m));return!1}}};
primitives.orgdiagram.DrawConnectorAnnotationTask=function(a,b,c,d,e,f,g,h){function i(a,b){var d,c,e,g,f,i,w,z,t=new primitives.common.PolylinesBuffer,A=primitives.orgdiagram.ConnectorAnnotationOffsetResolver(),y=0;switch(h){case 1:j.activate("placeholder",4);break;case 2:j.activate("placeholder",14)}d=0;for(c=a.length;d<c;d+=1)w=a[d],y=Math.max(y,w.lineWidth);d=0;for(c=a.length;d<c;d+=1)if(w=a[d],null!=w.fromItem&&null!=w.toItem&&(e=b(w.fromItem),g=b(w.toItem),null!=e&&null!=g)){e=e.actualPosition;
f=g.actualPosition;switch(w.connectorPlacementType){case 0:i=new primitives.common.ConnectorOffbeat;break;case 1:i=new primitives.common.ConnectorStraight}var F;k.transformRect(0,0,w.labelSize.width,w.labelSize.height,!1,this,function(a,b,d,c){F=new primitives.common.Size(d,c)});var C=null;k.transformRect(0,0,l.width,l.height,!1,this,function(a,b,d,c){C=new primitives.common.Size(d,c)});g=new primitives.common.PaletteItem({lineColor:w.color,lineWidth:w.lineWidth,lineType:w.lineType});var B=!primitives.common.isNullOrEmpty(w.label);
e=(new primitives.common.Rect(e)).offset(w.offset);f=(new primitives.common.Rect(f)).offset(w.offset);i.draw(t,g,e,f,3*w.lineWidth,6*y,F,C,w.connectorShapeType,4,w.labelPlacementType,B,A,function(a){B&&null!=a&&(k.transformRect(a.x,a.y,a.width,a.height,!0,this,function(b,d,c,e){a=new primitives.common.Rect(b,d,c,e)}),z=new primitives.common.RenderEventArgs,z.context=w,j.template(a.x,a.y,0,0,0,0,a.width,a.height,m.template(),m.getHashCode(),m.render,z,null))})}A.resolve();t.transform(k,!0);j.polylinesBuffer(t)}
var j,k,m,l;return{process:function(){j=a();k=b.getTransform();d.getOptions();m=g.getTemplate();l=new primitives.common.Size(f.getContentSize());switch(h){case 1:j.reset("placeholder",4);break;case 2:j.reset("placeholder",14)}i(e.getAnnotations(),f.getItemPosition);return!1}}};
primitives.orgdiagram.DrawConnectorsTask=function(a,b,c,d,e){return{process:function(){var f=a(),g=b.getGraph(),h=c.getOptions(),i=e.getPaletteManager();f.reset("placeholder",6);f.activate("placeholder",6);var j=new primitives.common.PolylinesBuffer,k=Math.round(h.elbowDotSize/2),m={},l={};g.loopNodes(this,null,function(a){g.loopNodeEdges(this,a,function(b,c){if(!m.hasOwnProperty(b)){var e=null;1>=c.fromOffset?e=i.getPalette(1):(i.selectPalette(c.fromOffset),e=i.getPalette(0));var g=j.getPolyline(e);
if(d&&null!=c.dotId&&0!=h.elbowType&&!l.hasOwnProperty(c.dotId)){var e=j.getPolyline(g.arrowPaletteItem),f=c.dotId==c.from?c.polyline.getStartPoint():c.polyline.getEndPoint();e.addSegment(new primitives.common.DotSegment(f.x-k,f.y-k,2*k,2*k,k));l[c.dotId]=!0}e=null;null!=c.parentsArrowId&&1==h.arrowsDirection?e=c.parentsArrowId:null!=c.childrenArrowId&&2==h.arrowsDirection&&(e=c.childrenArrowId);null==e?(e=c.polyline.clone(),c.hasMiddle&&0!=h.arrowsDirection&&(f=!0,f=c.from==c.middleParent?2==h.arrowsDirection:
1==h.arrowsDirection,e.addOffsetArrow(f,h.linesWidth,0.4,h.extraArrowsMinimumSpace,function(a){a.mergeTo(j.getPolyline(g.arrowPaletteItem))})),c.from==a?e.mergeTo(g):g.addInverted(e)):(e==c.to?c.polyline.clone().mergeTo(g):g.addInverted(c.polyline.clone()),g.addArrow(h.linesWidth,function(a){a.mergeTo(j.getPolyline(a.paletteItem))}))}});m[a]=!0});f.polylinesBuffer(j);return!1}}};
primitives.orgdiagram.DrawCursorTask=function(a,b,c,d,e,f,g,h){function i(a){var b;j.activate("placeholder",11);var c=e.getItemPosition(a),g=c.actualPosition,i=new primitives.common.Rect(c.contentPosition),s=f.getTemplateParams(a).template,r=s.templateConfig,c=r.cursorPadding;i.offset(c.left,c.top,c.right,c.bottom);b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=!0;b.isSelected=h.isSelected(a);b.templateName=r.name;k.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,
d,c,e){j.template(a,d,c,e,i.x,i.y,i.width,i.height,s.cursorTemplate.template(),s.cursorTemplate.getHashCode(),s.cursorTemplate.render,b,{borderWidth:r.cursorBorderWidth})})}var j,k;return{process:function(){var d=g.getCursorTreeItem();j=a();j.reset("placeholder",11);null!=d&&(k=b.getTransform(),i(d));return!1}}};
primitives.orgdiagram.DrawHighlightAnnotationTask=function(a,b,c,d,e,f,g,h,i,j,k,m,l){function n(a){var b,c,k,n,y,F,C=!0,B,D=i.getItemPosition(a),H=D.actualPosition;switch(D.actualVisibility){case 2:case 3:case 1:b=g.getItemOptions(a);switch(b.showCallout){case 2:C=!1;break;case 1:C=!1;break;default:C=v.showCallout}C?(q.activate("placeholder",12),s.transformRect(H.x,H.y,H.width,H.height,!0,this,function(g,s,H,E){var s=new primitives.common.Rect(g,s,H,E),g=new primitives.common.Point(s.horizontalCenter(),
s.verticalCenter()),H=e.getOptions().scale,E=new primitives.common.Point(j.getPlaceholderOffset()),C=new primitives.common.Rect(i.getContentSize()),J=d.getOptimalPanelSize();E.scale(1/H);J.scale(1/H);C.scale(1/H);H=new primitives.common.Rect(E.x,E.y,Math.min(J.width,C.width),Math.min(J.height,C.height));if(D.actualVisibility>=v.calloutMaximumVisibility&&4!=D.actualVisibility||!H.overlaps(s)){y=!primitives.common.isNullOrEmpty(b.calloutTemplateName)?b.calloutTemplateName:!primitives.common.isNullOrEmpty(b.templateName)?
b.templateName:!primitives.common.isNullOrEmpty(v.defaultCalloutTemplateName)?v.defaultCalloutTemplateName:v.defaultTemplateName;F=h.getTemplate(y,h.DefaultWidgetTemplateName);s=F.templateConfig.itemSize;E=new primitives.common.Rect(g.x,g.y,s.width,s.height);switch(v.orientationType){case 0:case 1:E.y-=s.height/4;E.x=g.x<H.horizontalCenter()?E.x+v.calloutPlacementOffset:E.x-(v.calloutPlacementOffset+s.width);break;default:E.x-=s.width/4,E.y=g.y<H.verticalCenter()?E.y+v.calloutPlacementOffset:E.y-
(v.calloutPlacementOffset+s.height)}E.x<H.x?E.x=H.x+5:E.right()>H.right()&&(E.x-=E.right()-H.right()+5);E.y<H.y?E.y=H.y+5:E.bottom()>H.bottom()&&(E.y-=E.bottom()-H.bottom()+5);k=E;c=new primitives.common.Rect(k);c.addRect(g.x,g.y);c.offset(50);B=c.getCSS();B.display="inherit";B.visibility="inherit";primitives.common.JsonML.applyStyles(u.calloutPlaceholder,B);g.x-=c.x;g.y-=c.y;k.x-=c.x;k.y-=c.y;n=new primitives.common.RenderEventArgs;n.context=f.getConfig(a);n.isCursor=m.getCursorTreeItem()==a;n.isSelected=
l.isSelected(a);n.templateName=F.templateConfig.name;q.resize("calloutplaceholder",c.width,c.height);q.activate("calloutplaceholder",15);q.template(k.x,k.y,k.width,k.height,0,0,k.width,k.height,F.itemTemplate.template(),F.itemTemplate.getHashCode(),F.itemTemplate.render,n,null);r.pointerPlacement=0;r.cornerRadius=v.calloutCornerRadius;r.offset=v.calloutOffset;r.opacity=v.calloutOpacity;r.lineWidth=v.calloutLineWidth;r.pointerWidth=v.calloutPointerWidth;r.borderColor=v.calloutBorderColor;r.fillColor=
v.calloutfillColor;r.draw(g,k)}else p()})):p();break;case 4:p()}}function p(){primitives.common.JsonML.applyStyles(u.calloutPlaceholder,{display:"none",visibility:"hidden"})}var q,s,r=new primitives.common.Callout(b()),v,u;return{process:function(){var d=k.getHighlightTreeItem();q=b();q.reset("calloutplaceholder",15);null!==d&&(s=c.getTransform(),v=g.getOptions(),u=a(),n(d));return!1}}};
primitives.orgdiagram.DrawHighlightPathAnnotationTask=function(a,b,c,d,e){function f(a,b,d,c){var f,m,l,n,p,q,s,r,v,u,x,w,z;if(0<d.length){x=new primitives.common.PolylinesBuffer;switch(e){case 1:a.activate("placeholder",5);break;case 2:a.activate("placeholder",7)}var t={};f=0;for(m=d.length;f<m;f+=1)if(u=d[f],null!=u.items&&0<u.items.length&&(r=u.items.slice(0),p=r[0],c.hasNode(p))){l=1;for(n=r.length;l<n;l+=1)q=r[l],c.hasNode(q)&&(t.hasOwnProperty(p)?t[p].push(q):t[p]=[q],p=q)}var A={};for(w in t)A[w]=
{},t.hasOwnProperty(w)&&c.getShortestPath(this,w,t[w],function(a){return a.weight},function(a,b){A[w][b]=a});f=0;for(m=d.length;f<m;f+=1)if(u=d[f],l=new primitives.common.PaletteItem({lineColor:null!=u.color?u.color:b.highlightLinesColor,lineWidth:null!=u.lineWidth?u.lineWidth:b.highlightLinesWidth,lineType:null!=u.lineType?u.lineType:b.highlightLinesType,fillColor:null,opacity:u.opacity}),t=x.getPolyline(l),null!=u.items&&0<u.items.length&&(r=u.items.slice(0),p=r[0],c.hasNode(p))){l=1;for(n=r.length;l<
n;l+=1)if(q=r[l],c.hasNode(q)){s=A[p][q]||[];for(p=s.length-2;0<=p;p-=1)w=s[p+1],z=s[p],v=c.edge(w,z),v.from==w?v.polyline.clone().mergeTo(t):t.addInverted(v.polyline.clone()),u.showArrows&&(z==v.parentsArrowId||z==v.childrenArrowId)&&t.addArrow(u.lineWidth,function(a){a.mergeTo(x.getPolyline(a.paletteItem))});p=q}}a.polylinesBuffer(x)}}return{process:function(){var g=d.getGraph(),h=b.getOptions(),i=c.getAnnotations(),j=a();switch(e){case 1:j.reset("placeholder",5);break;case 2:j.reset("placeholder",
7)}f(j,h,i,g);return!1}}};
primitives.orgdiagram.DrawHighlightTask=function(a,b,c,d,e,f,g,h,i){function j(a){var b;k.activate("placeholder",8);var c=e.getItemPosition(a),g=c.actualPosition,j=f.getTemplateParams(a).template,r=j.templateConfig,v=r.highlightPadding;b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=h.getCursorTreeItem()==a;b.isSelected=i.isSelected(a);b.templateName=r.name;m.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,d,e,g){var f=new primitives.common.Rect(0,0,Math.round(e),
Math.round(g));f.offset(v.left,v.top,v.right,v.bottom);1==c.actualVisibility?k.template(a,d,e,g,f.x,f.y,f.width,f.height,j.highlightTemplate.template(),j.highlightTemplate.getHashCode(),j.highlightTemplate.render,b,null):k.template(a,d,e,g,f.x,f.y,f.width-1,f.height-1,j.dotHighlightTemplate.template(),j.dotHighlightTemplate.getHashCode(),j.dotHighlightTemplate.render,b,null)})}var k,m;return{process:function(){var d=g.getHighlightTreeItem();k=a();k.reset("placeholder",8);null!=d&&(m=b.getTransform(),
j(d));return!1}}};
primitives.orgdiagram.DrawItemLabelsTask=function(a,b,c,d,e){function f(a,b){var d=[];if(0==b.showLabels||1==b.showLabels)for(var c in a.treeItemsPositions)if(a.treeItemsPositions.hasOwnProperty(c)){var e=b.itemsOptions[c],f=a.treeItemsPositions[c],l=f.actualPosition;null!=e&&a.transform.transformRect(l.x,l.y,l.width,l.height,!0,this,function(a,c,g,j){var l;switch(f.actualVisibility){case 1:0==b.showLabels&&(n=new primitives.common.Label(a,c,g,j),n.weight=1E4,n.labelType=1,d.push(n));break;case 2:case 3:var n;
n=e;var p=f,z=null,t,A,y,F;if(!primitives.common.isNullOrEmpty(n.label)){var C;C=3;switch(n.showLabel){case 0:switch(b.showLabels){case 0:switch(p.actualVisibility){case 3:case 2:C=0}break;case 1:C=2}break;case 1:C=2}switch(C){case 0:F=p.leftPadding+p.rightPadding;break;case 2:F=1E4;break;case 3:F=0}if(3!=C){y=null!=n.labelSize?n.labelSize:b.labelSize;p=3!=n.labelOrientation?n.labelOrientation:3!=b.labelOrientation?b.labelOrientation:0;z=0!=n.labelPlacement?n.labelPlacement:0!=b.labelPlacement?b.labelPlacement:
1;switch(p){case 0:t=y.width;A=y.height;break;case 1:case 2:A=y.width,t=y.height}y=b.labelOffset;var B,D;switch(z){case 0:case 1:B=new primitives.common.Rect(a+g/2-t/2,c-y-A,t,A);switch(p){case 0:D=0;l=2;break;case 1:l=D=1;break;case 2:D=2,l=1}break;case 2:case 11:B=new primitives.common.Rect(a+g+y,c-y-A,t,A);switch(p){case 0:D=1;l=2;break;case 1:D=1;l=0;break;case 2:l=D=2}break;case 3:B=new primitives.common.Rect(a+g+y,c+j/2-A/2,t,A);switch(p){case 0:l=D=1;break;case 1:l=D=0;break;case 2:D=0,l=2}break;
case 4:case 12:B=new primitives.common.Rect(a+g+y,c+j+y,t,A);switch(p){case 0:D=1;l=0;break;case 1:D=2;l=0;break;case 2:D=1,l=2}break;case 5:B=new primitives.common.Rect(a+g/2-t/2,c+j+y,t,A);switch(p){case 0:l=D=0;break;case 1:D=2;l=1;break;case 2:l=D=1}break;case 6:case 10:B=new primitives.common.Rect(a-t-y,c+j+y,t,A);switch(p){case 0:D=2;l=0;break;case 1:l=D=2;break;case 2:D=1,l=0}break;case 7:B=new primitives.common.Rect(a-t-y,c+j/2-A/2,t,A);switch(p){case 0:D=2;l=1;break;case 1:D=0;l=2;break;
case 2:l=D=0}break;case 8:case 9:switch(B=new primitives.common.Rect(a-t-y,c-y-A,t,A),p){case 0:l=D=2;break;case 1:D=1;l=2;break;case 2:D=2,l=0}}a=D;z=new primitives.common.Label(B);z.labelType=C;z.weight=F;z.text=n.label;z.labelOrientation=p;z.horizontalAlignmentType=a;z.verticalAlignmentType=l}}n=z;null!=n&&d.push(n)}})}0==b.showLabels&&primitives.common.getCrossingRectangles(this,d,function(a,b){if(a.isActive&&b.isActive)switch(a.labelType){case 1:switch(b.labelType){case 0:b.isActive=!1;break;
case 2:b.isActive=!1}break;case 2:switch(b.labelType){case 1:a.isActive=!1;break;case 0:b.isActive=!1}break;case 0:switch(b.labelType){case 1:a.isActive=!1;break;case 0:a.weight<=b.weight?a.isActive=!1:b.isActive=!1;break;case 2:a.isActive=!1}}});a.graphics.activate("placeholder",10);c={fontSize:b.labelFontSize,fontFamily:b.labelFontFamily,fontStyle:b.labelFontStyle,fontWeight:b.labelFontWeight,fontColor:b.labelColor};for(var l=0,n=d.length;l<n;l+=1){var p=d[l];if(p.isActive)switch(p.labelType){case 0:case 2:a.graphics.text(p.x,
p.y,p.width,p.height,p.text,p.labelOrientation,p.horizontalAlignmentType,p.verticalAlignmentType,c)}}}return{process:function(){var c=d.getOptions(),h={graphics:a(),transform:b.getTransform(),treeItemsPositions:e.getItemsPositions()},c={showLabels:c.showLabels,labelFontSize:c.labelFontSize,labelFontFamily:c.labelFontFamily,labelFontStyle:c.labelFontStyle,labelFontWeight:c.labelFontWeight,labelColor:c.labelColor,itemsOptions:d.getItemsOptions(),labelSize:c.labelSize,labelOrientation:c.labelOrientation,
labelPlacement:c.labelPlacement,labelOffset:c.labelOffset};h.graphics.reset("placeholder",10);f(h,c);return!1}}};
primitives.orgdiagram.DrawMinimizedItemsTask=function(a,b,c,d,e,f){function g(){var a=new primitives.common.PolylinesBuffer,b={},c,g=new primitives.common.Marker,f,r,v,u,x,w,z,t,A,y;for(y in m)m.hasOwnProperty(y)&&(x=m[y],w=x.actualPosition,z=d.getItemOptions(y),i.transformRect(w.x,w.y,w.width,w.height,!0,this,function(d,h,m,i){switch(x.actualVisibility){case 2:t=e.getTemplateParams(y);A=t.template.templateConfig;v=r=f=null;u=0;null!=z&&(r=f=z.itemTitleColor,v=z.minimizedItemShapeType);f=f||A.minimizedItemBorderColor||
"#000080";r=r||A.minimizedItemFillColor||"#000080";null==v&&(v=null!==A.minimizedItemShapeType?A.minimizedItemShapeType:k.minimizedItemShapeType);u=null===A.minimizedItemCornerRadius?A.minimizedItemSize.width/2:A.minimizedItemCornerRadius;null==v||6==v?(c=a.getPolyline(new primitives.common.PaletteItem({lineColor:f,lineWidth:A.minimizedItemLineWidth,lineType:A.minimizedItemLineType,fillColor:r,opacity:A.minimizedItemOpacity})),c.addSegment(new primitives.common.DotSegment(d,h,m,i,u))):g.draw(a,v,
new primitives.common.Rect(d,h,m,i),new primitives.common.PaletteItem({lineColor:f,lineWidth:A.minimizedItemLineWidth,lineType:A.minimizedItemLineType,fillColor:r,opacity:A.minimizedItemOpacity}));break;default:j&&(f="#ff0000",b.hasOwnProperty(f)||(b[f]=new primitives.common.PaletteItem({lineColor:f,lineWidth:1,lineType:0,fillColor:f,opacity:1})),c=a.getPolyline(b[f]),c.addSegment(new primitives.common.DotSegment(d-1,h-1,2,2,1)))}}));h.activate("placeholder",9);h.polylinesBuffer(a)}var h,i,j=!1,k,
m;return{process:function(){h=a();i=b.getTransform();k=d.getOptions();m=f.getItemsPositions();h.reset("placeholder",9);g();return!1}}};
primitives.orgdiagram.DrawShapeAnnotationTask=function(a,b,c,d,e,f,g,h){function i(a,b){var d,c,e,g,f,i,w,z,t,A,y,F;switch(h){case 1:d=j.activate("placeholder",3);break;case 2:d=j.activate("placeholder",13)}c=0;for(e=a.length;c<e;c+=1)if(y=a[c],null!=y.items&&0<y.items.length){z=new primitives.common.Rect;g=0;for(f=y.items.length;g<f;g+=1)w=b(y.items[g]),null!=w&&z.addRect(w.actualPosition);if(!z.isEmpty()){i=new primitives.common.Shape(j);w=new primitives.orgdiagram.ShapeAnnotationConfig;t="opacity cornerRadius shapeType offset lineWidth borderColor fillColor lineType labelSize labelOffset labelPlacement zOrderType".split(" ");
g=0;for(f=t.length;g<f;g+=1)A=t[g],i[A]=y.hasOwnProperty(A)?y[A]:w[A];i.position=z;i.orientationType=m.orientationType;i.panelSize=d.size;i.labelTemplate=l;i.hasLabel=null!=y.templateName||null!=y.label;F=new primitives.common.RenderEventArgs;F.context=y;F.templateName=i.labelTemplate;k.transformRect(z.x,z.y,z.width,z.height,!0,this,function(a,b,d,c){a=new primitives.common.Rect(a,b,d,c);i.draw(a,F)})}}}var j,k,m,l;return{process:function(){j=a();k=b.getTransform();m=d.getOptions();l=g.getTemplate();
switch(h){case 1:j.reset("placeholder",3);break;case 2:j.reset("placeholder",13)}i(e.getAnnotations(),f.getItemPosition);return!1}}};
primitives.orgdiagram.DrawTreeItemsTask=function(a,b,c,d,e,f,g,h,i,j,k,m){function l(){var a,b=h.getCursorTreeItem(),d,c,f;for(f in n)n.hasOwnProperty(f)&&(d=n[f],c=d.actualPosition,1==d.actualVisibility&&q.transformRect(c.x,c.y,c.width,c.height,!0,this,function(c,h,k,j){var m=g.getTemplateParams(f),l=m.template;a=new primitives.common.RenderEventArgs;a.id=f;a.context=e.getConfig(f);a.isCursor=f==b;a.isSelected=i.isSelected(f);a.templateName=l.templateConfig.name;p.activate("placeholder",12);p.template(c,
h,k,j,d.contentPosition.x,d.contentPosition.y,d.contentPosition.width,d.contentPosition.height,l.itemTemplate.template(),l.itemTemplate.getHashCode(),l.itemTemplate.render,a,{borderWidth:l.templateConfig.itemBorderWidth});if(m.hasGroupTitle){var n=0;switch(s.groupTitlePlacementType){case 2:case 0:n=2;break;case 3:n=k-(s.groupTitlePanelSize-4)}p.template(c,h,k,j,n,d.contentPosition.y,s.groupTitlePanelSize-4,d.contentPosition.height+2,u.template(),u.getHashCode(),u.render,a,null)}m.hasSelectorCheckbox&&
(p.activate("placeholder",16),p.template(c,h,k,j,d.contentPosition.x,j-(s.checkBoxPanelSize-4),d.contentPosition.width,s.checkBoxPanelSize-4,v.template(),v.getHashCode(),v.render,a,null));if(m.hasButtons){p.activate("placeholder",16);n=0;switch(s.groupTitlePlacementType){case 2:case 0:n=k-(s.buttonsPanelSize-4);break;case 3:n=2}p.template(c,h,k,j,n,d.contentPosition.y,s.buttonsPanelSize-4,Math.max(d.contentPosition.height,j-d.contentPosition.y),r.template(),l.templateConfig.name+r.getHashCode(),r.render,
m,null)}}))}var n,p,q,s,r,v,u;return{process:function(){p=a();s=d.getOptions();n=f.getItemsPositions();q=b.getTransform();r=m.getTemplate();v=k.getTemplate();u=j.getTemplate();p.reset("placeholder",12);p.reset("placeholder",16);l();return!1}}};
primitives.orgdiagram.ActiveItemsTask=function(a,b){function c(a,d){var c=[],e,f;e=0;for(f=d.length;e<f;e+=1){var m=d[e],l=b.getTemplate(m.templateName,a.defaultTemplateName,b.DefaultWidgetTemplateName).templateConfig;m.isActive&&l.isActive&&c.push(m.id)}return c}var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var b={isChanged:!1,hash:e},h=a.getOptions();d=f.read(d,c(h,h.items),"items",b);return b.isChanged},
getActiveItems:function(){return e.items}}};primitives.orgdiagram.AnnotationLabelTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.AnnotationLabelTemplate);return a}}};primitives.orgdiagram.ButtonsTemplateTask=function(a,b){var c=null;return{process:function(){return!1},getTemplate:function(){null==c&&(c=new b.ButtonsTemplate);return c}}};
primitives.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};primitives.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.GroupTitleTemplate(c));return b}}};
primitives.orgdiagram.ItemTemplateParamsTask=function(a,b,c){function d(a,b,d){var c=!1;switch(b){case 0:switch(d){case 0:c=a;break;case 1:c=!0;break;case 2:c=!1}break;case 1:c=!0;break;case 2:c=!1}return c}var e={};return{process:function(){var f=a.getOptions(),g=0<f.buttons.length,h=b.getCursorItem(),i=f.items,j,k;e={};j=0;for(k=i.length;j<k;j+=1){var m=i[j],l=new primitives.orgdiagram.TemplateParams,n=h==m.id,p=c.getTemplate(m.templateName,f.defaultTemplateName,c.DefaultWidgetTemplateName),q=p.templateConfig,
s=null!=q.buttons&&0<q.buttons.length;l.template=p;l.isActive=m.isActive&&q.isActive;l.isActive&&(l.hasSelectorCheckbox=d(n,m.hasSelectorCheckbox,f.hasSelectorCheckbox),l.hasButtons=(g||s)&&d(n,m.hasButtons,f.hasButtons),l.hasButtons&&(l.buttons=s?q.buttons:f.buttons));l.hasGroupTitle=!primitives.common.isNullOrEmpty(m.groupTitle);e[m.id]=l}return!0},getTemplateParams:function(a){return e[a]}}};
primitives.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,e,f=a.getOptions(),g=f.templates;b={};b.DefaultWidgetTemplate=new primitives.orgdiagram.Template(f,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.orgdiagram.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.common.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(f,c);b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)e=g[c],b[e.name]=new primitives.orgdiagram.Template(f,e);return!0},getTemplate:function(a,d,e){return b[a]||b[d]||b[e]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.orgdiagram.CombinedNormalVisibilityItemsTask=function(a,b,c,d,e,f,g,h,i,j,k,m){function l(a){var b=[],d,c,e,g,f,h,k={};d=0;for(c=a.length;d<c;d+=1){e=a[d];f=e.getItems();e=0;for(g=f.length;e<g;e+=1)h=f[e],k.hasOwnProperty(h)||(b.push(h),k[h]=!0)}return b}var n=[],p={},q=[b,c,d,e,f,g,h,i,j,k,m],s=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var b={isChanged:!1,hash:p},d=a.getOptions();n=s.read(n,l(q),"items",b);
if(0==d.pageFitMode||1==d.minimalVisibility)b.isChanged=!1;return b.isChanged},isItemSelected:function(a){return p.items.hasOwnProperty(a)}}};primitives.orgdiagram.CursorItemTask=function(a,b){var c=null;return{process:function(){var d=a.getCursorItem(),e=null!=b?b.getActiveItems():{};c=null!=d&&e.hasOwnProperty(d)?d:null;return!0},getCursorTreeItem:function(){return c},getItems:function(){return null!=c?[c]:[]}}};
primitives.orgdiagram.CursorNeighboursTask=function(a,b){function c(a,b){var d=[];null!==a&&b.loopNeighbours(this,a,function(a,b){0===b.visibility&&d.push(a);return!0});return d}var d=[];return{process:function(){var e=b.getNavigationFamily(),f=a.getCursorTreeItem();d=c(f,e);return!0},getItems:function(){return d}}};
primitives.orgdiagram.HighlightItemTask=function(a,b){var c=null;return{process:function(){var d=a.getHighlightItem(),e=null!=b?b.getActiveItems():{};c=null!=d&&e.hasOwnProperty(d)?d:null;return!0},getHighlightTreeItem:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask=function(a){function b(a){var b=[],d={},c,e,k,m,l,n;c=0;for(e=a.length;c<e;c+=1)if(k=a[c],k.selectItems){l=k.items;k=0;for(m=l.length;k<m;k+=1)n=l[k],null!=n&&!d.hasOwnProperty(n)&&(b.push(n),d[n]=!0)}return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},g=a.getAnnotations();c=e.read(c,b(g),"items",f);return f.isChanged},
getItems:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask=function(a){function b(a){var b=[],d={},c,e,k;c=0;for(e=a.length;c<e;c+=1)k=a[c],k.selectItems&&(null!=k.fromItem&&!d.hasOwnProperty(k.fromItem)&&(b.push(k.fromItem),d[k.fromItem]=!0),null!=k.toItem&&!d.hasOwnProperty(k.toItem)&&(b.push(k.toItem),d[k.toItem]=!0));return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},
g=a.getAnnotations();c=e.read(c,b(g),"items",f);return f.isChanged},getItems:function(){return c}}};
primitives.orgdiagram.SelectedItemsTask=function(a){function b(a){var b=[],d={},c,e,k;c=0;for(e=a.length;c<e;c+=1)k=a[c],null!=k&&!d.hasOwnProperty(k)&&(b.push(k),d[k]=!0);return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},g=a.getSelectedItems();c=e.read(c,b(g),"items",f);return f.isChanged},getItems:function(){return c},isSelected:function(a){return d.items.hasOwnProperty(a)}}};
primitives.orgdiagram.SelectionPathItemsTask=function(a,b,c,d){function e(a,b,d){var c=[],e={},f,l,n;l=0;for(n=a.length;l<n;l+=1)switch(f=a[l],d){case 1:b.loopParents(this,f,function(a,d){if(null!=e[a])return b.SKIP;4!=d.visibility&&c.push(a);e[a]=!0})}return c}var f=[];return{process:function(){var g=d.getSelectionPathMode(),h=a.getNavigationFamily(),i=b.getCursorTreeItem(),j=c.getItems().slice(0);j.push(i);f=e(j,h,g);return!0},getItems:function(){return f}}};
primitives.orgdiagram.CombinedContextsTask=function(a,b){return{process:function(){return!0},getConfig:function(c){return a.getConfig(c)||null!=b&&b.getConfig(c)}}};
primitives.orgdiagram.ConnectionsGraphTask=function(a,b,c,d,e){var f={graph:null,nodeid:0};return{process:function(){for(var g=a().activate("placeholder",6),h=d.getBundles(),i=d.getNestedLayoutBottomConnectorIds(),j=c.getOptions(),k={graph:primitives.common.graph(),nodeid:0},g={treeItemsPositions:e.getItemsPositions(),nestedLayoutBottomConnectorIds:i,transform:b.getTransform(),hasGraphics:g.hasGraphics},j={connectorType:j.connectorType,showExtraArrows:j.showExtraArrows,bevelSize:j.bevelSize,elbowType:j.elbowType},
i=0,m=h.length;i<m;i+=1)h[i].trace(k,g,j);f=k;return!0},getGraph:function(){return f.graph}}};
primitives.orgdiagram.ItemsPositionsTask=function(a,b,c,d,e,f,g,h,i,j,k){var m,l;function n(a){var b=new primitives.common.Rect(0,0,0,0),d,c,e,g,f;switch(G.orientationType){case 2:case 3:a.invert()}if(!F.isEmpty())switch(E.pageFitMode){case 0:case 5:d=[new primitives.orgdiagram.LevelVisibility(0,1)];b=p(d,0);break;default:d=[new primitives.orgdiagram.LevelVisibility(0,1)];c=[];switch(E.minimalVisibility){case 2:c.push(2);break;case 0:case 3:case 4:c.push(2),c.push(3)}F.loopLevelsReversed(this,function(a){var b;
for(b=0;b<c.length;b+=1)d.push(new primitives.orgdiagram.LevelVisibility(a,c[b]))});e=p(d,d.length-1);e.addRect(a);e.offset(0,0,5,5);f=g=a=null;b=p(d,0);if(!q(b,e)&&(a=0,b=p(d,d.length-1),q(b,e))){for(f=g=d.length-1;1<g-a;)f=Math.floor((g+a)/2),b=p(d,f),q(b,e)?g=f:a=f;g!==f&&(b=p(d,g))}}return b}function p(a,b){var d,c;C=[];F.loopLevels(this,function(){var a=new primitives.orgdiagram.TreeLevelPosition;a.currentvisibility=1;C.push(a)});for(d=0;d<=b;d+=1)c=a[d],C[c.level].currentvisibility=c.currentvisibility;
v();w();u();d=E.lineLevelShift;var e,g,f,k,m=c=0;e=8*I.linesWidth;switch(I.arrowsDirection){case 1:c=e;m=0;break;case 2:c=0,m=e}e=0;for(g=C.length;e<g;e+=1)f=C[e],k=h.getConnectorsStacksSizes(e),d+=f.setShift(d,x(f.actualVisibility),m,c,k.parentsStackSize);return new primitives.common.Rect(0,0,Math.round(r()),Math.round(s()))}function q(a,b){var d=!1;switch(E.pageFitMode){case 1:b.width>=a.width&&(d=!0);break;case 2:b.height>=a.height&&(d=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(d=
!0)}return d}function s(){var a=C[C.length-1];return a.shift+a.nextLevelShift}function r(){var a=0,b,d;b=0;for(d=C.length;b<d;b+=1)a=Math.max(a,C[b].currentOffset);return a+=E.normalItemsInterval}function v(){var a=j.getCursorTreeItem();m={};F.loopLevels(this,function(b){var d=C[b];F.loopLevelItems(this,b,function(b,c){var e=new primitives.orgdiagram.TreeItemPosition,g=k.isItemSelected(b)?1:c.visibility,f=i.getTemplateParams(b),g=0===g?d.currentvisibility:g,h=a==b,j=E,l=G.orientationType,n,p,q;switch(g){case 1:n=
f.template.templateConfig;p=new primitives.common.Size(n.itemSize);q=new primitives.common.Rect(0,0,p.width,p.height);h&&(p.height+=n.cursorPadding.top+n.cursorPadding.bottom,p.width+=n.cursorPadding.left+n.cursorPadding.right,q.x=n.cursorPadding.left,q.y=n.cursorPadding.top);f.hasSelectorCheckbox&&(p.height+=j.checkBoxPanelSize);if(f.hasButtons)switch(p.width+=j.buttonsPanelSize,j.groupTitlePlacementType){case 3:q.x+=j.buttonsPanelSize}if(f.hasGroupTitle)switch(p.width+=j.groupTitlePanelSize,j.groupTitlePlacementType){case 3:break;
default:q.x+=j.groupTitlePanelSize}break;case 2:n=f.template.templateConfig;p=new primitives.common.Size(n.minimizedItemSize);break;case 3:case 4:p=new primitives.common.Size}switch(l){case 2:case 3:p.invert()}e.actualVisibility=g;e.actualSize=p;e.contentPosition=q;m[b]=e})})}function u(){var a,b;F.loopLevels(this,function(d){var c=C[d];c.shift=0;c.depth=0;c.actualVisibility=4;b=a=null;F.loopLevelItems(this,d,function(d){d=m[d];c.depth=Math.max(c.depth,d.actualSize.height);switch(d.actualVisibility){case 2:case 3:case 4:b=
!b?d.actualSize.height:Math.min(b,d.actualSize.height);break;default:a=!a?d.actualSize.height:Math.min(a,d.actualSize.height)}c.actualVisibility=Math.min(c.actualVisibility,d.actualVisibility)});null==a&&(a=c.depth);null!=b&&b>a&&(a=b);switch(E.verticalAlignment){case 0:c.horizontalConnectorsDepth=a/2;break;case 1:c.horizontalConnectorsDepth=c.depth/2;break;case 2:c.horizontalConnectorsDepth=c.depth-a/2}})}function x(a){var b=0;switch(a){case 1:b=E.normalLevelShift;break;case 2:b=E.dotLevelShift;
break;case 3:case 4:b=E.lineLevelShift}return b}function w(){var a,b;a=0;for(b=C.length;a<b;a+=1)C[a].currentOffset=0;B.loopPostOrder(this,function(a,b){var d=m[a],c=d.actualVisibility,e=F.getLevelIndex(a),e=C[e],c=J[0===c?e.currentvisibility:c]/2,g,f,k,h,j,i,l,n;g=8*I.linesWidth;d.leftPadding=c+(0<e.currentOffset?c*b.relationDegree*E.cousinsIntervalMultiplier:0);d.rightPadding=c;0!=I.arrowsDirection&&(b.connectorPlacement&8&&(d.leftPadding+=g),b.connectorPlacement&2&&(d.rightPadding+=g));d.offset=
e.currentOffset+d.leftPadding;e.currentOffset=d.offset+d.actualSize.width+d.rightPadding;if(B.hasChildren(a))if(d=z(b),0<d)A(b,d);else if(0>d&&(d=-d,t(b,d),f=null,k={},j=null,e=B.parent(b.id),null!==e&&(B.loopChildrenReversed(this,e.id,function(a,d){if(d===b)f=[];else if(null!==f){var c=null,e=[],g,i,l,n;g=H[d.id];void 0===g&&(g=[]);g=g.slice();g.splice(0,0,d.id);i=0;for(l=g.length;i<l;i+=1)n=m[g[i]],e[i]=n.offset+n.actualSize.width+n.rightPadding;g=[];var p;i=D[b.id];void 0===i&&(i=[]);i=i.slice();
i.splice(0,0,b.id);l=0;for(n=i.length;l<n;l+=1)p=m[i[l]],g[l]=p.offset-p.leftPadding;i=Math.min(e.length,g.length);for(l=0;l<i&&!(n=g[l]-e[l],c=null!==c?Math.min(c,n):n,0>=n);l+=1);h=Math.floor(c);k[d.id]=h;if(0<h)f.splice(0,0,d);else return j=d,!0}}),0<f.length))){c=null;if(null!==j){i=[j];i=i.concat(f);i.push(b);c=[[j]];e=1;for(g=i.length;e<g;e+=1)l=i[e-1],n=i[e],2==l.gravity||1==n.gravity?c[c.length-1].push(n):c.push([n])}else c=[f.slice(0)],c[c.length-1].push(b);if(0<c.length){f=c[c.length-1];
for(e=f.length-2;0<=e;e-=1)n=f[e],h=k[n.id],d=Math.min(h,d),t(n,d),A(n,d)}i=d/(c.length-1);for(g=c.length-2;0<g;g-=1){l=c[g];for(e=l.length-1;0<=e;e-=1)n=l[e],h=k[n.id],d=Math.min(g*i,Math.min(h,d)),t(n,d),A(n,d)}}})}function z(a){var b=m[a.id],b=b.offset+b.actualSize.width/2,d=null,c,e,g;if(null===a.visualAggregatorId)switch(c=null,B.loopChildren(this,a.id,function(a,b){c=b;if(c.connectorPlacement&1)return!0}),e=m[c.id],g=null,B.loopChildrenReversed(this,a.id,function(a,b){g=b;if(g.connectorPlacement&
1)return!0}),a=m[g.id],K.horizontalAlignment){case 1:d=e.offset+e.actualSize.width/2;break;case 2:d=a.offset+a.actualSize.width/2;break;case 0:d=(e.offset+a.offset+a.actualSize.width)/2}else a=m[a.visualAggregatorId],d=a.offset+a.actualSize.width/2;return b-d}function t(a,b){var d=m[a.id];d.offset+=b;var c=C[F.getLevelIndex(a.id)];c.currentOffset=Math.max(c.currentOffset,d.offset+d.actualSize.width+d.rightPadding)}function A(a,b){var d,c;B.loopLevels(this,a.id,function(a){d=m[a];d.offset+=b;c=C[F.getLevelIndex(a)];
c.currentOffset=Math.max(c.currentOffset,d.offset+d.actualSize.width);return!0})}function y(){var a=null;F.loopLevels(this,function(b){var d=C[b];F.loopLevelItems(this,b,function(b){var c,e,g,f,h,k,b=m[b];c=b.actualSize;f=a;e=0;switch(b.actualVisibility){case 1:switch(E.verticalAlignment){case 0:e=0;break;case 1:e=(d.depth-c.height)/2;break;case 2:e=d.depth-c.height}break;case 2:case 3:case 4:e=d.horizontalConnectorsDepth-c.height/2}c=new primitives.common.Rect(b.offset,d.shift+e,c.width,c.height);
e=d.shift+d.horizontalConnectorsDepth;g=null!=f?f.shift+f.connectorShift:null;f=null!=f?f.levelSpace/2:null;h=d.shift+d.connectorShift;k=d.levelSpace/2;b.actualPosition=c;b.horizontalConnectorsShift=e;b.topConnectorShift=g;b.topConnectorInterval=f;b.bottomConnectorShift=h;b.bottomConnectorInterval=k});a=d})}m={};l=null;var F,C,B,D,H,G,I,K,E,O,J;return{process:function(){var k;k=E=d.getOptions();var j=[];j[1]=k.normalItemsInterval;j[2]=k.dotItemsInterval;j[3]=k.lineItemsInterval;j[4]=k.lineItemsInterval;
J=j;G=c.getOptions();I=e.getOptions();K=f.getOptions();F=h.getTreeLevels();B=g.getVisualTree();D=g.getLeftMargins();H=g.getRightMargins();C=[];m={};k=a.getOptimalPanelSize();O=b.getOptions();k.scale(1/O.scale);k=new primitives.common.Rect(0,0,k.width,k.height);l=n(k);y();return!0},getItemsPositions:function(){return m},getItemPosition:function(a){return m[a]},getContentSize:function(){return l}}};
primitives.orgdiagram.OrgTreeTask=function(a){var b,c;function d(a){var d,h,i,j,k,m=0,l,n=primitives.common.tree();j=0;for(k=a.length;j<k;j+=1)i=a[j],null!=i.id&&(d=new primitives.orgdiagram.OrgItem(i),l=parseInt(i.id,10),m=Math.max(isNaN(l)?0:l,m),n.add(i.parent,d.id,d));m+=1;a=new primitives.orgdiagram.ItemConfig;a.id=m;a.title="internal root";a.isVisible=!1;a.isActive=!1;h=new primitives.orgdiagram.OrgItem(a);h.hideParentConnection=!0;h.hideChildrenConnection=!0;n.add(null,h.id,h);n.loopLevels(this,
function(a,b,d){if(0<d)return n.BREAK;h.id!=a&&(n.adopt(h.id,a),b.itemType=0)});e(n);b=n;c=m;return!0}function e(a){a.loopLevels(this,function(b,d){var c=!0;if(d.isVisible)return a.SKIP;a.loopChildren(this,b,function(a,b){if(0!=b.itemType)return c=!1,!0});if(c)d.hideChildrenConnection=!0,a.loopChildren(this,b,function(a,b){b.hideParentConnection=!0});else return a.SKIP})}c=b=null;return{process:function(){d(a.getItems());return!0},getOrgTree:function(){return b},getMaximumId:function(){return c}}};
primitives.orgdiagram.PaletteManagerTask=function(a,b){var c;return{process:function(){var d=[];null!=b&&(d=b.getOptions().linesPalette);c=new primitives.common.PaletteManager(a.getOptions(),d);return!0},getPaletteManager:function(){return c}}};
primitives.orgdiagram.VisualTreeLevelsTask=function(a){function b(a,b,d,c){var e,f,l,n,p,q,s,r={},v,u,x;d.loopLevels(this,function(w){var z=new primitives.orgdiagram.TreeLevelConnectorStackSize;b[w]=z;s=[];d.loopLevelItems(this,w,function(b,e){var f=[];if(!r.hasOwnProperty(b)&&(e.connectorPlacement&4&&f.push(b),f=f.concat(e.partners),0<f.length)){q=new primitives.common.VerticalConnectorBundle(f,[]);for(var k=0,h=f.length;k<h;k+=1)r[f[k]]=q;c.loopChildren(this,b,function(a,b){b.connectorPlacement&
1&&q.toItems.push(a)});1<f.length&&s.push(q);(1<q.fromItems.length||0<q.toItems.length)&&a.push(q)}e.connectorPlacement&8&&(q=new primitives.common.HorizontalConnectorBundle(b,d.getPrevItem(b)),a.push(q));e.connectorPlacement&2&&(q=new primitives.common.HorizontalConnectorBundle(b,d.getNextItem(b)),a.push(q))});if(0<s.length){x=primitives.common.pile();e=0;for(f=s.length;e<f;e+=1){q=s[e];u=v=null;l=0;for(n=q.fromItems.length;l<n;l+=1)p=d.getItemPosition(q.fromItems[l]),v=null!=v?Math.min(v,p):p,u=
null!=u?Math.max(u,p):p;x.add(v,u,q)}z.parentsStackSize=x.resolve(this,function(a,b,d,c,e){d.fromOffset=c+1;d.fromStackSize=e})}})}var c=null,d=null,e=null,f=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var g=a.getVisualTree();c=primitives.common.TreeLevels();g.loopLevels(this,function(a,b,d){c.addItem(d,a,b)});d=[];e=[];b(d,e,c,g);return!0},getTreeLevels:function(){return c},getBundles:function(){return d},getConnectorsStacksSizes:function(a){return e[a]||f},getNestedLayoutBottomConnectorIds:function(){return{}}}};
primitives.orgdiagram.VisualTreeTask=function(a,b,c,d){function e(a,b,c){var e,g,s,v,u,B,D,H,G,I,K,E,O={},J,U={},L,R,S,V={},T;a.loopPostOrder(this,function(a,b,d,c){b.hasVisibleChildren=b.isVisible||b.hasVisibleChildren;null!=c&&(c.hasVisibleChildren=c.hasVisibleChildren||b.hasVisibleChildren)});a.loopLevels(this,function(f,h){var i,s,H;if(!d&&!h.hasVisibleChildren)return a.SKIP;i=c.node(f);i||(i=p({visibility:4,connectorPlacement:0,parentId:null,actualItemType:0},h),c.add(null,f,i));S=R=0;if(null!=
(B=c.indexOf(f)))R=B,S=c.countSiblings(f)-B-1;s=[];a.loopChildren(this,f,function(a,b){if(d||b.hasVisibleChildren){e=p({parentId:f,actualItemType:b.itemType},b);switch(i.actualItemType){case 7:case 8:case 6:switch(e.actualItemType){case 7:case 8:case 6:e.actualItemType=2;break;case 0:e.actualItemType=1}}switch(e.actualItemType){case 5:q(i,e),e.connectorPlacement=5,H=p({visibility:4}),c.add(H.id,e.id,e),e=H;case 8:case 2:g=c.parent(f);if(i.connectorPlacement&2)v=m(c,r.navigationFamily,i),c.add(g.id,
e.id,e,v+1),e.connectorPlacement=6,e.gravity=2;else if(i.connectorPlacement&8)u=l(c,r.navigationFamily,i),c.add(g.id,e.id,e,u),e.connectorPlacement=12,e.gravity=1;else switch(b.adviserPlacementType){case 2:v=m(c,r.navigationFamily,i);c.add(g.id,e.id,e,v+1);e.connectorPlacement=6;e.gravity=2;break;default:u=l(c,r.navigationFamily,i),c.add(g.id,e.id,e,u),e.connectorPlacement=12,e.gravity=1}switch(e.actualItemType){case 8:null!=i.parentId?q(c.node(i.parentId),e):q(i,e,!0);break;case 2:q(i,e)}break;case 4:q(i,
e),e.connectorPlacement=5,H=p({visibility:4}),c.add(H.id,e.id,e),e=H;case 1:null===i.visualAggregatorId&&n(c,i,!1);switch(b.adviserPlacementType){case 2:c.add(f,e.id,e,0);e.connectorPlacement=6;e.gravity=2;break;default:c.add(f,e.id,e),e.connectorPlacement=12,e.gravity=1}1==e.actualItemType&&q(i,e);break;case 0:s.push(e);q(i,e);break;case 7:case 6:g=c.parent(f);if(i.connectorPlacement&2)c.add(g.id,e.id,e,R),e.connectorPlacement=6,e.gravity=2;else if(i.connectorPlacement&8)c.add(g.id,e.id,e,c.countChildren(g.id)-
S),e.connectorPlacement=12,e.gravity=1;else{switch(b.adviserPlacementType){case 2:c.add(g.id,e.id,e,R);e.gravity=2;break;default:c.add(g.id,e.id,e,c.countChildren(g.id)-S),e.gravity=1}switch(e.actualItemType){case 6:e.connectorPlacement=5;break;case 7:e.connectorPlacement=4}}null!=i.parentId?q(c.node(i.parentId),e):q(i,e,!0)}}});switch(i.actualItemType){case 7:case 8:case 6:break;default:T=[],null!=(g=c.parent(f))&&c.loopChildrenRange(this,g.id,R,c.countChildren(g.id)-S,function(b,c){if(c.id==f)T.push(c);
else switch(c.actualItemType){case 7:case 8:case 6:a.parentid(c.id)==f&&T.push(c)}}),1<T.length&&(V[f]=T)}O[f]=[];U[f]=[];var G=i,E=h.childrenPlacementType,I=O[f],K=U[f],y,D,J,L,W,X,N,M,Q=4==G.visibility&&0===G.connectorPlacement;switch(b.horizontalAlignment){case 0:case 1:D=3;break;case 2:D=2}0===E&&(E=k(a,G)?0===b.leavesPlacementType?3:b.leavesPlacementType:0===b.childrenPlacementType?2:b.childrenPlacementType);y=G;null!==G.visualAggregatorId&&(y=c.node(G.visualAggregatorId));3==E&&3>s.length&&
(E=2);switch(E){case 2:E=0;for(L=s.length;E<L;E+=1)G=s[E],I=a.node(G.id),c.add(y.id,G.id,G),G.connectorPlacement=(I.hideParentConnection?0:1)|(I.hideChildrenConnection?0:4),0===E&&(G.relationDegree=1);break;case 3:L=Math.min(b.maximumColumnsInMatrix,Math.ceil(Math.sqrt(s.length)));W=Math.ceil(s.length/L);X=Math.ceil(L/2);for(N=0;N<X;N+=1){D=y;for(M=0;M<W;M+=1){G=j(s,2*N,M,L);E=j(s,2*N+1,M,L);void 0===I[M]&&(I[M]=[],K[M]=[]);null!==G&&(0===N&&(G.relationDegree=1),c.add(D.id,G.id,G),G.connectorPlacement=
(Q?0:2)|4,G.gravity=2,K[M].push(G));if(null!==G||null!==E)J=p({visibility:4,connectorPlacement:Q?0:5}),c.add(D.id,J.id,J),I[M].push(J);null!==E&&(c.add(D.id,E.id,E),E.connectorPlacement=(Q?0:8)|4,E.gravity=1,K[M].push(E));D=J}}2<L&&(y.visualAggregatorId=null);break;case 1:E=0;for(L=s.length;E<L;E+=1){G=s[E];J=p({visibility:4,connectorPlacement:Q?0:5});switch(D){case 2:c.add(y.id,G.id,G);c.add(y.id,J.id,J);G.connectorPlacement=(Q?0:2)|4;G.gravity=2;break;case 3:c.add(y.id,J.id,J),c.add(y.id,G.id,G),
G.connectorPlacement=(Q?0:8)|4,G.gravity=1}I[E]=[J];K[E]=[G];y=J}break;default:throw"Children placement is undefined!";}});a.loopPostOrder(this,function(a){var b=c.node(a),d,e,g;if(null!=b){d=U[a];e=O[a];I=h(c,b);if(0<I&&(b.visualDepth=I+1,null!==b.visualAggregatorId)){s=c.node(b.visualAggregatorId);g=c.hasChildren(s.id);for(B=0;B<I-1;B+=1)s=n(c,s,!g)}g=0;var k=c.parent(b.id),j,m,l;if(null!==k){j=c.indexOf(b.id);for(m=1;null!=(l=c.getChild(k.id,j+m));)if(l.connectorPlacement&8)g=Math.max(g,i(c,l)),
m+=1;else break;for(m=1;null!=(l=c.getChild(k.id,j-m));)if(l.connectorPlacement&2)g=Math.max(g,i(c,l)),m+=1;else break}I=g;if(1<I){b.visualDepth+=I-1;g=c.hasChildren(a);s=b;for(B=0;B<I-1;B+=1)s=n(c,s,!g)}K=[];B=0;for(D=d.length;B<D;B+=1){L=d[B];H=K[B]=0;for(G=L.length;H<G;H+=1)K[B]=Math.max(K[B],i(c,L[H]))}B=0;for(D=K.length;B<D;B+=1)if(E=K[B],1<E){H=0;for(G=e[B].length;H<G;H+=1)if(J=e[B][H],c.hasChildren(J.id))for(I=E;1<I;)J=n(c,J,!1),I-=1}null!=V[a]&&f(c,b,V[a])}})}function f(a,b,c){var d,e,f,k,
h=0,j=[],i,l;e=0;for(f=c.length;e<f;e+=1)d=c[e],h=Math.max(h,d.visualDepth);e=0;for(f=c.length;e<f;e+=1){d=c[e];i=g(a,d);k=1;for(l=d;null!=l.visualAggregatorId;)l=a.node(l.visualAggregatorId),l.connectorPlacement=5,k+=1;for(;k<h;)i=n(a,i,!1),k+=1;j.push(g(a,i).id)}l=g(a,b);if(a.hasChildren(l.id)){i=c[Math.floor(c.length/2)];if(1<c.length&&0===c.length%2){e=a.parent(i.id);f=m(a,r.navigationFamily,i);k=a.getChild(e.id,f).gravity||a.getChild(e.id,f+1).gravity;i=p({visibility:4,connectorPlacement:i.connectorPlacement&
10,gravity:k});a.add(e.id,i.id,i,f+1);for(k=1;k<h;)i=n(a,i,!1),i.connectorPlacement=0,k+=1}e=0;for(f=c.length;e<f;e+=1)d=c[e],r.navigationFamily.loopChildren(this,b.id,function(a,c){switch(c.actualItemType){case 5:case 2:case 4:case 1:break;default:b.id!=d.id&&q(d,c)}return r.navigationFamily.SKIP});i=g(a,i);a.moveChildren(l.id,i.id)}i.partners=j}function g(a,b){for(var c=b;null!=c.visualAggregatorId;)c=a.node(c.visualAggregatorId);return c}function h(a,b){var c=0;null!=b.visualAggregatorId&&a.loopLevels(this,
b.id,function(d,e,g){if(b.visualAggregatorId==d)return a.SKIP;c=g+1});return c}function i(a,b){var c=0;a.loopLevels(this,b.id,function(a,b,d){c=d+1});return c+1}function j(a,b,c,d){0<d%2&&(b===d-1?b=a.length:b===d&&(b=d-1));b=c*d+b;return b>a.length-1?null:a[b]}function k(a,b){var c=!1,d=!0;a.loopChildren(this,b.id,function(b,e){c=!0;if(0===e.itemType&&a.hasChildren(b))return d=!1,!0});return c&&d}function m(a,b,c){var d=null,e={},g=a.parent(c.id);a.loopChildrenReversed(this,g.id,function(a,g,f){if(null===
d)a==c.id&&(d=-1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,g.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=f,!0});return d}function l(a,b,c){var d=null,e={},g=a.parent(c.id);a.loopChildren(this,g.id,function(a,g,f,k){if(null===d)a==c.id&&(d=k+1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,a,function(a,
c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=f,!0});return d}function n(a,b,c){c=p({visibility:4,visualAggregatorId:b.visualAggregatorId,connectorPlacement:4==b.visibility&&0===b.connectorPlacement||c?0:5});a.insert(b.id,c.id,c);b.visualAggregatorId=c.id;return c}function p(a,b){var c=new primitives.orgdiagram.TreeItem,d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);null!=b?(c.id=b.id,c.visibility=b.isVisible?0:4):(v+=1,c.id=v);return c}function q(a,b,c){var d=[];c||4==a.visibility||!u.hasOwnProperty(a.id)?
(c||d.push(a.id),r.navigationFamily.loopParents(this,a.id,function(a,b){if(4!=b.visibility&&(d.push(a),u.hasOwnProperty(a)))return r.navigationFamily.SKIP})):d.push(a.id);null!=r.navigationFamily.node(b.id)?r.navigationFamily.adopt(d,b.id):r.navigationFamily.add(d,b.id,b)}function s(a,b,c){a.loop(this,function(a){b[a]=[];c[a]=[]});a.loopPostOrder(this,function(a,d,e){var d=b[e],g=c[e],f=b[a],k=c[a],h;if(null!=e){d[0]||(d[0]=a);e=0;for(h=f.length;e<h;e+=1)d[e+1]||(d[e+1]=f[e]);g[0]=a;e=0;for(h=k.length;e<
h;e+=1)g[e+1]=k[e]}})}var r={visualTree:null,leftMargins:{},rightMargins:{},navigationFamily:null},v,u;return{process:function(){var d=a.getOrgTree(),g=c.getOptions();u=null!=b?b.getActiveItems():{};r.visualTree=primitives.common.tree();r.navigationFamily=primitives.common.family();v=a.getMaximumId();d.hasNodes()&&e(d,g,r.visualTree);r.leftMargins={};r.rightMargins={};s(r.visualTree,r.leftMargins,r.rightMargins);return!0},getVisualTree:function(){return r.visualTree},getNavigationFamily:function(){return r.navigationFamily},
getConnectionsFamily:function(){return r.connectionsFamily},getLeftMargins:function(){return r.leftMargins},getRightMargins:function(){return r.rightMargins}}};
primitives.common.AnnotationLabelTemplate=function(){var a=["div",{type:"checkbox",name:"checkbox","class":["bp-item","bp-corner-all","bp-connector-label"]}];return{template:function(){return a},getHashCode:function(){return"defaultAnnotationLabelTemplate"},render:function(a,c){var d=c.context;primitives.common.isArray(d.label)?(c.element.innerHTML="",c.element.appendChild(primitives.common.JsonML.toHTML(d.label))):c.element.innerHTML=d.label}}};
primitives.common.ButtonsTemplate=function(){var a=["div",{style:{position:"absolute"}}];return{template:function(){return a},getHashCode:function(){return"defaultButtonsTemplate"},render:function(a,c){var d=0,e,f=c.buttons,g,h;switch(c.renderingMode){case 0:for(h=0;h<f.length;h+=1)e=f[h],g=["button",{style:{position:"absolute",top:d+"px",left:"0px"},"class":["orgdiagrambutton","bp-button"],"data-buttonname":e.name},["span",{style:{width:e.size.width+"px",height:e.size.height+"px"},"class":["bp-icon",
e.icon]}]],c.element.appendChild(primitives.common.JsonML.toHTML(g)),d+=10+e.size.height}}}};
primitives.common.CheckBoxTemplate=function(a){var b=["div",["label",["nobr",["input",{type:"checkbox",name:"checkbox","class":"bp-selectioncheckbox"}],"\u00a0",["span",{name:"selectiontext","class":"bp-selectiontext"},a]]]];return{template:function(){return b},getHashCode:function(){return"defaultCheckBoxTemplate"},render:function(a,b){var e=b.element.firstChild.firstChild.firstChild;e.checked=b.isSelected;e.setAttribute("data-id",b.id);b.element.firstChild.firstChild.childNodes[2].setAttribute("data-id",
b.id)}}};primitives.common.CursorTemplate=function(a,b){var c=["div",{style:{width:b.itemSize.width+b.cursorPadding.left+b.cursorPadding.right+"px",height:b.itemSize.height+b.cursorPadding.top+b.cursorPadding.bottom+"px",borderWidth:b.cursorBorderWidth+"px"},"class":["bp-item","bp-corner-all","bp-cursor-frame"]}];return{template:function(){return c},getHashCode:function(){return"defaultCursorTemplate"},render:function(){}}};
primitives.common.DotHighlightTemplate=function(a,b){var c,d=b.minimizedItemCornerRadius+b.highlightPadding.left;c=["div",{style:{borderWidth:b.highlightBorderWidth+"px",MozBorderRadius:d+"px",WebkitBorderRadius:d+"px","-khtml-border-radius":d+"px",borderRadius:d+"px"},"class":["bp-item","bp-highlight-dot-frame"]}];return{template:function(){return c},getHashCode:function(){return"defaultDotHighlightTemplate"},render:function(){}}};
primitives.common.GroupTitleTemplate=function(a){var b={style:{fontSize:a.groupTitleFontSize,fontFamily:a.groupTitleFontFamily,fontWeight:a.groupTitleFontWeight,fontStyle:a.groupTitleFontStyle},"class":["bp-item","bp-corner-all","bp-grouptitle-frame"]},c=a.groupTitleVerticalAlignment,d="";switch(a.groupTitleOrientation){case 1:d="rotate(-90deg)";break;case 2:d="rotate(90deg)"}var e=a.groupTitleFontSize,f=a.groupTitleFontFamily,g=a.groupTitleFontWeight,h=a.groupTitleFontStyle,i=null;switch(a.groupTitleHorizontalAlignment){case 0:i=
"center";break;case 1:i="left";break;case 2:i="right"}d={fontSize:e,fontFamily:f,fontWeight:g,fontStyle:h,position:"absolute",padding:0,margin:0,textAlign:i,lineHeight:1,"-webkit-transform-origin":"center center","-moz-transform-origin":"center center","-o-transform-origin":"center center","-ms-transform-origin":"center center","-webkit-transform":d,"-moz-transform":d,"-o-transform":d,"-ms-transform":d,transform:d};switch(c){case 0:c=["div",{style:d,"class":["bp-title-content","bp-item","bp-corner-all"]}];
break;default:d.borderCollapse="collapse";d={style:d};e=null;switch(c){case 1:e="middle";break;case 0:e="top";break;case 2:e="bottom"}c=["table",d,["tbody",["tr",["td",{style:{verticalAlign:e,padding:0},"class":"bp-title-content"}]]]]}var j=["div",b,c];return{template:function(){return j},getHashCode:function(){return"defaultGroupTitleTemplate"},render:function(b,c){var d=c.context,e=d.groupTitleColor||a.groupTitleColor,g={},f=c.width,h=c.height;g.left=Math.round(f/2-h/2)+"px";g.top=Math.round(h/
2-f/2)+"px";g.width=h+"px";g.height=f+"px";g.maxWidth=g.width;g.maxHeight=g.height;primitives.common.JsonML.applyStyles(c.element.firstChild,g);d=d.groupTitle||"";d=d.replace(RegExp("\n","g"),"<br/>");switch(a.groupTitleVerticalAlignment){case 0:g=c.element.firstChild;break;default:g=c.element.firstChild.firstChild.firstChild.firstChild,g.style.borderCollapse="collapse"}g.style.color=primitives.common.highestContrast(e,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);g.textContent=d;primitives.common.JsonML.applyStyles(c.element,
{backgroundColor:e})}}};primitives.common.HighlightTemplate=function(a,b){var c=["div",{style:{borderWidth:b.highlightBorderWidth+"px"},"class":["bp-item","bp-corner-all","bp-highlight-frame"]}];return{template:function(){return c},getHashCode:function(){return"defaultHighlightTemplate"},render:function(){}}};
primitives.common.ItemTemplate=function(a,b){var c,d=new primitives.common.Size(b.itemSize);d.width-=2*b.itemBorderWidth;d.height-=2*b.itemBorderWidth;c=["div",{style:{borderWidth:b.itemBorderWidth+"px"},"class":["bp-item","bp-corner-all","bt-item-frame"]},["div",{name:"titleBackground",style:{top:"2px",left:"2px",width:d.width-4+"px",height:"18px"},"class":["bp-item","bp-corner-all","bp-title-frame"]},["div",{name:"title",style:{top:"1px",left:"4px",width:d.width-4-8+"px",height:"16px"},"class":["bp-item",
"bp-title"]}]],["div",{name:"photoBorder",style:{top:"24px",left:"2px",width:"50px",height:"60px"},"class":["bp-item","bp-photo-frame"]},["img",{name:"photo",alt:"",style:{width:"50px",height:"60px"}}]],["div",{name:"description",style:{top:"24px",left:"56px",width:d.width-4-56+"px",height:"74px"},"class":["bp-item","bp-description"]}]];return{template:function(){return c},getHashCode:function(){return"defaultItemTemplate"},render:function(b,c){var d=c.context,h=null!=d.itemTitleColor?d.itemTitleColor:
"#4169e1",i=primitives.common.highestContrast(h,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor),j=c.element,k=j.firstChild,m=j.childNodes[1].firstChild,l=k.firstChild,j=j.childNodes[2];primitives.common.JsonML.applyStyles(k,{backgroundColor:h});m.src=d.image;m.alt=d.title;primitives.common.JsonML.applyStyles(l,{color:i});l.textContent=d.title;j.textContent=d.description}}};
primitives.common.UserTemplate=function(a,b,c){var d=primitives.common.hashCode(JSON.stringify(b));return{template:function(){return b},getHashCode:function(){return d},render:function(b,d){if(null!=c)c(b,d);else{var g=d.context,h=null!=g.itemTitleColor?g.itemTitleColor:"#4169e1",i=primitives.common.highestContrast(h,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);primitives.common.getElementsByName(this,d.element,"photo",function(a){a.src=g.image;a.alt=g.title});primitives.common.getElementsByName(this,
d.element,"titleBackground",function(a){primitives.common.JsonML.applyStyles(a,{background:h})});primitives.common.getElementsByName(this,d.element,"title",function(a){primitives.common.JsonML.applyStyles(a,{color:i});a.textContent=g.title});primitives.common.getElementsByName(this,d.element,"description",function(a){a.textContent=g.description})}}}};
primitives.orgdiagram.BaseControl=function(a,b,c,d,e){function f(b){switch(b){case 1:g(!0,D);break;case 2:b=D;t.layout.forceCenterOnCursor=!1;t.tasks.process("HighlightItemOptionTask",null,b);t.graphics.end();break;default:m(t.layout);k(t.layout);var d=t.layout,b=t.name,f=primitives.common.getInnerSize(d.element),f=new primitives.common.Rect(0,0,f.width,f.height),w=new primitives.common.Rect(f),E=primitives.common.getFixOfPixelALignment(a);primitives.common.JsonML.appendDOM(d.element,primitives.common.JsonML.toHTML(["div",
{tabindex:0,style:{position:"relative",overflow:"auto","-webkit-overflow-scrolling":"touch",top:"0px",left:"0px",width:f.width+"px",height:f.height+"px",padding:"0px",marginBottom:"0px",marginRight:"0px",marginLeft:E.width+"px",marginTop:E.height+"px"},"class":b,$:function(a){d.scrollPanel=a}},["div",{style:primitives.common.mergeObjects({position:"absolute",overflow:"hidden"},w.getCSS()),"class":b,$:function(a){d.mousePanel=a}},["div",{style:primitives.common.mergeObjects({position:"absolute",overflow:"hidden"},
w.getCSS()),"class":["placeholder",b],$:function(a){d.placeholder=a}},["div",{style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",width:"0px",height:"0px"},"class":["calloutplaceholder",b],$:function(a){d.calloutPlaceholder=a}}]]]]));b=t.layout;b.mousePanel.addEventListener("mousemove",l);b.mousePanel.addEventListener("click",p);b.mousePanel.addEventListener("dblclick",q);b.mousePanel.addEventListener("change",n);b.scrollPanel.addEventListener("keydown",s);t.options.enablePanning&&
primitives.common.isChrome()&&(b.scrollPanel.draggable=!0,b.scrollPanel.addEventListener("dragstart",r),b.scrollPanel.addEventListener("drag",u),b.scrollPanel.addEventListener("dragend",u),b.scrollPanel.addEventListener("dragover",v));t.tasks=c(h,i,j,e);t.graphics=primitives.common.createGraphics(t.options.graphicsType,t.layout.element);t.graphics.debug=D;g(!0,D)}}function g(a,b){var d;t.layout.forceCenterOnCursor=a;t.tasks.process("OptionsTask",null,b);t.graphics.end();a&&(d=t.tasks.getTask("CenterOnCursorTask"),
d=d.getPlaceholderOffset(),t.layout.scrollPanel.scrollLeft=d.x,t.layout.scrollPanel.scrollTop=d.y)}function h(){return t.options}function i(){return t.graphics}function j(){return t.layout}function k(){if(null!=t.layout.scrollPanel){var a=t.layout.scrollPanel.parentNode;null!=a&&a.removeChild(t.layout.scrollPanel)}}function m(a){null!=a.mousePanel&&(a.mousePanel.removeEventListener("mousemove",l),a.mousePanel.removeEventListener("click",p),a.mousePanel.removeEventListener("dblclick",q),a.mousePanel.removeEventListener("change",
n));null!=a.scrollPanel&&(a.scrollPanel.removeEventListener("keydown",s),a.scrollPanel.removeEventListener("dragstart",r),a.scrollPanel.removeEventListener("drag",u),a.scrollPanel.removeEventListener("dragend",u),a.scrollPanel.removeEventListener("dragover",v))}function l(a){var b=primitives.common.getElementOffset(t.layout.mousePanel),d=a.pageX-b.left,b=a.pageY-b.top,c=t.tasks.getTask("CreateTransformTask"),e=t.tasks.getTask("HighlightItemOptionTask");e.hasHighlightEnabled()&&(d=c.getTreeItemForMousePosition(d,
b,e.getGravityRadius()),x(a,d))}function n(a){var b=a.target,c=b.getAttribute("data-id");if(null!=c){var e=(t.options.selectedItems||[]).slice(),g=d(t,null,c,void 0),f=primitives.common.indexOf(e,c);z("onSelectionChanging",a,g);g.cancel||(0<=f?e.splice(f,1):e.push(c),t.options.selectedItems=e,0>f?b.setAttribute("checked","checked"):b.removeAttribute("checked"),z("onSelectionChanged",a,g))}}function p(a){var b=primitives.common.getElementOffset(t.layout.mousePanel),c=a.pageX-b.left,e=a.pageY-b.top,
g=t.tasks.getTask("CreateTransformTask"),b=t.tasks.getTask("CursorItemOptionTask"),f=t.tasks.getTask("HighlightItemOptionTask"),c=g.getTreeItemForMousePosition(c,e,f.getGravityRadius()),e=a.target;null!==c&&(primitives.common.hasClass(e,t.name+"button")||primitives.common.hasClass(e.parentNode,t.name+"button")?(b=primitives.common.hasClass(e,t.name+"button")?e:e.parentNode,b=b.getAttribute("data-buttonname"),e=d(t,null,c,b),z("onButtonClick",a,e)):"checkbox"===e.getAttribute("name")||"selectiontext"===
e.getAttribute("name")||(e=d(t,null,c,void 0),z("onMouseClick",a,e),!e.cancel&&b.hasCursorEnabled()&&(w(a,c),t.layout.scrollPanel.focus())))}function q(a){var b;b=t.tasks.getTask("HighlightItemTask").getHighlightTreeItem();null!==b&&(b=d(t,null,b,void 0),z("onMouseDblClick",a,b))}function s(a){var b=t.tasks.getTask("HighlightItemTask"),c=t.tasks.getTask("HighlightItemOptionTask"),d=t.tasks.getTask("CursorItemTask"),e=t.tasks.getTask("CursorItemOptionTask"),g=t.tasks.getTask("AlignDiagramTask"),f=
t.tasks.getTask("CreateTransformTask").getTransform(),k=null,h=null,i=t.layout;c.hasHighlightEnabled()&&e.hasCursorEnabled()?(k=b.getHighlightTreeItem(),null===k&&(k=d.getCursorTreeItem())):c.hasHighlightEnabled()?k=b.getHighlightTreeItem():e.hasCursorEnabled()&&(k=d.getCursorTreeItem());if(null!=k){switch(a.which){case 13:e.hasCursorEnabled()&&(w(a,k),a.preventDefault(),i.scrollPanel.focus());break;case 40:h=1;break;case 38:h=0;break;case 37:h=2;break;case 39:h=3}if(null!=h){for(d=!1;!d;)d=!0,h=
f.getOrientation(h),b=g.getNextItem(k,h),null!=b&&(a.preventDefault(),c.hasHighlightEnabled()?x(a,b):e.hasCursorEnabled()&&w(a,b));i.scrollPanel.focus()}}}function r(a){var b=t.layout.scrollPanel;A=new primitives.common.Point(a.clientX,a.clientY);y=new primitives.common.Point(b.scrollLeft,b.scrollTop);C=C||new Image;a.dataTransfer.setDragImage(C,0,0)}function v(a){a.preventDefault();a.dataTransfer.dropEffect="move"}function u(a){F=new primitives.common.Point(y.x-(a.clientX-A.x),y.y-(a.clientY-A.y));
null==B&&(B=window.setTimeout(function(){var a=t.layout.scrollPanel;a.scrollLeft=F.x;a.scrollTop=F.y;window.clearTimeout(B);B=null},50))}function x(a,b){var c=!0,e;null!==b?b!==t.options.highlightItem&&(e=d(t,t.options.highlightItem,b,void 0),t.options.highlightItem=b,z("onHighlightChanging",a,e),e.cancel?c=!1:(g(!1,!1),z("onHighlightChanged",a,e))):null!==t.options.highlightItem&&(e=d(t,t.options.highlightItem,null,void 0),t.options.highlightItem=null,z("onHighlightChanging",a,e),e.cancel?c=!1:(g(!1,
!1),z("onHighlightChanged",a,e)));return c}function w(a,b){var c;b!==t.options.cursorItem&&(c=d(t,t.options.cursorItem,b,void 0),t.options.cursorItem=b,z("onCursorChanging",a,c),c.cancel||(g(!0,D),z("onCursorChanged",a,c)))}function z(a,b,c){a=t.options[a];null!=a&&a(b,c)}var t={name:"orgdiagram",options:b,tasks:null,graphics:null,mouse:null,layout:{element:a,scrollPanel:null,mousePanel:null,placeholder:null,calloutPlaceholder:null,forceCenterOnCursor:!0}},A,y,F,C,B,D=!1;f();return{destroy:function(){m(t.layout);
k(t.layout);t.tasks=null;t.graphics=null},setOptions:function(a){for(var b in a)a.hasOwnProperty(b)&&(t.options[b]=a[b])},getOptions:h,setOption:function(a,b){return t.options[a]=b},getOption:function(a){return t.options[a]},update:f}};
primitives.orgdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,primitives.orgdiagram.TaskManagerFactory,primitives.orgdiagram.EventArgsFactory,{AnnotationLabelTemplate:primitives.common.AnnotationLabelTemplate,ButtonsTemplate:primitives.common.ButtonsTemplate,CheckBoxTemplate:primitives.common.CheckBoxTemplate,CursorTemplate:primitives.common.CursorTemplate,DotHighlightTemplate:primitives.common.DotHighlightTemplate,GroupTitleTemplate:primitives.common.GroupTitleTemplate,
HighlightTemplate:primitives.common.HighlightTemplate,ItemTemplate:primitives.common.ItemTemplate,UserTemplate:primitives.common.UserTemplate})};
primitives.orgdiagram.EventArgsFactory=function(a,b,c,d){var e=new primitives.orgdiagram.EventArgs,f=a.tasks.getTask("CombinedContextsTask"),g=a.tasks.getTask("AlignDiagramTask"),b=f.getConfig(b),h=f.getConfig(c);b&&null!=b.id&&(e.oldContext=b);h&&null!=h.id&&(e.context=h,null!==h.parent&&(e.parentItem=f.getConfig(h.parent)),f=primitives.common.getElementOffset(a.layout.mousePanel),a=primitives.common.getElementOffset(a.layout.element),c=g.getItemPosition(c),e.position=(new primitives.common.Rect(c.actualPosition)).translate(f.left,
f.top).translate(-a.left,-a.top));null!=d&&(e.name=d);return e};primitives.orgdiagram.getProcessDiagramConfig=function(){var a=function(){};return primitives.orgdiagram.TaskManagerFactory(a,a,a).getProcessDiagramConfig()};
primitives.orgdiagram.TaskManagerFactory=function(a,b,c,d){var e=new primitives.common.TaskManager;e.addDependency("options",a);e.addDependency("graphics",b);e.addDependency("layout",c);e.addDependency("templates",d);e.addDependency("defaultConfig",new primitives.orgdiagram.Config);e.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);e.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);e.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
e.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);e.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);e.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);e.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);e.addDependency("isFamilyChartMode",!1);e.addDependency("showElbowDots",!1);e.addDependency("null",
null);e.addDependency("foreground",2);e.addDependency("background",1);e.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");e.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");e.addTask("CurrentScrollPositionTask",["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");e.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,
"#000080");e.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");e.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,"#000080");e.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");e.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,
"#000080");e.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");e.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");e.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,"#000080");e.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,
"#000080");e.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");e.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");e.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");e.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");
e.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");e.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");e.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");e.addTask("ForegroundHighlightPathAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");e.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,
"#000080");e.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");e.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");e.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");e.addTask("CombinedContextsTask",
["ItemsOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");e.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");e.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");e.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ActiveItemsTask,"#00ffff");e.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,
"#00ffff");e.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");e.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");e.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");e.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");e.addTask("VisualTreeTask",
["OrgTreeTask","ActiveItemsTask","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");e.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");e.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");e.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],
primitives.orgdiagram.HighlightItemTask,"#00ffff");e.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");e.addTask("CursorNeighboursTask",["CursorItemTask","VisualTreeTask"],primitives.orgdiagram.CursorNeighboursTask,"#00ffff");e.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");e.addTask("SelectionPathItemsTask",["VisualTreeTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],
primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",
["ForegroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");e.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");e.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask VisualTreeTask VisualTreeLevelsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.orgdiagram.ItemsPositionsTask,"#ff0000");e.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask ActiveItemsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");e.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");e.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");e.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,
"#00ffff");e.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#008000");e.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");e.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics",
"ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");e.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");e.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");e.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");e.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");e.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");e.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),primitives.orgdiagram.DrawTreeItemsTask,"#008000");e.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask ItemTemplateParamsTask AlignDiagramTask".split(" "),
primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");e.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],primitives.orgdiagram.DrawConnectorsTask,"#008000");e.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],primitives.orgdiagram.DrawItemLabelsTask,"#008000");return e};
primitives.common.binarySearch=function(a,b,c,d){var e=null,f,c=c||0,g=d||a.length-1,h,i;if(0<a.length&&(i=a[c],e={index:c,item:i},d=b(i,c),0<d))if(f=Math.abs(d),i=a[g],d=b(i,g),0<=d)e={index:g,item:i};else{d=Math.abs(d);f>d&&(f=d,e={index:g,item:i});for(;c+1<g;)if(h=Math.round((c+g)/2),i=a[h],d=b(i,h),0===d){e={index:h,item:i};break}else 0<d?c=h:g=h,d=Math.abs(d),f>d&&(f=d,e={index:h,item:i})}return e};
primitives.common.SpatialIndex=function(a){function b(a,b){this.minimum=a;this.maximum=b;this.quadTree=primitives.common.QuadTree(2*b)}var c=[];a.sort(function(a,b){return a-b});switch(a.length){case 0:c.push(new b(0,1E6));break;case 1:var d=a[0];c.push(new b(0,d));break;case 2:d=a[0];a=a[1];a>2*d?(c.push(new b(0,d)),c.push(new b(d,a))):c.push(new b(0,a));break;default:for(var d=primitives.common.getLiniarBreaks(a),e=0,f=0;f<d.length;f+=1){var g=a[d[f]];c.push(new b(e,g));e=g}}return{addRect:function(a){for(var b=
Math.max(a.width,a.height),d=a.centerPoint(),e=0,g=c.length;e<g;e+=1){var f=c[e];if(b<=f.maximum||e==g-1){d.context=a;f.quadTree.addPoint(d);break}}},loopArea:function(a,b,d){if(null!=d)for(var e=0,g=c.length;e<g;e+=1){var f=c[e],n=new primitives.common.Rect(b);n.offset(f.maximum/2);f.quadTree.loopArea(this,n,function(c){c=c.context;if(b.overlaps(c))return d.call(a,c)})}},validate:function(){for(var a=!0,b=0,d=c.length;b<d;b+=1)var e=c[b],a=a&&e.quadTree.validate();return a},getPositions:function(a){for(var b=
[],d=0,e=c.length;d<e;d+=1)b=b.concat(c[d].quadTree.getPositions(a));return b}}};
primitives.common.SortedList=function(){function a(a,b){this.value=a;this.context=b;this.right=this.left=null;this.balance=0}function b(a){var b;if(2==a.balance){var e=a.right;b=e.balance;if(0<=b)c(e,a),1==e.balance?(a.balance=0,e.balance=0):(a.balance=-1,e.balance=1);else{var g=e.left;d(g,e);c(e,a);a.balance=0;switch(g.balance){case 1:e.balance=-1;g.balance=0;break;case 0:g.balance=0;e.balance=0;break;default:g.balance=1,e.balance=0}}}else if(-2==a.balance)if(b=a.left.balance,0>=b)e=a.left,d(e,a),
-1==e.balance?(a.balance=0,e.balance=0):(a.balance=1,e.balance=-1);else switch(e=a.left,g=e.right,c(g,e),d(e,a),a.balance=0,g.balance){case -1:g.balance=0;e.balance=1;break;case 0:g.balance=0;e.balance=0;break;default:g.balance=-1,e.balance=0}return b}function c(a,b){f(a,b);b.right=a.right;a.right=a.left;a.left=b.left;b.left=a}function d(a,b){f(a,b);b.left=a.left;a.left=a.right;a.right=b.right;b.right=a}function e(a,b){var c=null!=a.right?a.right:a.left;null!=b?b.value>a.value?b.left=c:b.right=c:
j=c}function f(a,b){var c=a.value;a.value=b.value;b.value=c;c=a.context;a.context=b.context;b.context=c}function g(a,b,c){if(null!=c){for(var d=[],e=null,e=j;null!=e;)e.value>=b||null==b?(d.push(e),e=e.left):e=e.right;for(;null!=(e=d.pop())&&!c.call(a,e.value,e.context);)for(e=e.right;null!=e;)if(null!=e.left)d.push(e),e=e.left;else{if(c.call(a,e.value,e.context))return;e=e.right}}}function h(a,b,c){if(null!=c){for(var d=[],e=null,e=j;null!=e;)e.value<=b||null==b?(d.push(e),e=e.right):e=e.left;for(;null!=
(e=d.pop())&&!c.call(a,e.value,e.context);)for(e=e.left;null!=e;)if(null!=e.right)d.push(e),e=e.right;else{if(c.call(a,e.value,e.context))return;e=e.left}}}function i(a){var b=[],c=0;if(null!=a)for(b.push(a);0<b.length;){for(var d=[],e=0;e<b.length;e+=1)a=b[e],null!=a.left&&d.push(a.left),null!=a.right&&d.push(a.right);b=d;c+=1}return c}var j=null;return{add:function(c,d,e,g){if(null==j)j=new a(c,d);else{for(var f=[],h=null,i=j;null!=i;)if(null!=h&&f.push(h),h=i,h.value==c)if(null!=g)g.call(e,h.context);
else throw"Structure does not support duplicates.";else i=h.value>c?h.left:h.right;f.push(h);d=new a(c,d);h.value>c?h.left=d:h.right=d;for(h=d;null!=(i=f.pop());){if(h.value<i.value)if(0>i.balance){i.balance-=1;b(i);break}else{if(0<i.balance){i.balance-=1;break}i.balance-=1}else if(0<i.balance){i.balance+=1;b(i);break}else{if(0>i.balance){i.balance+=1;break}i.balance+=1}h=i}}},remove:function(a){for(var c=[],d=j;null!=d;)if(d.value==a){if(null!=d.right&&null!=d.left){c.push(d);for(a=d.right;null!=
a.left;)c.push(a),a=a.left;var g=a;d.value=g.value;d.context=g.context;e(a,c[c.length-1]);c.push(a)}else e(d,c[c.length-1]),c.push(d);for(a=c.length-2;0<=a;a-=1)if(g=c[a],d=c[a+1],g.value>d.value)if(0<g.balance){if(g.balance+=1,0===b(g))break}else{if(0===g.balance){g.balance+=1;break}g.balance+=1}else if(0>g.balance){if(g.balance-=1,0===b(g))break}else{if(0===g.balance){g.balance-=1;break}g.balance-=1}break}else c.push(d),d=d.value>a?d.left:d.right},loopForward:g,loopBackward:h,nextContext:function(a){var b=
null;g(this,a,function(a,c){b=c;return!0});return b},previousContext:function(a){var b=null;h(this,a,function(a,c){b=c;return!0});return b},validate:function(){if(null!=j)for(var a=[j];0<a.length;){for(var b=[],c=0;c<a.length;c+=1){var d=a[c];if(null==d.value||null!=d.left&&(b.push(d.left),d.left.value>=d.value)||null!=d.right&&(b.push(d.right),d.right.value<=d.value))return!1;if(d.balance!=i(d.right)-i(d.left))return console.log("Disbalanced node: "+d.value+" - "+JSON.stringify(j)),!1}a=b}return!0}}};
primitives.common.RMQ=function(a){function b(b,e){var g=Math.floor(Math.log(e-b+1)/d);return a[c[b][g]]<=a[c[e-(1<<g)+1][g]]?c[b][g]:c[e-(1<<g)+1][g]}for(var c=[],d=Math.log(2),e,f=0,g=a.length;f<g;f+=1)c[f]=[f];e=1;for(g=a.length;1<<e<g;e+=1)for(f=0;f+(1<<e)-1<g;f+=1)c[f][e]=a[c[f][e-1]]<a[c[f+(1<<e-1)][e-1]]?c[f][e-1]:c[f+(1<<e-1)][e-1];return{getRangeMinimumIndex:b,getRangeMinimum:function(d,c){return a[b(d,c)]}}};
primitives.common.QuadTree=function(a){function b(a,b,d,c){this.x=a;this.y=b;this.scale=d;this.size=c;this.quadrants=[];this.points=[]}function c(a){var d=a.size/2;a.quadrants=[new b(a.x,a.y,a.scale-1,d),new b(a.x+d,a.y,a.scale-1,d),new b(a.x,a.y+d,a.scale-1,d),new b(a.x+d,a.y+d,a.scale-1,d)];for(var d=0,c=a.points.length;d<c;d+=1){var e=a.points[d];a.quadrants[a.getQuadrantIndex(Math.floor(e.x),Math.floor(e.y))].points.push(e)}a.points=null}var d=Math.max(1,Math.floor(Math.log(a)/Math.log(2))),e=
8,f=256,g=null,g=new b(0,0,e,f);b.prototype.notEnclosed=function(a){return this.x<a.x||this.x+this.size>a.x+a.width||this.y<a.y||this.y+this.size>a.y+a.height?!0:!1};b.prototype.overlaps=function(a){return this.x+this.size<a.x||a.x+a.width<this.x||this.y+this.size<a.y||a.y+a.height<this.y?!1:!0};b.prototype.getQuadrantIndex=function(a,b){var d=this.scale-1;return a>>d&1|(b>>d&1)<<1};return{addPoint:function(a){for(var i=Math.max(Math.floor(a.x),Math.floor(a.y));f<=i;){e+=1;f*=2;var j=new b(0,0,e,
f);c(j);j.quadrants[0]=g;g=j}var i=Math.floor(a.x),j=Math.floor(a.y),k=g;if(0>i||0>j)throw"Negative values are not supported in the quad tree.";for(;(null==k.points||0<k.points.length)&&!(k.scale==d&&null!=k.points);)null!=k.points&&0<k.points.length&&c(k),k=k.quadrants[k.getQuadrantIndex(i,j)];k.points.push(a)},loopArea:function(a,b,d){var c,e,f;if(null!=d)for(var n=[g],p=[];0<n.length||0<p.length;){var q=[],s=[];e=0;for(f=n.length;e<f;e+=1)if(c=n[e],c.overlaps(b))if(c.notEnclosed(b))if(null==c.points)for(var r=
0;4>r;r+=1)q.push(c.quadrants[r]);else for(var r=0,v=c.points.length;r<v;r+=1){var u=c.points[r];if(b.contains(u)&&d.call(a,u))return}else p.push(c);e=0;for(f=p.length;e<f;e+=1)if(c=p[e],null==c.points)for(r=0;4>r;r+=1)s.push(c.quadrants[r]);else{r=0;for(v=c.points.length;r<v;r+=1)if(d.call(a,c.points[r]))return}n=q;p=s}},validate:function(){for(var a=[g];0<a.length;){for(var b=[],d=0,c=a.length;d<c;d+=1){var e=a[d],f=new primitives.common.Rect(e.x,e.y,e.size,e.size);if(null!=e.points&&0<e.quadrants.length)return!1;
if(null==e.points)for(f=0;4>f;f+=1)b.push(e.quadrants[f]);else for(var n=0,p=e.points.length;n<p;n+=1)if(!f.contains(e.points[n]))return!1}a=b}return!0},getPositions:function(a){for(var b=[],d=[g];0<d.length;){for(var c=[],e=0,f=d.length;e<f;e+=1){var n=d[e],p=new primitives.common.Rect(n.x,n.y,n.size,n.size);p.context={isHighlighted:!1};null!=a&&(a.overlaps(p)&&null!=n.points&&0<n.points.length)&&(p.context.isHighlighted=!0);b.push(p);for(p=0;4>p;p+=1){var q=n.quadrants[p];null!=q&&c.push(q)}}d=
c}return b}}};
primitives.common.pile=function(){function a(a,b,c,g){this.context=c;this.from=a;this.to=b;this.offset=null;this.direction=g}function b(a,c,f,g,h){if(a>=c.length)return 0;if(f.hasOwnProperty(a))return f[a];for(var i=c[a],j=b(a+1,c,f,g,h),k=a+1;k<c.length&&!(c[k].from>=i.to);)k+=1;c=1+b(k,c,f,g,h);c>j?(f[a]=c,g[a]=k,h[a]=!0):(f[a]=j,g[a]=a+1,h[a]=!1);return f[a]}var c=[];return{add:function(b,e,f){b<e?c.push(new a(b,e,f,1)):c.push(new a(e,b,f,-1))},resolve:function(a,e){var f,g,h,i,j,k,m=0;if(null!=
e){i=c.slice(0);i.sort(function(a,b){return a.from-b.from});for(j=[];0<i.length;){f={};g={};h={};b(0,i,f,g,h);f=[];j[m]=[];for(k=0;g.hasOwnProperty(k);)h[k]&&(f.push(k),j[m].push(i[k])),k=g[k];for(k=f.length-1;0<=k;k-=1)i.splice(f[k],1);m+=1}for(h=0;h<m;h+=1){f=j[h];for(k=0;k<f.length;k+=1)if(g=f[k],e.call(a,g.from,g.to,g.context,h,m,g.direction))return m}}return m}}};
primitives.common.mergeSort=function(a,b,c){var d=null,e,f,g,h,i,j,k,m,l,n,p,q;switch(a.length){case 0:d=[];break;default:d=[];for(g=0;g<a.length;g+=1){e=a[g];f=[];j=d.length;k=e.length;i=h=0;p=l=n=m=null;0<j&&(m=d[h],n=!b?m:b(m));0<k&&(l=e[i],p=!b?l:b(l));for(q=null;h<j||i<k;)if(h>=j){if(!c||q!=l)f.push(l),q=l;i+=1;i<k&&(l=e[i],p=!b?l:b(l))}else if(i>=k){if(!c||q!=m)f.push(m),q=m;h+=1;h<j&&(m=d[h],n=!b?m:b(m))}else if(n<p){if(!c||q!=m)f.push(m),q=m;h+=1;h<j&&(m=d[h],n=!b?m:b(m))}else{if(!c||q!=l)f.push(l),
q=l;i+=1;i<k&&(l=e[i],p=!b?l:b(l))}d=f}}return d};
primitives.common.LinkedHashItems=function(){function a(a,b){if(e.hasOwnProperty(a))throw"Duplicate segments are not supported!";e[a]=b;f[a]=null;null==i?(h=a,g[a]=null):(f[i]=a,g[a]=i);i=a}function b(a,b){if(e.hasOwnProperty(a))throw"Duplicate segments are not supported!";e[a]=b;g[a]=null;null==h?(i=a,f[a]=null):(g[h]=a,f[a]=h);h=a}function c(a,b,c,d){var n;null==c&&(c=a?h:i);if(null!=b)for(;null!=c;){n=e[c];if(null!=n&&b(n,c))break;c=c==d?null:a?f[c]:g[c]}}function d(a,b,d){c(!0,a,b,d)}var e={},
f={},g={},h=null,i=null;return{add:a,item:function(a){return e[a]},nextKey:function(a){return f[a]},prevKey:function(a){return g[a]},startKey:function(){return h},endKey:function(){return i},unshift:b,insertAfter:function(c,d,h){if(e.hasOwnProperty(d))throw"Duplicate segments are not supported!";if(null==c)b(d,h);else{var i=f[c];null==i?a(d,h):(e[d]=h,f[c]=d,f[d]=i,g[i]=d,g[d]=c)}},remove:function(a){var b=g[a],c=f[a];null!=b?f[b]=c:h=c;null!=c?g[c]=b:i=b;delete e[a];delete f[a];delete g[a]},isEmpty:function(){return null==
h},attach:function(b){b.iterate(function(b,c){a(c,b)})},iterate:d,iterateBack:function(a,b,d){c(!1,a,b,d)},empty:function(){e={};f={};g={};i=h=null},toArray:function(){var a=[];d(function(b){a.push(b)});return a},validate:function(a){var b,c;for(b in e)if(e.hasOwnProperty(b)&&(!f.hasOwnProperty(b)||!g.hasOwnProperty(b)))return null!=a&&(a.message="Orphant key found!"),!1;if(!e.hasOwnProperty(h)||!e.hasOwnProperty(i))return null!=a&&(a.message="Start or end values are missing!"),!1;for(b in f)if(f.hasOwnProperty(b)){if(!e.hasOwnProperty(b)||
!g.hasOwnProperty(b))return null!=a&&(a.message="Orphant key found!"),!1;if((c=f[b])&&!f.hasOwnProperty(c))return null!=a&&(a.message="Next key not found!"),!1}for(b in g)if(g.hasOwnProperty(b)){if(!e.hasOwnProperty(b)||!f.hasOwnProperty(b))return null!=a&&(a.message="Orphant key found!"),!1;if((c=g[b])&&!g.hasOwnProperty(c))return null!=a&&(a.message="Prev key not found!"),!1}return!0}}};
primitives.common.LCA=function(a){var b=[],c=[],d={},e;(function(){var f=0;a.loopEulerWalk(this,function(a,e,i){b.push(a);c.push(i);d.hasOwnProperty(a)||(d[a]=f);f+=1});e=primitives.common.RMQ(c)})();return{getLowestCommonAncestor:function(a,c){var h=d[a],i=d[c],h=h<i?e.getRangeMinimumIndex(h,i):e.getRangeMinimumIndex(i,h);return b[h]}}};
primitives.common.tree=function(a){function b(a,b,c){var d,e,g;if(null!=f[b]&&(b=h[b],null!=b)){e=0;for(g=b.length;e<g&&!(d=b[e],c.call(a,d,f[d],e,g-1));e+=1);}}function c(a){var b=null;null!=g[a]&&(b=g[a]);return b}function d(a,b){var c,d=a.length;for(c=0;c<d;c+=1)if(a[c]==b)return a.splice(c,1),d-1;return d}function e(a,d,e){if(null!=e&&f.hasOwnProperty(d)){var g=c(d);null!=g&&e.call(a,g,f[g])||(b(a,g,function(b,c){b!=d&&e.call(a,b,c)}),b(a,d,function(b,c){e.call(a,b,c)}))}}var f={},g={},h={},i=
{},j={};primitives.common.isObject(a)&&(f=primitives.common.cloneObject(a.nodes,!0),g=primitives.common.cloneObject(a.parents,!0),h=primitives.common.cloneObject(a.children,!1),i=primitives.common.cloneObject(a.roots,!1),j=primitives.common.cloneObject(a.rootChildren,!0));return{loop:function(a,b){var c;if(null!=b)for(c in f)if(f.hasOwnProperty(c)&&b.call(a,c,f[c]))break},loopLevels:function(a,b,c){var d=0,e=[],g,i,r,v,u;switch(arguments.length){case 2:i=b;break;case 3:g=b,i=c}if(null!=i){if(null==
g)for(r in j)j.hasOwnProperty(r)&&(e=e.concat(j[r]));else null!=h[g]&&(e=e.concat(h[g]));for(;0<e.length;){r=[];v=0;for(u=e.length;v<u;v+=1)switch(g=e[v],i.call(a,g,f[g],d)){case 1:r=[];break;case 2:break;default:null!=h[g]&&(r=r.concat(h[g]))}e=r;d+=1}}},loopParents:function(a,b,c,d){if(null!=f[b]&&null!=c&&!(!0===d&&c.call(a,b,f[b])))for(;null!=(b=g[b])&&!c.call(a,b,f[b]););},loopChildren:b,loopChildrenRange:function(a,b,c,d,e){var g;if(null!=f[b]&&(b=h[b],null!=b))if(c<d){c=Math.max(c,0);d=Math.min(d,
b.length-1);for(g=c;g<=d&&!(c=b[g],e.call(a,c,f[c],g,NaN));g+=1);}else{c=Math.min(c,b.length-1);d=Math.max(0,d);for(g=c;g>=d&&!(c=b[g],e.call(a,c,f[c],g,NaN));g-=1);}},loopChildrenReversed:function(a,b,c){var d,e,g;if(null!=f[b]&&(b=h[b],g=b.length-1,null!=b))for(e=g;0<=e&&!(d=b[e],c.call(a,d,f[d],e,g));e-=1);},loopPostOrder:function(a,b){var c=[],d,e,i;if(null!=b){for(d in j)j.hasOwnProperty(d)&&(c=c.concat(j[d]));for(;0<c.length;)if(d=c[c.length-1],d!=e&&null!=(i=h[d]))for(d=i.length-1;0<=d;d-=
1)c.push(i[d]);else if(c.pop(),e=g[d],b.call(a,d,f[d],e,f[e]))break}},loopPreOrder:function(a,b){var c=[],d,e,i,s;if(null!=b){for(d in j)j.hasOwnProperty(d)&&(c=c.concat(j[d]));for(;0<c.length;){d=c[c.length-1];if(d!=i&&(e=g[d],b.call(a,d,f[d],e,f[e])))break;if(d!=i&&null!=(s=h[d]))for(d=s.length-1;0<=d;d-=1)c.push(s[d]);else c.pop(),i=g[d]}}},loopEulerWalk:function(a,b){var c=[],d,e=[],i=0,s,r,v;if(null!=b){for(d in j)if(j.hasOwnProperty(d)){v=j[d];s=0;for(i=v.length;s<i;s+=1)c.push(v[s]),e.push(0)}for(;0<
c.length;){s=c.length-1;d=c[s];i=e[s];if(b.call(a,d,f[d],i))break;if(d!=r&&null!=(v=h[d]))for(s=v.length-1;0<=s;s-=1)c.push(v[s]),e.push(i+1),0<s&&(c.push(d),e.push(i));else c.pop(),e.pop(),r=g[d]}}},loopNeighbours:function(a,b,c,d){var g={},h=[b],i,j=0;if(null!=d&&f.hasOwnProperty(b))for(g[b]=!0;0<h.length;){i=[];for(var b=0,v=h.length;b<v;b+=1){var u=h[b];if(0<j&&d.call(a,u,f[u],j))return;j<c&&e(this,u,function(a){g.hasOwnProperty(a)||(i.push(a),g[a]=!0)})}h=i;j+=1}},zipUp:function(a,b,c,d){var e,
f;if(null!=d)for(;null!=b&&null!=c&&b!=c;){e=g[b];f=g[c];if(d.call(a,b,e,c,f))break;b=e;c=f}},parentid:c,parent:function(a){var b=null;null!=g[a]&&(b=f[g[a]]);return b},adopt:function(a,b){if(null!=f[a]&&null!=f[b])if(a!=b)i.hasOwnProperty(b)&&(d(j[i[b]],b)||delete j[i[b]],delete i[b]),g.hasOwnProperty(b)&&(d(h[g[b]],b)||delete h[g[b]]),g[b]=a,null!=h[a]?h[a].push(b):h[a]=[b];else throw"Item cannot be parent of itself!";else throw"Both parent and child should be in hierarchy!";},moveChildren:function(a,
c){null!=f[a]&&(null!=f[c]&&a!=c)&&null!=h[a]&&(b(this,a,function(a){g[a]=c}),h[c]=null!=h[c]?h[c].concat(h[a]):h[a],delete h[a])},node:function(a){return f[a]},add:function(a,b,c,d){var e;if(null!=f[b])throw"Node already exists";if(null!=b&&(null!=c&&null==f[b])&&(null!=f[a]?(g[b]=a,null!=h[a]?null==d?h[a].push(b):h[a].splice(d,0,b):h[a]=[b]):(i[b]=a,null!=j[a]?null==d?j[a].push(b):j[a].splice(d,0,b):j[a]=[b]),f[b]=c,null!=j[b])){h[b]=j[b];delete j[b];d=h[b];a=0;for(c=d.length;a<c;a+=1)e=d[a],delete i[e],
g[e]=b}},insert:function(a,c,d){null!=f[a]&&(null!=c&&null==f[c]&&null!=d)&&(f[c]=d,null!=h[a]&&(h[c]=h[a]),h[a]=[c],b(this,c,function(a){g[a]=c}),g[c]=a)},hasNodes:function(){return!primitives.common.isEmptyObject(j)},hasChildren:function(a){return null!=h[a]},countChildren:function(a){return null!=h[a]?h[a].length:0},countSiblings:function(a){a=c(a);return null!=a?h[a].length:0},indexOf:function(a){var b=c(a);return null!=b?primitives.common.indexOf(h[b],a):null},getChild:function(a,b){var c=null,
d;if(null!=(d=h[a]))c=f[d[b]];return c},arrangeChildren:function(a,b){var c,d,e,b=b.slice(0);if(null!=f[a])if(null!=h[a])if(h[a].length==b.length){d=0;for(e=b.length;d<e;d+=1)if(c=b[d],g[c]!=a)throw"Child "+c+" does not belong to given node!";h[a]=b}else throw"Collections of children don't match each other!";else if(0<b.length)throw"Collections of children don't match each other!";},validate:function(){var a=!0,b;for(b in i)if(i.hasOwnProperty(b)&&null!=i[b]){a=!1;break}return a},clone:function(){return primitives.common.family({nodes:f,
parents:g,children:h,roots:i,rootChildren:j})},BREAK:1,SKIP:2}};
primitives.common.graph=function(){function a(a,b,c,e){var f=[],m,l,n,p;f.push(b);c[b]=!0;if(null!=e)for(;0<f.length;){b=[];l=0;for(n=f.length;l<n;l+=1)for(p in m=f[l],e.call(a,m),m=d[m],m)m.hasOwnProperty(p)&&!c.hasOwnProperty(p)&&(c[p]=!0,b.push(p));f=b}}function b(a,b){var c=null,e,f,m,l=0,n=null;for(e in d)if(d.hasOwnProperty(e)){f=d[e];l=0;for(m in f)f.hasOwnProperty(m)&&(l+=b.call(a,f[m],e,m));if(l>n||null==n)c=e,n=l}return c}function c(a,c,i,j,k){var m={},l,n=[],p={},q=0,s,r,v,u,x,w;if(null!=
i&&null!=j&&(null==c&&(c=b(a,i)),null!=c)){j.call(a,c);m[c]=!0;q+=1;for(p[c]=null;0<q;){n=[];r=s=null;v={};for(l in m)if(m.hasOwnProperty(l)){u=d[l];c=!1;for(x in u)if(u.hasOwnProperty(x)&&!p.hasOwnProperty(x))switch(w=i.call(a,u[x],l,x),c=!0,k){case e:null==v[x]&&(v[x]=0);v[x]+=w;if(!r||v[x]>r)s=x,r=v[x];break;case f:if(v[x]=null==v[x]?w:Math.min(v[x],w),!r||v[x]<r)s=x,r=v[x]}c||n.push(l)}if(null==s)break;else m[s]=!0,q+=1,p[s]=!0,j.call(a,s);c=0;for(s=n.length;c<s;c+=1)delete m[n[c]],q-=1}}}var d=
{},e=1,f=2;return{addEdge:function(a,b,c){if((null==d[a]||null==d[a][b])&&null!=c)null==d[a]&&(d[a]={}),d[a][b]=c,null==d[b]&&(d[b]={}),d[b][a]=c},edge:function(a,b){var c=null;null!=d[a]&&d[a][b]&&(c=d[a][b]);return c},hasNode:function(a){return d.hasOwnProperty(a)},loopNodes:function(b,c,e){b={};if(null==c)for(c in d)d.hasOwnProperty(c)&&(b.hasOwnProperty[c]||a(this,c,b,e));else a(this,c,b,e)},loopNodeEdges:function(a,b,c){var e;if(null!=c&&(b=d[b],null!=b))for(e in b)b.hasOwnProperty(e)&&c.call(a,
e,b[e])},getSpanningTree:function(a,b){var c=primitives.common.tree(),e=primitives.common.FibonacciHeap(!0),f,m={},l,n,p,q;e.add(a,0,null);for(m[a]=null;null!=(f=e.extractRoot());){l=d[f.key];for(n in l)l.hasOwnProperty(n)&&!c.node(n)&&(p=null!=b?b(l[n]):l[n],q=e.getPriority(n),null==q?(e.add(n,p,null),m[n]=f.key.toString()):q<=p&&(e.setPriority(n,p),m[n]=f.key.toString()));c.add(m[f.key],f.key.toString(),{})}return c},getTotalWeightGrowthSequence:function(a,d,f){var j=b(a,d);c(a,j,d,f,e)},getMinimumWeightGrowthSequence:function(a,
b,d,e){c(a,b,d,e,f)},getShortestPath:function(a,b,c,e,f){var m=primitives.common.FibonacciHeap(!1),l={},n={},p,q,s={},r=0,v=0,l=0;for(q=c.length;l<q;l+=1)p=c[l],s.hasOwnProperty(p)||(r+=1,s[p]=!0);m.add(b,0,null);for(n[b]=null;null!=(b=m.extractRoot());){c=d[b.key];for(p in c)c.hasOwnProperty(p)&&(q=b.priority+(null!=e?e.call(a,c[p],b,p):1),l=m.getPriority(p),null!=l?l>q&&(m.setPriority(p,q),n[p]=b.key):n.hasOwnProperty(p)||(m.add(p,q,null),n[p]=b.key));if(s.hasOwnProperty(b.key)){l=[];for(c=b.key;null!=
c;)l.push(c),c=n[c];f.call(a,l,b.key);v+=1;if(v>=r)break}}}}};
primitives.common.getMergedRectangles=function(a,b,c){function d(a,b){this.start=a;this.startHead=null;this.end=b;this.endHead=null;this.overlap=function(a){return!(this.end<a.start||this.start>a.end)}}function e(a,b){this.x=a;this.ranges=b}function f(a,b){this.isHead=a;this.list=b;z.hasOwnProperty(b)||(z[b]=[]);z[b].push(this);this.add=function(a){a.from.equalTo(a.to)||(this.isHead?w[this.list].add(t,a):w[this.list].unshift(t,a),t+=1)};this.getTail=function(){return new f(!this.isHead,this.list)};
this.attach=function(a){if(this.list!=a.list){w[this.list].attach(w[a.list]);var b=z[a.list];delete z[a.list];if(null!=b)for(var c=0,d=b.length;c<d;c+=1){var e=b[c];e!=a&&(e.list=this.list,z[this.list].push(e))}}}}function g(a){w.push(new primitives.common.LinkedHashItems);return new f(a,w.length-1)}var h,i,j,k,m;b.sort(function(a,b){return a.x==b.x?a.y-b.y:a.x-b.x});var l=[],n={};h=0;for(i=b.length;h<i;h+=1){j=b[h];k=[j.x,j.right()];for(var p=0;p<k.length;p+=1){var q=k[p];m=n[q];null==m&&(m={x:q,
add:[],remove:[]},n[q]=m,l.push(m));q==j.x?m.add.push(h):m.remove.push(h)}}l.sort(function(a,b){return a.x-b.x});p={};n=[];n.push(new e(null,[]));h=0;for(i=l.length;h<i;h+=1){m=l[h];j=0;for(k=m.add.length;j<k;j+=1)p[m.add[j]]=!0;j=0;for(k=m.remove.length;j<k;j+=1)delete p[m.remove[j]];var q=[],s;for(s in p)p.hasOwnProperty(s)&&q.push(b[s]);q.sort(function(a,b){return a.y-b.y});var r=[],v=null,u=null;j=0;for(k=q.length;j<k;j+=1){var x=q[j];null==v?(v=x.y,u=x.bottom()):u<x.y?(r.push(new d(v,u)),v=x.y,
u=x.bottom()):u=Math.max(u,x.bottom())}null!=v&&r.push(new d(v,u));n.push(new e(m.x,r))}var w=[],z={},t=1;h=1;for(i=n.length;h<i;h+=1){b=n[h-1];m=n[h];for(j=s=0;s<b.ranges.length||j<m.ranges.length;)if(k=s<b.ranges.length?b.ranges[s]:null,p=j<m.ranges.length?m.ranges[j]:null,null==p){l=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(m.x,k.end),new primitives.common.Point(m.x,k.start),new primitives.common.Point(b.x,k.start)];for(r=1;r<l.length;r+=1)k.endHead.add(new primitives.common.Vector(l[r-
1],l[r]));k.endHead.attach(k.startHead);s+=1}else if(null==k)p.endHead=g(!0),p.endHead.add(new primitives.common.Vector(new primitives.common.Point(m.x,p.start),new primitives.common.Point(m.x,p.end))),p.startHead=p.endHead.getTail(),j+=1;else if(p.overlap(k)){l=[new primitives.common.Point(b.x,k.start),new primitives.common.Point(m.x,k.start),new primitives.common.Point(m.x,p.start)];for(r=1;r<l.length;r+=1)k.startHead.add(new primitives.common.Vector(l[r],l[r-1]));p.startHead=k.startHead;for(r=
!0;r;)if(r=!1,k.end>p.end)q=j+1<m.ranges.length?m.ranges[j+1]:null,null!=q&&q.overlap(k)&&(r=new primitives.common.Point(m.x,q.start),v=new primitives.common.Point(m.x,p.end),p.endHead=g(!0),p.endHead.add(new primitives.common.Vector(r,v)),q.startHead=p.endHead.getTail(),j+=1,p=q,r=!0);else if(q=s+1<b.ranges.length?b.ranges[s+1]:null,null!=q&&q.overlap(p)){l=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(m.x,k.end),new primitives.common.Point(m.x,q.start),new primitives.common.Point(b.x,
q.start)];for(r=1;r<l.length;r+=1)k.endHead.add(new primitives.common.Vector(l[r-1],l[r]));k.endHead.attach(q.startHead);s+=1;k=q;r=!0}l=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(m.x,k.end),new primitives.common.Point(m.x,p.end)];for(r=1;r<l.length;r+=1)k.endHead.add(new primitives.common.Vector(l[r-1],l[r]));p.endHead=k.endHead;s+=1;j+=1}else if(k.start<p.start){l=[new primitives.common.Point(b.x,k.end),new primitives.common.Point(m.x,k.end),new primitives.common.Point(m.x,
k.start),new primitives.common.Point(b.x,k.start)];for(r=1;r<l.length;r+=1)k.endHead.add(new primitives.common.Vector(l[r-1],l[r]));k.endHead.attach(k.startHead);s+=1}else p.endHead=g(!0),p.endHead.add(new primitives.common.Vector(new primitives.common.Point(m.x,p.start),new primitives.common.Point(m.x,p.end))),p.startHead=p.endHead.getTail(),j+=1}if(null!=c)for(h=0;h<w.length;h+=1)z.hasOwnProperty(h)&&(i=w[h],l=[],i.iterate(function(a){0==l.length&&l.push(a.from);l.push(a.to)}),c.call(a,l))};
primitives.common.getLiniarBreaks=function(a){function b(b,c){var e=0,g=(d[c]-d[b]+a[b])/(c-b+1),f=primitives.common.binarySearch(a,function(a){return g-a},b,c);f.item<=g?(e+=g*(f.index+1-b)-(d[f.index]-d[b]+a[b]),e+=d[c]-d[f.index]-g*(c-f.index)):(e+=g*(f.index-b)-(d[f.index]-d[b]-a[f.index]+a[b]),e+=d[c]-d[f.index]+a[f.index]-g*(c-f.index+1));return e}function c(a,c){var d;d=0+b(0,a);c>a+1&&(d+=b(a+1,c-1));return d+=b(c,e-1)}for(var d=[],e=a.length,f=0,g=0;g<e;g+=1)f+=a[g],d[g]=f;for(var f=0,g=
e-1,h=c(f,g);f<g+1;){var i=c(f+1,g),j=c(f,g-1);if(i<j){if(i>=h)break;f+=1;h=i}else{if(j>=h)break;g-=1;h=j}}return[f,g-1,e-1]};
primitives.common.getFamilyUnits=function(a){function b(){this.toIndex=this.fromIndex=0;this.items=[];this.hash={}}function c(a){this.id=a;this.parents=new b;this.children=new b;this.loopSiblings=function(a,b,c){this._loop(a,this.parents.hash.hasOwnProperty(b)?this.parents.items:this.children.items,c)};this.loopNonSiblings=function(a,b,c){this._loop(a,!this.parents.hash.hasOwnProperty(b)?this.parents.items:this.children.items,c)};this.loop=function(a,b){this._loop(a,this.parents.items,b);this._loop(a,
this.children.items,b)};this._loop=function(a,b,c){if(null!=c)for(var d=0,e=b.length;d<e;d+=1)c.call(a,b[d])};this.addParent=function(a){this._add(a,this.parents)};this.addChild=function(a){this._add(a,this.children)};this._add=function(a,b){b.hash.hasOwnProperty(a)||(b.items.push(a),b.hash[a]=!0)}}var d=[],e={},f,g;f=0;a.loop(this,function(b){var g=a.countChildren(b);if(0<g&&!e.hasOwnProperty(b)){var h=new c(f);f+=1;h.addParent(b);a.loopChildren(this,b,function(b){h.addChild(b);1==g&&a.loopParents(this,
b,function(b){h.addParent(b);e[b]=h;return a.SKIP});return a.SKIP});d.push(h);e[b]=h}});var h={};f=0;for(g=d.length;f<g;f+=1){var i=d[f];i.loop(this,function(a){h.hasOwnProperty(a)?h[a].push(i):h[a]=[i]})}return h};
primitives.common.getCrossingRectangles=function(a,b,c){function d(a,b,c,d){this.isStart=a;this.index=b;this.x=c;this.rect=d}function e(){this.count=0;this.rectangles={};this.add=function(a){this.count+=1;this.rectangles[a]=!0};this.remove=function(a){this.count-=1;delete this.rectangles[a];return 0==this.count}}function f(d,e,g,f,h){d.loopForward(this,e,function(d,e){if(d>g)return!0;for(var i in e.rectangles)if(e.rectangles.hasOwnProperty(i)){var j=f>i?f+"-"+i:i+"-"+f;k.hasOwnProperty(j)||(k[j]=
!0,c.call(a,h,b[i]))}})}if(null!=c){for(var g=[],h=0;h<b.length;h+=1){var i=b[h];g.push(new d(1,h,i.x,i));g.push(new d(0,h,i.right(),i))}g.sort(function(a,b){return a.x==b.x?b.isStart-a.isStart:a.x-b.x});for(var i=primitives.common.SortedList(),j={},k={},h=0;h<g.length;h+=1){var m=g[h],l=[m.rect.y,m.rect.bottom()];if(1==m.isStart){f(i,l[0],l[1],m.index,m.rect);for(var n=0,p=l.length;n<p;n+=1){var q=l[n],s=j[q];null==s&&(s=new e,j[q]=s,i.add(q,s));s.add(m.index)}}else{n=0;for(p=l.length;n<p;n+=1)q=
l[n],s=j[q],s.remove(m.index)&&(delete j[q],i.remove(q));f(i,l[0],l[1],m.index,m.rect)}}}};
primitives.common.FibonacciHeap=function(a){function b(a){this.key=a.key;this.priority=a.priority;this.item=a.item}function c(a,b,c){this.key=a;this.priority=b;this.item=c;this.degree=0;this.marked=!1;this.right=this.left=this.child=this.parent=null}function d(a,b){var c=n[a.right];b.right=a.right;b.left=a.key;a.right=b.key;c.left=b.key}function e(a){var b=n[a.left],c=n[a.right];b.right=c.key;c.left=b.key;a.right=a.key;a.left=a.key}function f(){var a=null;null!=l&&(a=new b(n[l]));return a}function g(){var a=
f();if(null!=a){var b=n[l],c=n[b.right];if(null!=b.child){var d=n[b.child],g=n[d.left];b.right=d.key;c.left=g.key;d.left=b.key;g.right=c.key;e(b);delete n[b.key];l=null;h(d.key)}else e(b),delete n[b.key],l=null,c.key!=b.key&&h(c.key)}return a}function h(b){var c=[],d,e={};for(d=b;!e.hasOwnProperty(d);){var b=n[d],g=b.right;e[d]=!0;for(b.parent=null;null!=(d=c[b.degree]);)(a?b.priority>d.priority:b.priority<d.priority)?i(b,d):(i(d,b),b=d),c[b.degree-1]=null;c[b.degree]=b;if(null==l||null==n[l]||(a?
n[l].priority<=b.priority:n[l].priority>=b.priority))l=b.key;d=g}}function i(b,c){b.degree+=1;e(c);var g=n[b.child];if(null!=g){if(d(g,c),a?g.priority<c.priority:g.priority>c.priority)b.child=c.key}else b.child=c.key;c.parent=b.key}function j(b,c){var d=n[b];if(a?d.priority>c:d.priority<c)throw"Priority increase is not supported";d.priority=c;if(null!=d.parent){var e=n[d.parent];if(a?e.priority<d.priority:e.priority>d.priority)k(e,d),m(e)}if(a?n[l].priority<d.priority:n[l].priority>d.priority)l=d.key}
function k(a,b){b.marked=!1;b.parent=null;b.right==b.key?a.child=null:(a.child=b.right,e(b));a.degree-=1;d(n[l],b)}function m(a){if(null!=a.parent)if(a.marked){var b=n[a.parent];k(b,a);m(b)}else a.marked=!0}var l=null,n={};return{add:function(b,e,g){if(n.hasOwnProperty(b))throw"Duplicate keys are not supported!";e=new c(b,e,g);n[b]=e;if(null==l)e.left=b,l=e.right=b;else if(g=n[l],d(g,e),a?g.priority<e.priority:g.priority>e.priority)l=b},getPriority:function(a){var b=null;n.hasOwnProperty(a)&&(b=n[a].priority);
return b},setPriority:j,heapRoot:f,extractRoot:g,deleteKey:function(b){j(b,a?Infinity:-1);g()},validate:function(){var a=0,b;for(b in n)if(n.hasOwnProperty(b)){var c=n[b],a=a+1;if(null!=c.child){if(!n.hasOwnProperty(c.child))throw"Child does not exists";var d=n[c.child];if(d.parent!=c.key)throw"Child references wrong parent";}if(null!=c.parent&&!n.hasOwnProperty(c.parent))throw"Parent does not exists";if(null!=c.left){if(!n.hasOwnProperty(c.left))throw"Left does not exists";d=n[c.left];if(d.right!=
c.key)throw"Left references wrong right";}if(null!=c.right){if(!n.hasOwnProperty(c.right))throw"Right does not exists";d=n[c.right];if(d.left!=c.key)throw"Right references wrong left";}}if(null==l&&0<a)throw"Orphans";if(null!=l){if(!n.hasOwnProperty(l))throw"Root node does not exists";c=n[l];if(null!=c.parent)throw"Root node has parent reference";b=[l];c={};for(d=0;0<b.length;){for(var e=[],g=0,f=b.length;g<f;g+=1)for(var h=n[b[g]];!c.hasOwnProperty(h.key);)c[h.key]=!0,d+=1,null!=h.child&&e.push(h.child),
h=n[h.right];b=e}if(a!=d)throw"Tree has loops or orpants";}}}};
primitives.common.FamilyMargins=function(){function a(a,c,d,e){this.left=a;this.right=c;this.leftIndex=d;this.rightIndex=e}this.items=[];this.add=function(b,c,d,e){switch(arguments.length){case 2:this.items.push(new a(-b/2,b/2,c,c));break;case 4:this.items.push(new a(b,c,d,e))}};this.merge=function(b,c){for(var d=this.getDistanceTo(b),e=0,f=0,g=this.items.length,h=b.items.length,i=Math.min(g,h),j=Math.max(g,h),k=0;k<i;k+=1){var m=this.items[g-1-k],l=b.items[h-1-k];0===k&&(f=m.right-m.left+(d||0)+
(c||0)+l.right-l.left,e=f/2+m.left,f=f/2-l.right);m.left-=e;m.right=l.right+f;m.rightIndex=l.rightIndex;this.items[j-1-k]=m}for(k=i;k<j;k+=1)m=this.items[g-1-k],l=b.items[h-1-k],null==m?this.items[j-1-k]=new a(l.left+f,l.right+f,l.leftIndex,l.rightIndex):(m.left-=e,m.right-=e);return d};this.attach=function(b,c){for(var d=this.getDistanceTo(b),e=c||0,f=this.items.length,g=b.items.length,h=Math.min(f,g),i=Math.max(f,g),j=0;j<h;j+=1){var k=this.items[f-1-j],m=b.items[g-1-j];0===j&&(e=k.right+(d||0)+
(c||0)-m.left);k.right=m.right+e;k.rightIndex=m.rightIndex;this.items[i-1-j]=k}for(j=h;j<i;j+=1)k=this.items[f-1-j],null==k&&(m=b.items[g-1-j],this.items[i-1-j]=new a(m.left+e,m.right+e,m.leftIndex,m.rightIndex));return d};this.getDistanceTo=function(a){var c=null,d=0,e=this.items.length,f=a.items.length,g=Math.min(e,f);if(0<g){for(var h=0;h<g;h+=1){var i=this.items[e-1-h],j=a.items[f-1-h];0===h?c=d=i.right-j.left:i.rightIndex<j.leftIndex&&(c=Math.max(c,i.right-j.left))}c-=d}return c};this.loop=function(a,
c){if(null!=c)for(var d=0,e=this.items.length;d<e;d+=1){var f=this.items[e-1-d];if(c.call(a,d,f.left,f.right,f.leftIndex,f.rightIndex))break}};this.getLeft=function(a){var c=this.items.length-1;if(c>=a)return this.items[c-a].left}};
primitives.common.FamilyAlignment=function(a,b,c,d){function e(a,b){var c=a[b];null==c&&(c=new primitives.common.FamilyMargins,a[b]=c);return c}function f(a,b,c,d,e,g,f,i){var r=g,v=g;c.loopSiblings(this,b,function(a){a=f.getItemPosition(a);r=Math.min(r,a);v=Math.max(v,a)});for(var u=g-1;u>=r;u-=1){var x=f.getItemAtPosition(d,u);if(!a.hasOwnProperty(x)){var w=f.getItemAtPosition(d,u+1);a[x]=a[w]-(h[x]/2+(i[w]||0)+h[w]/2)}}for(u=g+1;u<=v;u+=1)x=f.getItemAtPosition(d,u),a.hasOwnProperty(x)||(w=f.getItemAtPosition(d,
u-1),a[x]=a[w]+(h[w]/2+(i[x]||0)+h[x]/2));x=f.getItemAtPosition(d,r);w=a[x]-h[x]/2;x=f.getItemAtPosition(d,v);w+=a[x]+h[x]/2;w/=2;v=r=null;c.loopNonSiblings(this,b,function(a){a=f.getItemPosition(a);r=null!=r?Math.min(r,a):a;v=null!=v?Math.max(v,a):a});c=0;for(u=r;u<=v;u+=1)b=f.getItemAtPosition(e,u),c+=h[b],u>r&&(c+=i[b]||0);u=w-c/2;b=f.getItemAtPosition(e,r);a.hasOwnProperty(b)||(a[b]=u+h[b]/2);for(u=r+1;u<=v;u+=1)b=f.getItemAtPosition(e,u),a.hasOwnProperty(b)||(w=f.getItemAtPosition(e,u-1),a[b]=
a[w]+(h[w]/2+(i[b]||0)+h[b]/2))}var g,h={},i;null!=d&&c.loopItems(this,function(b,c){h[b]=d.call(a,b,c)});i=function(a,b){var c={},d={},g=null;b.loopLevelsReversed(this,function(f){var i=new primitives.common.FamilyMargins;null!=g&&(g.add(0,Number.MAX_VALUE),i.merge(g,0));var s=g=i;b.loopLevelItems(this,f,function(g,f,i){var n=e(d,g);n.add(h[g],i);switch(a.countParents(g)){case 0:null!=s&&(c[g]=s.attach(n));break;case 1:a.loopParents(this,g,function(b){b=e(d,b);c[g]=b.merge(n);s=b;return a.BREAK});
break;default:var p=0,q=null,t=null,A={};a.loopParents(this,g,function(c,d,e){if(0<e)return a.BREAK;p+=h[c];d=b.getItemPosition(c);q=null==q?d:Math.min(q,d);t=null==t?d:Math.max(t,d);A[d]=c});f=-p/2;for(i=q;i<=t;i+=1){var y=A[i],f=f+h[y]/2,F=e(d,y);F.attach(n,-f);s=F;f+=h[y]/2}}})});return c}(b,c);g=function(a,b,c){var d={},e=primitives.common.getFamilyUnits(a),g={};b.loopLevels(this,function(a){b.loopLevelItems(this,a,function(i,j,v){if(!d.hasOwnProperty(i)){j=0;if(0===v)null!=c[i]&&(j+=c[i]+h[i]/
2);else var u=b.getItemAtPosition(a,v-1),j=j+(d[u]+h[u]/2+(c[i]||0)+h[i]/2);d[i]=j}j=e[i];if(null!=j)for(u=0;u<j.length;u+=1){var x=j[u];g.hasOwnProperty(x.id)||(g[x.id]=!0,f(d,i,x,a,a+1,v,b,c))}})});return d}(b,c,i);return{getOffset:function(a){return g[a]}}};
primitives.common.family=function(a){function b(a,b,c,d){var e;if(null!=d&&(b=b[c],null!=b))for(e in b)if(b.hasOwnProperty(e)&&d.call(a,e,b[e]))break}function c(a,b){var c=!1;null!=y[a]&&null!=y[a][b]&&(delete y[a][b],F[a]-=1,delete C[b][a],B[b]-=1,F[a]||(delete y[a],delete F[a]),C[b]||(delete C[b],delete B[b],null==t[null]&&(t[null]={},A[null]=0),t[null][b]=!0,A[null]+=1),c=!0);return c}function d(a,b){var c;if(null!=b)for(c in D)if(D.hasOwnProperty(c)&&b.call(a,c,D[c]))break}function e(a,c,d,e){for(var g,
f,h={},i=0,j=!0;j;){g={};j=!1;for(f in d)if(d.hasOwnProperty(f)&&!h[f])switch(h[f]=!0,e.call(a,f,D[f],i)){case 1:g={};j=!1;break;case 2:break;default:b(this,c,f,function(a){h[a]||(j=g[a]=!0)})}d=g;i+=1}}function f(a,b,c){null!=c&&null!=b&&(null!=D[b]&&null!=y[b])&&e(a,y,y[b],c)}function g(a,b,c){null!=c&&null!=b&&(null!=D[b]&&null!=C[b])&&e(a,C,C[b],c)}function h(a,c,d,e,g,f){var h,i,j,k;if(null!=f){c=[];i={};for(h in D)D.hasOwnProperty(h)&&(i[h]=d[h]||0,i[h]||c.push(h));for(k=0;0<c.length;){j=[];
d=0;for(g=c.length;d<g;d+=1){h=c[d];if(f.call(a,h,D[h],k)){j=[];break}k+=1;b(this,e,h,function(a){i[a]-=1;0===i[a]&&j.push(a)})}c=j}}}function i(a,b){h(a,C,B,y,F,b)}function j(a,b){h(a,y,F,C,B,b)}function k(a,b,c,d,e,g,f,h,i){var j=!1,k,l;if(null!=D[a]&&null!=f[a]){j=!0;if(i){i=0;for(k=b.length;i<k;i+=1)if(l=b[i],null==D[l]||null==f[a][l])j=!1}if(j&&(null!=d&&(D[c]=d),null!=D[c])){e[c]||(e[c]={},g[c]=0);f[c]||(f[c]={},h[c]=0);e[c][a]||(e[c][a]=!0,g[c]+=1);f[a][c]||(f[a][c]=!0,h[a]+=1);i=0;for(k=b.length;i<
k;i+=1)l=b[i],c!=l&&(null!=f[a][l]&&(delete f[a][l],h[a]-=1),null!=e[l][a]&&(delete e[l][a],g[l]-=1),e[l][c]||(e[l][c]=!0,g[l]+=1),f[c][l]||(f[c][l]=!0,h[c]+=1))}}return j}function m(a,b,c,d){return k(a,b,c,d,C,B,y,F,!0)}function l(){this.key=this.id="";this.children=[];this.childrenHash={};this.processed=!1}function n(a){this.items=[];this.difference=this.weight=0;0<arguments.length&&(this.difference=a)}function p(a){var c=primitives.common.graph(),d,e,g,f,h,i,j,k,l={};for(d in a)a.hasOwnProperty(d)&&
b(this,y,d,function(d){if(!l.hasOwnProperty(d)){l[d]=!0;e=[];b(this,C,d,function(a){e.push(a)});g=0;for(h=e.length;g<h-1;g+=1)if(i=e[g],a.hasOwnProperty(i))for(f=g+1;f<h;f+=1)if(j=e[f],a.hasOwnProperty(j)){k=Math.abs(a[i].children.length-a[j].children.length);var m=c.edge(i,j);null==m&&(m=new n(k),c.addEdge(i,j,m));m.items.push(d);m.weight+=1}}});return c}function q(a,b){this.parentid=a;this.childid=b;this.key=a+","+b}function s(a,b){this.from=a;this.to=b;this.distance=0}function r(a){return F[a]||
0}function v(a){return B[a]||0}function u(a){var b=null,a=y[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null}function x(a){var b=null,a=C[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null}function w(a,b){this.parentid=a;this.childid=b;this.ids=[];this.nodes=[]}function z(){return primitives.common.family({roots:t,rootsCount:A,children:y,childrenCount:F,parents:C,parentsCount:B,nodes:D})}var t={},A={},y={},F={},C={},B={},D={};primitives.common.isObject(a)&&(t=primitives.common.cloneObject(a.roots,
!1),A=primitives.common.cloneObject(a.rootsCount,!0),y=primitives.common.cloneObject(a.children,!1),F=primitives.common.cloneObject(a.childrenCount,!0),C=primitives.common.cloneObject(a.parents,!1),B=primitives.common.cloneObject(a.parentsCount,!0),D=primitives.common.cloneObject(a.nodes,!0));return{add:function(a,c,d){var e,g,f={};if(!a||0===a.length)a=[null];if(null==D[c]&&null!=d){D[c]=d;d=0;for(e=a.length;d<e;d+=1)g=a[d],null==f[g]&&g!=c&&(f[g]=!0,null!=D[g]?(null==C[c]&&(C[c]={},B[c]=0),C[c][g]||
(C[c][g]=!0,B[c]+=1),null==y[g]&&(y[g]={},F[g]=0),y[g][c]||(y[g][c]=!0,F[g]+=1)):(null==t[g]&&(t[g]={},A[g]=0),t[g][c]||(t[g][c]=!0,A[g]+=1)));null!=t[c]&&(y[c]=t[c],F[c]=A[c],delete t[c],delete A[c],b(this,y,c,function(a){null==C[a]&&(C[a]={},B[a]=0);C[a][c]||(C[a][c]=!0,B[a]+=1)}))}},adopt:function(a,b){var c,d,e;if(null!=D[b]){c=0;for(d=a.length;c<d;c+=1)if(e=a[c],null==C[b]&&(C[b]={},B[b]=0),e!=b&&null!=D[e])C[b][e]||(C[b][e]=!0,B[b]+=1),null==y[e]&&(y[e]={},F[e]=0),y[e][b]||(y[e][b]=!0,F[e]+=
1);else throw"Item cannot be parent of itself and parent should exist in the structure!";}else throw"Child should be in hierarchy!";},bundleChildren:m,bundleParents:function(a,b,c,d){return k(a,b,c,d,y,F,C,B,!0)},optimizeReferences:function(a){var c={},d={},e={},g,h,i,j,m,n;m=0;var q=10,r;if(null!=a){for(g in D)m+=1,D.hasOwnProperty(g)&&(h=new l,b(this,y,g,function(a){h.children.push(a);h.childrenHash[a]=!0}),h.children.sort(),h.id=g,h.key=h.children.join(","),e[h.id]=h);for(q=Math.pow(10,m.toString().length);!primitives.common.isEmptyObject(e);){i=
{};r={};j=p(e);for(g in e)e.hasOwnProperty(g)&&(m=e[g],m.processed||(n=j.getSpanningTree(g,function(a){return a.weight*q+q-a.difference}),n.loopLevels(this,function(b,g){e[b].processed=!0;n.loopChildren(this,b,function(h,m){var n=j.edge(b,h),p=null,q,s,t,u,v,w;e[h].processed=!0;if(1<n.weight){s=n.items.join(",");if(c.hasOwnProperty(s))p=c[s];else{q=a();D[q.id]=q;p=new l;p.id=q.id;p.key=s;s=0;for(t=n.items.length;s<t;s+=1)w=n.items[s],p.children.push(w),p.childrenHash[w]=!0,r[w]=!0;p.children.sort();
c[p.key]=p;d[p.id]=p;i[p.id]=p;r[p.id]=p;u=p.children.slice(0);f(this,g.replacementItem||b,function(a){!p.childrenHash[a]&&null!=d[a]&&(v=!0,f(this,a,function(a){if(!p.childrenHash[a])return v=!1,1;if(!r.hasOwnProperty(a))return 2}),v&&u.push(a));return 2});k(g.replacementItem||b,u,p.id,q,C,B,y,F,!1);if(1>=(F[b]||0)&&null==g.replacementItem)g.replacementItem=p.id}if(p.id!=h&&(u=p.children.slice(0),f(this,m.replacementItem||h,function(a){null!=d[a]&&!p.childrenHash[a]&&(v=!0,f(this,a,function(a){return!p.childrenHash[a]?
(v=!1,1):(r.hasOwnProperty(a),2)}),v&&u.push(a));return 2}),k(m.replacementItem||h,u,p.id,null,C,B,y,F,!1),1>=(F[h]||0)&&null==m.replacementItem))m.replacementItem=p.id}})})));e=i}}},eliminateManyToMany:function(a){var c,d;for(c in y)y.hasOwnProperty(c)&&1<(F[c]||0)&&b(this,y,c,function(b){if(1<(B[b]||0))d=a(),m(c,[b],d.id,d)})},groupBy:function(a,b,c){if(null!=c){var d={},e;for(e in D){var g=F[e]||0;if(1>=(B[e]||0)&&1>=g){var g=x(e),f=u(e),h=g+" * "+f;d.hasOwnProperty(h)||(d[h]=new w(g,f));d[h].ids.push(e);
d[h].nodes.push(D[e])}}for(h in d)if(d.hasOwnProperty(h)&&(e=d[h],e.ids.length>=b&&c.call(a,e.parentid,e.childid,e.ids,e.nodes)))break}},getPlanarFamily:function(a){var b=new primitives.common.family,c,d;a.loopLevels(this,function(e){var g=new primitives.common.LinkedHashItems,h={},i={},j=[];a.loopLevelItems(this,e,function(b){f(this,b,function(c){var d=a.getItemPosition(c),e=new q(b,c);i[e.key]=e;var f=[];g.isEmpty()?g.add(d,[e]):(g.iterateBack(function(a,c){if(c<d)return g.insertAfter(c,d,[e]),
!0;if(c==d)return a.push(e),!0;for(var h=0,i=a.length;h<i;h+=1){var j=a[h];j.parentid!=b&&f.push(j)}}),g.startKey()>d&&g.unshift(d,[e]));h[e.key]=f;for(var c=0,j=f.length;c<j;c+=1)h[f[c].key].push(e);return 2});if(1==r(b)){var c=u(b);1==v(c)&&(c=new q(b,c),j.push(c.key))}});var e=[],k,l;for(l in h){k=h[l];var m=k.length;null!=e[m]?e[m].push(l):e[m]=[l]}m={};e.unshift(j);for(var n=0,p=e.length;n<p;n+=1){var s=e[n];if(null!=s){c=0;for(d=s.length;c<d;c+=1)if(l=s[c],!m.hasOwnProperty(l)){m[l]=!0;k=i[l];
null==b.node(k.parentid)&&b.add(null,k.parentid,{});null==b.node(k.childid)?b.add([k.parentid],k.childid,{}):b.adopt([k.parentid],k.childid);k=h[l];l=0;for(var t=k.length;l<t;l+=1)m[k[l].key]=!0}}}});return b},getFamilyWithoutGrandParentsRelations:function(){var a=new primitives.common.family,c={},e=[],g=0,f;for(f in C)C.hasOwnProperty(f)&&b(this,C,f,function(a){var b=c[f];null==b&&(b={},c[f]=b);b.hasOwnProperty(a)||(b=new s(f,a,g),e.push(b),c[f][a]=b)});for(;0<e.length;){for(var h=[],g=g+1,i=0,j=
e.length;i<j;i+=1){var k=e[i];f=k.to;C.hasOwnProperty(f)&&b(this,C,f,function(a){var b=c[k.from];null==b&&(b={},c[k.from]=b);if(b.hasOwnProperty(a))b[a].distance=g;else{var d=new s(f,a,g);h.push(d);b[a]=d}})}e=h}d(this,function(d,e){var g=[];b(this,C,d,function(a){0===c[d][a].distance&&g.push(a)});a.add(g,d,e)});return a},getGraph:function(){var a=primitives.common.graph(),c;for(c in y)y.hasOwnProperty(c)&&b(this,y,c,function(b){var d=a.edge(c,b);null==d&&(d=new n({}),a.addEdge(c,b,d))});return a},
removeNode:function(a){null!=D[a]&&(b(this,y,a,function(b){delete C[b][a];B[b]-=1;B[b]||(delete C[b],delete B[b],null==t[null]&&(t[null]={},A[null]=0),t[null][b]||(t[null][b]=!0,A[null]+=1))}),b(this,C,a,function(b){delete y[b][a];F[b]-=1;F[b]||(delete y[b],delete F[b])}),null!=t[null]&&null!=t[null][a]&&(delete t[null][a],A[null]-=1,A[null]||(delete t[null],delete A[null])),delete y[a],delete F[a],delete C[a],delete B[a],delete D[a])},removeRelation:function(a,b){var d=!1;null!=D[a]&&null!=D[b]&&
(d=c(a,b)||c(b,a));return d},node:function(a){return D[a]},loop:d,loopLevels:function(a,c,d){function e(){this.items={};this.minimumLevel=null}function g(a,b,c){var d=n[b];d||(d=new e,n[b]=d);d.addItemToLevel(a,c);u=null==u?c:Math.min(u,c);m[a]=c;k[a]=!0}var f=[],h={},k={},l=[],m={},n={},p,q,r,s,t,u=null;r=c?i:j;var v,w,x,z,A,B,F,P;e.prototype.addItemToLevel=function(a,b){var c=this.items[b];c?c.push(a):(c=[a],this.items[b]=c);this.minimumLevel=null==this.minimumLevel?b:Math.min(this.minimumLevel,
b)};if(null!=d){r(this,function(a,b,c){f.push(a);h[a]=c});r=0;for(v=f.length;r<v;r+=1)if(p=f[r],null==k[p]){l.push(p);for(g(p,r,0);0<l.length;){A=z=x=null;B=!c;F=[];p=0;for(s=l.length;p<s;p+=1)t=l[p],w=m[t],P=!1,c?(b(this,C,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||!B||x<b||x==b&&A>w-1))x=b,z=a,A=w-1,B=!0}),b(this,y,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||!B&&(x>b||x==b&&A<w+1)))x=b,z=a,A=w+1,B=!1})):(b(this,y,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||B||x<b||x==b&&
A<w+1))x=b,z=a,A=w+1,B=!1}),b(this,C,t,function(a){var b;if(!k[a]&&(P=!0,b=h[a],null==x||B&&(x>b||x==b&&A>w-1)))x=b,z=a,A=w-1,B=!0})),P&&F.push(t);null!=z&&(F.push(z),g(z,r,A));l=F}}l=!0;for(c=u;l;){p={};l=!1;for(q in n)if(n.hasOwnProperty(q)&&(r=n[q],s=r.items[r.minimumLevel-u+c],null!=s)){p[q]=r;l=!0;r=0;for(v=s.length;r<v;r+=1)if(t=s[r],d.call(a,t,D[t],c-u))return l=!1,!0}n=p;c+=1}}},loopTopo:i,loopTopoReversed:j,loopChildren:f,loopParents:g,findLargestRoot:function(){var a=null,b,c={},d={},e;
b=null;j(this,function(f,h){c.hasOwnProperty(f)||(c[f]={},d[f]=0);c[f][f]=!0;d[f]+=1;e=!0;g(this,h.id,function(a){var b,g;e=!1;c.hasOwnProperty(a)||(c[a]={},d[a]=0);if(!d[a]&&1==B[f])c[a]=c[f],d[a]=d[f];else for(g in b=c[f],b)b.hasOwnProperty(g)&&(c[a][g]=!0,d[a]+=1);return 2});if(e&&(!b||d[f]>b))b=d[f],a=f});return a},loopRoots:function(a,b){var c=null,d,e=0,f={},h={},i,k={},l={},m,n,p,q,r,s,t;j(this,function(a,b){f.hasOwnProperty(a)||(f[a]={},h[a]=0);f[a][a]=!0;h[a]+=1;i=!0;g(this,b.id,function(b){var c,
d;i=!1;f.hasOwnProperty(b)||(f[b]={},h[b]=0);if(!h[b]&&1==B[a])f[b]=f[a],h[b]=h[a];else for(d in c=f[a],c)c.hasOwnProperty(d)&&!f[b][d]&&(f[b][d]=!0,h[b]+=1);return 2});i&&(k[a]=!0,e+=1)});q={};for(p in k)if(k.hasOwnProperty(p))for(n in d=f[p],d)d.hasOwnProperty(n)&&(q[n]||(q[n]=[]),q[n].push(p.toString()));for(;0<e;){d=null;for(m in k)if(k.hasOwnProperty(m)&&(!d||h[m]<d))d=h[m],c=m;if(null!=c){null!=b&&b.call(a,c,D[c]);d=f[c];for(n in d)if(d.hasOwnProperty(n)&&!l[n]){p=q[n];s=0;for(t=p.length;s<
t;s+=1)r=p[s],h[r]-=1;l[n]=!0}delete k[c];e-=1}}},hasNodes:function(){return!primitives.common.isEmptyObject(D)},hasCommonChild:function(a){var c=!1,d,e,g,f,h,i,j;d={};f=g=0;for(h=a.length;f<h;f+=1)i=a[f],null!=D[i]&&!d[i]&&(d[i]=!0,g+=1);e={};for(i in d)d.hasOwnProperty(i)&&b(this,y,i,function(a){e[a]=e[a]?e[a]+1:1});for(j in e)if(e.hasOwnProperty(j)&&null!=C[j]&&(B[j]||0)==e[j]&&e[j]==g){c=!0;break}return c},loopNeighbours:function(a,b,c){var d={};null!=c&&(f(this,b,function(b,e){d.hasOwnProperty(b)||
(d[b]=null,c.call(a,b,e,1)&&(d[b]=2,g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,2)&&(d[b]=2));return d[b]})));return d[b]}),g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,1)&&(d[b]=2,f(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=!0,c.call(a,b,e,2)&&(d[b]=2));return d[b]})));return d[b]}))},countChildren:r,countParents:v,firstParent:x,firstChild:u,validate:function(a){function c(a){var b=0,d;if(null!=a)for(d in a)a.hasOwnProperty(d)&&(b+=1);return b}
var e,g;d(this,function(c){b(this,y,c,function(b){if(!C.hasOwnProperty(b)||!C[b].hasOwnProperty(c))return null!=a&&(a.message="Child #"+b+" does not reference parent #"+c),!1});b(this,C,c,function(b){if(!y.hasOwnProperty(b)||!y[b].hasOwnProperty(c))return null!=a&&(a.message="Parent #"+b+" does not reference child #"+c),!1})});for(e in C)if(C.hasOwnProperty(e)){if((B[e]||0)!=c(C[e]))return null!=a&&(a.message="Parents count for item #"+e+" missmatch."),!1;if(C.hasOwnProperty(e)&&!D.hasOwnProperty(e))return null!=
a&&(a.message="Orphant parents for item #"+e),!1}for(g in y)if(y.hasOwnProperty(g)){if((F[g]||0)!=c(y[g]))return null!=a&&(a.message="Children count for item "+g+" missmatch."),!1;if(y.hasOwnProperty(g)&&!D.hasOwnProperty(g))return null!=a&&(a.message="Orphant children of item "+g),!1}for(g in t)if(t.hasOwnProperty(g)){if((A[g]||0)!=c(t[g]))return null!=a&&(a.message="Root children count for item @"+g+" missmatch."),!1;b(this,t,g,function(b){if(!D.hasOwnProperty(b))return null!=a&&(a.message="Child #"+
b+"of root #"+g+" does not exists."),!1})}return!0},hasLoops:function(){var a=z();i(this,function(b){a.removeNode(b)});return a.hasNodes()},clone:z,BREAK:1,SKIP:2}};primitives.common.getMinimumCrossingRows=function(a,b,c){var d=a=null;if(null!=c){b.sort(function(a,b){return a.y-b.y});for(var e=0;e<b.length;e+=1){var f=b[e],g=f.bottom();null===a?(a=f.y,d=g):f.y>=d?(c.call(this.Arg,a),a=f.y,d=g):(f.y>a&&(a=f.y),g<d&&(d=g))}null!==a&&c.call(this.Arg,a)}};
primitives.common.TreeLevels=function(a){function b(a){this.context=a;this.items=[]}function c(a,b,c){this.context=a;this.positions={};this.positions[c]=b;this.endLevel=this.startLevel=c}function d(a){null==e[a]&&(e[a]=new b(null),g=null===g?a:Math.min(g,a),h=null===h?a:Math.max(h,a));return e[a]}var e=[],f={},g=null,h=null;primitives.common.isObject(a)&&(e=primitives.common.cloneObject(a.levels,!0),f=primitives.common.cloneObject(a.items,!0),g=primitives.common.cloneObject(a.minimum,!0),h=primitives.common.cloneObject(a.maximum,
!0));return{addlevel:function(a,b){d(a).context=b},hasLevel:function(a){return null!=e[a]},hasItem:function(a){return f.hasOwnProperty(a)},addItem:function(a,b,e){var g;f.hasOwnProperty(b)?(g=d(a),g.items.push(b),b=f[b],b.positions[a]=g.items.length-1,b.startLevel=Math.min(b.startLevel,a),b.endLevel=Math.max(b.endLevel,a)):(g=d(a),g.items.push(b),f[b]=new c(e,g.items.length-1,a))},getItemContext:function(a){var b=null;f.hasOwnProperty(a)&&(b=f[a].context);return b},getLevelIndex:function(a){return f.hasOwnProperty(a)?
f[a].startLevel:null},getEndLevelIndex:function(a){return f.hasOwnProperty(a)?f[a].endLevel:null},getItemPosition:function(a,b){var c=f[a];return null!=c?null!=b?c.positions[b]:c.positions[c.startLevel]:null},getItemAtPosition:function(a,b){var c=e[a],d=null;null!=c&&(d=c.items[b]);return d},loopLevels:function(a,b){var c,d;if(null!=b)for(c=g;c<=h&&!(d=e[c],null!=d&&b.call(a,c,d.context));c+=1);},loopLevelsReversed:function(a,b){var c,d;if(null!=b)for(c=h;c>=g&&!(d=e[c],null!=d&&b.call(a,c,d.context));c-=
1);},loopLevelItems:function(a,b,c){var d,g,h;if(null!=c&&(g=e[b],null!=g)){b=0;for(d=g.items.length;b<d&&!(h=g.items[b],c.call(a,h,f[h].context,b));b+=1);}},getLevelLength:function(a){var b=0,a=e[a];null!=a&&(b=a.items.length);return b},loopItems:function(a,b){var c,d,l,n,p,q,s={};if(null!=b)for(n=g;n<=h;n+=1)if(l=e[n],null!=l){p=l.items;c=0;for(d=p.length;c<d;c+=1)if(q=p[c],!s.hasOwnProperty(q)&&(s[q]=!0,b.call(a,q,f[q].context,c,n,l.context)))return}},binarySearch:function(a,b,c){var d=null;null!=
c&&(b=e[b],null!=b&&(d=primitives.common.binarySearch(b.items,function(b){return c.call(a,b,f[b].context)})));return d.item},loopMerged:function(a,b,c){var d,g,h,p=[];d=0;for(g=e.length;d<g;d+=1)h=e[d],null!=h&&p.push(h.items);h=primitives.common.mergeSort(p,b,!0);if(null!=c){d=0;for(g=h.length;d<g&&!(b=h[d],c.call(a,b,f[b].context));d+=1);}},loopFromItem:function(a,b,c,d,g){var h;if(f.hasOwnProperty(b)&&(b=f[b],h=g||b.startLevel,g=e[h].items,b=b.positions[h],null!=d))if(c)for(c=b-1;0<=c&&!(h=g[c],
d.call(a,h,f[h].context));c-=1);else{c=b+1;for(b=g.length;c<b&&!(h=g[c],d.call(a,h,f[h].context));c+=1);}},loopLevelsFromItem:function(a,b,c,d){if(f.hasOwnProperty(b)&&(b=f[b],null!=d))if(c)for(c=b.endLevel+1;c<=h&&!(b=e[c],d.call(a,c,null!=b?b.context:null));c+=1);else for(c=b.startLevel-1;c>=g&&!(b=e[c],d.call(a,c,null!=b?b.context:null));c-=1);},getPrevItem:function(a,b){var c=null;f.hasOwnProperty(a)&&(c=f[a],b=b||c.startLevel,c=e[b].items[c.positions[b]-1]);return c},getNextItem:function(a,b){var c=
null;f.hasOwnProperty(a)&&(c=f[a],b=b||c.startLevel,c=e[b].items[c.positions[b]+1]);return c},length:function(){return e.length},isEmpty:function(){return!e.length},clone:function(){return primitives.common.TreeLevels({levels:e,items:f,minimum:g,maximum:h})}}};
primitives.common.DependencyManager=function(){var a={};return{register:function(b,c){return a[b]=c},resolve:function(b,c,d){var e=[],f=d||{};return function(){for(var d=Array.prototype.slice.call(arguments,0),h=0;h<b.length;h+=1){var i=b[h];e.push(a.hasOwnProperty(i)&&""!==i?a[i]:d.shift())}e=e.concat(d);return c.apply(f||{},e)}}}};
primitives.common.KeyboardNavigationManager=function(){function a(a,b){this.itemid=a;this.row=b}function b(){if(null==g){var a=0;f=primitives.common.SortedList();primitives.common.getMinimumCrossingRows(this,e,function(b){f.add(b,a);a+=1});g=primitives.common.TreeLevels();e.sort(function(a,b){return a.horizontalCenter()-b.horizontalCenter()});for(var b=0,c=e.length;b<c;b+=1){var d=e[b];f.loopForward(this,d.y,function(a,b){if(a>d.bottom())return!0;g.addItem(b,d.context,d)})}}}function c(c){b();if(null==
h||h.itemid!=c)h=new a(c,g.getLevelIndex(c));return h}function d(a){var b=g.getItemContext(h.itemid).horizontalCenter(),c=h.itemid;g.loopLevelsFromItem(this,h.itemid,a,function(a){h.row=a;h.itemid=g.binarySearch(this,a,function(a,c){return b-c.horizontalCenter()});return!0});c==h.itemid&&(h.row=a?g.getEndLevelIndex(h.itemid):g.getLevelIndex(h.itemid))}var e=[],f,g,h=null;return{addRect:function(a,b){var c=new primitives.common.Rect(a);c.context=b;e.push(c)},prepair:b,getItemAbove:function(a){h=c(a);
d(!1);return h.itemid},getItemBelow:function(a){h=c(a);d(!0);return h.itemid},getItemOnLeft:function(a){h=c(a);a=g.getPrevItem(h.itemid,h.row);null!=a&&(h.itemid=a);return h.itemid},getItemOnRight:function(a){h=c(a);a=g.getNextItem(h.itemid,h.row);null!=a&&(h.itemid=a);return h.itemid},getNavigationLevels:function(){b();var a=[];g.loopLevels(this,function(b){var c=[];g.loopLevelItems(this,b,function(a){c.push(a)});a.push(c)});return a}}};
primitives.common.TaskManager=function(){function a(a,b,c,d){this.name=a;this.dependencies=b;this.factory=c;this.task=null;this.color=d}var b=new primitives.common.family,c=new primitives.common.DependencyManager,d=[];return{addTask:function(c,f,g,h){if(0<d.length)throw"Task Manager is already initialized";b.add(f,c,new a(c,f,g,h))},addDependency:function(a,b){if(0<d.length)throw"Task Manager is already initialized";c.register(a,b)},getTask:function(a){return(a=b.node(a))&&a.task},process:function(a,
f,g){var h=!1;0===d.length&&b.loopTopo(this,function(a,b){b.task=c.register(a,c.resolve(b.dependencies,b.factory)());d.push(b)});g&&console.log("-- process --");for(var i={},j=0,k=d.length;j<k;j+=1){var m=d[j],l=[];if(m.name==a||i.hasOwnProperty(m.name)){if(g)var n=performance.now();(h=m.task.process(g))&&b.loopChildren(this,m.name,function(a){i[a]=!0;g&&l.push(a);return b.SKIP});if(g)var p=performance.now();if(g){var q=Math.round(p-n,2);console.log(j+". "+m.name+(", "+q+" ms. ")+(h?" - forces: "+
l.toString():""))}}if(m.name==f)break}},getProcessDiagramConfig:function(){var a=new primitives.famdiagram.Config;0===d.length&&b.loopTopo(this,function(a,b){b.task=c.register(a,c.resolve(b.dependencies,b.factory)());d.push(b)});for(var f=0,g=d.length;f<g;f+=1){var h=d[f],i=new primitives.famdiagram.ItemConfig;i.id=h.name;i.title=primitives.common.splitCamelCaseName(h.name).join(" ");i.description=h.task.description||"";i.itemTitleColor=h.color;i.parents=[];b.loopParents(this,h.name,function(a){i.parents.push(a);
return b.SKIP});a.items.push(i)}return a}}};primitives.pdf.graphics=function(a){this._context=this._doc=a;this._dummyPlaceholder=new primitives.common.Placeholder};primitives.pdf.graphics.prototype.clean=function(){};primitives.pdf.graphics.prototype.resize=function(){};primitives.pdf.graphics.prototype.begin=function(){};primitives.pdf.graphics.prototype.end=function(){};primitives.pdf.graphics.prototype.reset=function(){};primitives.pdf.graphics.prototype.activate=function(){return this._dummyPlaceholder};
primitives.pdf.graphics.prototype.text=function(){};primitives.pdf.graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.pdf.graphics.prototype.polyline=function(a){var b=a.paletteItem.toAttr(),c,d=this._doc;d.save();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?d.roundedRect(Math.round(a.x)+0.5,Math.round(a.y)+0.5,a.width,a.height,Math.min(a.width,a.height)/2):0===a.cornerRadius?(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),
d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(c=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.roundedRect(Math.round(a.x)+0.5,Math.round(a.y)+0.5,a.width,a.height,c));break;case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+
0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});d.lineJoin("round");if(null!=b.lineType)switch(a=Math.round(b.lineWidth)||1,b.lineType){case 1:d.dash(a,2*a);break;case 2:d.dash(5*a,3*a)}void 0!==b.lineWidth&&void 0!==b.fillColor?d.lineWidth(b.lineWidth).fillOpacity(b.opacity).fillAndStroke(b.fillColor,b.borderColor):void 0!==b.lineWidth?d.lineWidth(b.lineWidth).stroke(b.borderColor):void 0!==b.fillColor&&d.fillOpacity(b.opacity).fillColor(b.fillColor);
d.restore()};primitives.pdf.graphics.prototype.rightAngleLine=function(){};primitives.pdf.graphics.prototype.template=function(a,b,c,d,e,f,g,h,i,j,k,m,l){c=0;null!==l&&void 0!==l.borderWidth&&(c=this.getPxSize(l.borderWidth));a=new primitives.common.Rect(a+e,b+f,g-c,h-c);null==m&&(m=new primitives.common.RenderEventArgs);null!==k&&k(this._doc,a,m)};
primitives.pdf.graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.pdf.famdiagram.Plugin=function(a){function b(){return f.options}function c(){return f.graphics}function d(){var a=new primitives.common.TaskManager;a.addDependency("options",b);a.addDependency("graphics",c);a.addDependency("defaultConfig",new primitives.famdiagram.Config);a.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);a.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);a.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
a.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);a.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);a.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);a.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);a.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
a.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);a.addDependency("isFamilyChartMode",!0);a.addDependency("showElbowDots",!0);a.addDependency("null",null);a.addDependency("foreground",2);a.addDependency("background",1);a.addTask("OptionsTask",["options"],primitives.famdiagram.OptionsTask,"#000000");a.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");a.addTask("ConnectorsOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");a.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");a.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.SpousesOptionTask,"#000080");a.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");a.addTask("TemplatesOptionTask",
["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");a.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");a.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");a.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NormalizeOptionTask,"#000080");a.addTask("LinePaletteOptionTask",
["OptionsTask","defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");a.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");a.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");a.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");a.addTask("SplitAnnotationsOptionTask",["OptionsTask"],
primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");a.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask",
"defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,
"#000080");a.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");a.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");a.addTask("LogicalFamilyTask",
["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");a.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,"#000080");a.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");a.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],
primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");a.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");a.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");a.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");a.addTask("AddSpousesTask",
["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");a.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","AddSpousesTask","defaultItemConfig"],primitives.famdiagram.NormalizeLogicalFamilyTask,"#ff0000");a.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.ReadTemplatesTask,"#00ffff");a.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,
"#00ffff");a.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff");a.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");a.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff");a.addTask("CheckBoxTemplateTask",
["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff");a.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff");a.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");a.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","NormalizeLogicalFamilyTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,
"#00ffff");a.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],primitives.orgdiagram.HighlightItemTask,"#00ffff");a.addTask("CursorItemTask",["CursorItemOptionTask","null"],primitives.orgdiagram.CursorItemTask,"#00ffff");a.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");a.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff");a.addTask("CurrentControlSizeTask",
["OptionsTask"],primitives.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff");a.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask NormalizeOptionTask NormalizeLogicalFamilyTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.famdiagram.ItemsPositionsTask,"#ff0000");a.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask null ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");a.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");a.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");a.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,
"#008000");a.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawBackgroundConnectorAnnotationTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorsTask,"#008000");a.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawForegroundHighlightPathAnnotationTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");a.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask DrawTreeItemsTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");a.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),
primitives.orgdiagram.DrawHighlightTask,"#008000");a.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawHighlightTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");return a}function e(){f.options.hasButtons=2;f.options.pageFitMode=5;f.options.autoSizeMaximum=new primitives.common.Size(1E5,1E5)}var f={name:"famdiagram",doc:null,options:a,tasks:null,graphics:null};return{draw:function(a,h,i){f.doc=a;f.tasks=d(b,c);f.graphics=new primitives.pdf.graphics(f.doc);f.graphics.debug=!1;e();f.doc.save();f.doc.translate(h,i);f.tasks.process("OptionsTask",null,!1);f.doc.restore();a=f.tasks.getTask("AlignDiagramTask");
return new primitives.common.Size(a.getContentSize())},getSize:function(){f.tasks=d(b,c);e();f.tasks.process("OptionsTask","AlignDiagramTask",!1);var a=f.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())}}};
primitives.pdf.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.pdf.ItemTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.pdf.HighlightTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onHighlightRender),
this.dotHighlightTemplate=new primitives.pdf.DummyTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.pdf.CursorTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onCursorRender))};primitives.pdf.orgdiagram.DummyCurrentControlSizeTask=function(){return{process:function(){return!0},getScrollPanelSize:function(){return new primitives.common.Size(800,600)},getOptimalPanelSize:function(){return new primitives.common.Size(775,575)}}};
primitives.pdf.orgdiagram.AnnotationLabelTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.AnnotationLabelTemplate);return a}}};primitives.pdf.orgdiagram.ButtonsTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.DummyTemplate);return a}}};
primitives.pdf.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.pdf.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};
primitives.pdf.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.pdf.GroupTitleTemplate(c.itemTitleFirstFontColor,c.itemTitleSecondFontColor));return b}}};
primitives.pdf.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,e,f=a.getOptions(),g=f.templates;b={};b.DefaultWidgetTemplate=new primitives.pdf.Template(f,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.pdf.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.pdf.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.pdf.DummyTemplate;b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)e=g[c],b[e.name]=new primitives.pdf.Template(f,e);return!0},getTemplate:function(a,d,e){return b[a]||b[d]||b[e]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask=function(){return{process:function(){return!0},isItemSelected:function(){return!1}}};
primitives.pdf.orgdiagram.Plugin=function(a){function b(){return f.options}function c(){return f.graphics}function d(){var a=new primitives.common.TaskManager;a.addDependency("options",b);a.addDependency("graphics",c);a.addDependency("defaultConfig",new primitives.orgdiagram.Config);a.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);a.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);a.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
a.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);a.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);a.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);a.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);a.addDependency("isFamilyChartMode",!1);a.addDependency("showElbowDots",!1);a.addDependency("null",
null);a.addDependency("foreground",2);a.addDependency("background",1);a.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");a.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");a.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");a.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,
"#000080");a.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");a.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");a.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");a.addTask("VisualTreeOptionTask",["OptionsTask",
"defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,"#000080");a.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");a.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");a.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");a.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,
"#00ffff");a.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],
primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundConnectorAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");a.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");a.addTask("CombinedContextsTask",["ItemsOptionTask"],primitives.orgdiagram.CombinedContextsTask,
"#00ffff");a.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");a.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.ReadTemplatesTask,"#00ffff");a.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");a.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff");a.addTask("CheckBoxTemplateTask",
["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff");a.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff");a.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");a.addTask("VisualTreeTask",["OrgTreeTask","null","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");a.addTask("VisualTreeLevelsTask",["VisualTreeTask",
"ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");a.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");a.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],primitives.orgdiagram.HighlightItemTask,"#00ffff");a.addTask("CursorItemTask",["CursorItemOptionTask","null"],primitives.orgdiagram.CursorItemTask,"#00ffff");a.addTask("SelectedItemsTask",
["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");a.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff");a.addTask("CurrentControlSizeTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff");a.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask VisualTreeTask VisualTreeLevelsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),
primitives.orgdiagram.ItemsPositionsTask,"#ff0000");a.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask CurrentControlSizeTask null ItemsPositionsTask isFamilyChartMode".split(" "),primitives.orgdiagram.AlignDiagramTask,"#ff0000");a.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");a.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,
"#00ffff");a.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");a.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,
"#008000");a.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");a.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawTreeItemsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorsTask,
"#008000");a.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundHighlightPathAnnotationTask".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask DrawForegroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");a.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");return a}function e(){f.options.hasButtons=2;f.options.pageFitMode=5;f.options.autoSizeMaximum=new primitives.common.Size(1E5,1E5)}var f={name:"orgdiagram",doc:null,options:a,tasks:null,
graphics:null};return{draw:function(a,h,i){f.doc=a;f.tasks=d(b,c);f.graphics=new primitives.pdf.graphics(f.doc);f.graphics.debug=!1;e();f.doc.save();f.doc.translate(h,i);f.tasks.process("OptionsTask",null,!1);f.doc.restore();a=f.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())},getSize:function(){f.tasks=d(b,c);e();f.tasks.process("OptionsTask","AlignDiagramTask",!1);var a=f.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())}}};
primitives.pdf.AnnotationLabelTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b,c){c=c.context;a.save();a.font("Helvetica",12).text(c.label,b.x,b.y,{width:b.width,height:b.height,align:"center"});a.restore()}}};
primitives.pdf.CheckBoxTemplate=function(a){return{template:function(){return{}},getHashCode:function(){return 0},render:function(b,c,d){d=d.isSelected?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAF/SURBVDhPpZM7rwFREMf/u4hEY5vVkigoSERiKwq1QqOh28R30QnFRqnSKHwFn0C37Sbi0SCE2KzE41wzd/feG48g91ftmdn5zznzkLLZrNhutzidTvgEv98PRVEgxeNx0e12EYvFcDweXfdjZFmGEIKDx+MxdF0HotGomEwmV/tnUAzFyqT8KrNHLpdDJpPBZrPh81UHLPAO7XYb6/Ua8/kcpmnC5/NBkqT3BJbLJRqNBgKBACqVCgqFAg6HA/veEiiVSlBVFZfLBZ1Ox7V+81KAMtPVV6sV+v2+a/2FBeg9RDqdhqZp/E1Mp1O0Wi32V6tVLuAtLEBvGw6HmM1m2O/3yOfz7CyXy4hEItz3ZrPJtr/8dIEKUiwWYRgGX3e32yGZTOJ8PnMBB4MBB9xy14VarcaZFosFQqEQHMdBvV5HIpFw/3gATZNlWTxdHr1eT4TDYZFKpVzLPRRDsU9HeTQaCdu23dM91wKzwNNlCgaDXINHW0pF95bpn+us4AsY2TIOZFyZ9AAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACjSURBVDhPrZNNCsQgDEY/f2q33sCCN+iNPJlXE2/gTtDiVBln1TJo+zZBJS+YELLvewkhIOeMETjnkFKCaK2LtRbbtiGl9H2+hlKKUkpLds7BGAMopYr3/rwfo+bUXFrN/yrfcXrQBDMwxkAImRfEGFucFnTeEdT/zNIEy7K0wyi/KfSGjPJoCp13BDM9EEK0eLtM67riOI7LLa0F+zI9XGeJDyTldfBA9FNyAAAAAElFTkSuQmCC";
b.save();b.image(d,c.x,c.y);b.font("Helvetica",11).text(a,c.x+20,c.y+4,{ellipsis:!0,width:c.width-4,height:c.height,align:"left"});b.restore()}}};primitives.pdf.CursorTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,d){a.save();a.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.cursorBorderWidth).stroke("#fbd850");a.restore()}}};
primitives.pdf.DummyTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(){}}};
primitives.pdf.GroupTitleTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(c,d,e){new primitives.text.Config;var e=e.context,f=e.groupTitleColor||"#4169e1",g=primitives.common.highestContrast(f,b,a);c.save();c.translate(d.width,0).rotate(90,{origin:[d.x,d.y]});c.fillColor(f).roundedRect(d.x,d.y,d.height-2,d.width,4).fill();c.fillColor(g).font("Helvetica",12).text(e.groupTitle,d.x+4,d.y+6,{ellipsis:!0,width:d.height-4,height:d.width-4,align:"center"});
c.restore()}}};primitives.pdf.HighlightTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,d){a.save();a.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.highlightBorderWidth).stroke("#fbcb09");a.restore()}}};
primitives.pdf.ItemTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(c,d,e){var e=e.context,f=null!=e.itemTitleColor?e.itemTitleColor:"#4169e1",g=primitives.common.highestContrast(f,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor),h=new primitives.common.Size(b.itemSize);h.width-=2*b.itemBorderWidth;h.height-=2*b.itemBorderWidth;c.save();c.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.itemBorderWidth).stroke("#dddddd");c.fillColor(f).roundedRect(d.x+
2,d.y+2,h.width-4,18,2).fill();c.fillColor(g).font("Helvetica",12).text(e.title,d.x+4,d.y+7,{ellipsis:!0,width:h.width-4-8,height:16,align:"left"});null!=e.image&&c.image(e.image,d.x+3,d.y+24);c.rect(d.x+3,d.y+24,50,60).stroke("#cccccc");c.fillColor("black").font("Helvetica",10).text(e.description,d.x+56,d.y+24,{ellipsis:!0,width:h.width-4-56,height:74,align:"left"});c.restore()}}};
primitives.pdf.LabelAnnotationTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b,c){c=c.context;a.save();a.font("Helvetica",12).text(c.title,b.x,b.y,{width:b.width,height:b.height,align:"center"});a.restore()}}};primitives.pdf.UserTemplate=function(a,b,c){return{template:function(){return{}},getHashCode:function(){return 0},render:function(d,e,f){null!=c?c(d,e,f):primitives.pdf.ItemTemplate(a,b).render(d,e,f)}}};
primitives.common.jQueryButtonsTemplate=function(){var a,b=jQuery("<ul></ul>");b.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){var c=jQuery(b.element),g=0,h,i=b.buttons,j,k,m;switch(b.renderingMode){case 0:for(m=0;m<i.length;m+=1)h=i[m],k=jQuery('<li data-buttonname="'+h.name+'"></li>').css({position:"absolute",top:g+
"px",left:"0px",width:h.size.width+"px",height:h.size.height+"px",padding:"3px"}).addClass("orgdiagrambutton"),c.append(k),j={icons:{primary:h.icon},label:h.label},""!=h.text&&(j.text=h.text),k.button(j),primitives.common.isNullOrEmpty(h.tooltip)||null!=k.tooltip&&k.tooltip({content:h.tooltip}),g+=10+h.size.height}}}};
primitives.orgdiagram.Widget=function(a,b,c,d){this.widgetEventPrefix="orgdiagram";this.options=new a;this.control=null;this.taskManagerFactory=b;this.eventArgsFactory=c;this.templates=d};primitives.orgdiagram.Widget.prototype._create=function(){this.element.addClass("ui-widget");this.control=primitives.orgdiagram.BaseControl(this.element[0],this._readOptions(this.options),this.taskManagerFactory,this.eventArgsFactory,this.templates)};primitives.orgdiagram.Widget.prototype.destroy=function(){this.control.destroy()};
primitives.orgdiagram.Widget.prototype.update=function(a){this.control.update(a)};primitives.orgdiagram.Widget.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}this.control.setOptions(this._readOptions(this.options))};
primitives.orgdiagram.Widget.prototype._readOptions=function(a){var b={},c=this,d;for(d in a)if(a.hasOwnProperty(d))switch(d){case "onHighlightChanged":case "onCursorChanged":case "onSelectionChanging":case "onButtonClick":case "onMouseClick":case "onMouseDblClick":b[d]=function(a){return function(b,d){c._trigger(a,b,d)}}(d);break;case "onItemRender":case "onCursorRender":case "onHighlightRender":b[d]=function(a){return function(b,d){d.element=jQuery(d.element);c._trigger(a,b,d)}}(d);break;case "onHighlightChanging":b[d]=
function(a,b){var d=c.control.getOptions();c.options.highlightItem=d.highlightItem;c._trigger("onHighlightChanging",a,b)};break;case "onCursorChanging":b[d]=function(a,b){var d=c.control.getOptions();c.options.cursorItem=d.cursorItem;c._trigger("onCursorChanging",a,b)};break;case "onSelectionChanged":b[d]=function(a,b){var d=c.control.getOptions();c.options.selectedItems=d.selectedItems;c._trigger("onSelectionChanged",a,b)};break;default:b[d]=a[d]}return b};
"undefined"!=typeof jQuery&&function(a){a.widget("ui.orgDiagram",new primitives.orgdiagram.Widget(primitives.orgdiagram.Config,primitives.orgdiagram.TaskManagerFactory,primitives.orgdiagram.EventArgsFactory,{AnnotationLabelTemplate:primitives.common.AnnotationLabelTemplate,ButtonsTemplate:primitives.common.jQueryButtonsTemplate,CheckBoxTemplate:primitives.common.CheckBoxTemplate,CursorTemplate:primitives.common.CursorTemplate,DotHighlightTemplate:primitives.common.DotHighlightTemplate,GroupTitleTemplate:primitives.common.GroupTitleTemplate,
HighlightTemplate:primitives.common.HighlightTemplate,ItemTemplate:primitives.common.ItemTemplate,UserTemplate:primitives.common.UserTemplate}))}(jQuery);primitives.callout.Config=function(){this.classPrefix="bpcallout";this.graphicsType=1;this.pointerPlacement=0;this.snapPoint=this.position=null;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.lineType=0;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3"};
primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout";this.options=new primitives.callout.Config;this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.callout.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element[0]);this.m_shape=new primitives.common.Callout(this.m_graphics)};primitives.callout.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.callout.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.callout.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.callout.Controller.prototype._redraw=function(){var a="pointerPlacement cornerRadius offset opacity lineWidth lineType pointerWidth borderColor fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.draw(this.options.snapPoint,this.options.position)};
primitives.callout.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpCallout",new primitives.callout.Controller)}(jQuery);
primitives.connector.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.connectorShapeType=this.connectorPlacementType=this.orientationType=0;this.toRectangle=this.fromRectangle=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=3;this.color="#000000";this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacementType=1};
primitives.connector.AnnotationLabelTemplate=function(a){var b=["div",{"class":["bp-item","bp-corner-all","bp-connector-label"]}];return{template:function(){return b},getHashCode:function(){return"defaultAnnotationLabelTemplate"},render:function(b,d){d.element.innerHTML=a.label}}};primitives.connector.Controller=function(){this.widgetEventPrefix="bpconnector";this.options=new primitives.connector.Config;this._labelTemplate=this._graphics=this._panelSize=this._placeholder=null};
primitives.connector.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.connector.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.connector.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.connector.Controller.prototype._createLayout=function(){this._panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this._placeholder=jQuery("<div></div>");this._placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this._placeholder.css(this._panelSize.getCSS());this._placeholder.addClass("placeholder");this._placeholder.addClass(this.widgetEventPrefix);this.element.append(this._placeholder);this._graphics=
primitives.common.createGraphics(this.options.graphicsType,this.element[0])};primitives.connector.Controller.prototype._cleanLayout=function(){null!==this._graphics&&this._graphics.clean();this._graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.connector.Controller.prototype._updateLayout=function(){this._panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this._placeholder.css(this._panelSize.getCSS())};
primitives.connector.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this._graphics.resize("placeholder",this._panelSize.width,this._panelSize.height),this._graphics.begin(),this._redraw(),this._graphics.end())};
primitives.connector.Controller.prototype._redraw=function(){var a=this.options,b,c,d=new primitives.common.Transform,e=this._graphics.activate("placeholder"),f=new primitives.common.PolylinesBuffer,g=this,h=primitives.orgdiagram.ConnectorAnnotationOffsetResolver();d.size=new primitives.common.Size(this._panelSize.width,this._panelSize.height);d.setOrientation(a.orientationType);if(null!=a.fromRectangle&&null!=a.toRectangle){var i=a.fromRectangle,j=a.toRectangle;d.transformRect(i.x,i.y,i.width,i.height,
!1,this,function(a,b,c,d){i=new primitives.common.Rect(a,b,c,d)});d.transformRect(j.x,j.y,j.width,j.height,!1,this,function(a,b,c,d){j=new primitives.common.Rect(a,b,c,d)});switch(a.connectorPlacementType){case 0:b=new primitives.common.ConnectorOffbeat;break;case 1:b=new primitives.common.ConnectorStraight}var k;d.transformRect(0,0,a.labelSize.width,a.labelSize.height,!1,this,function(a,b,c,d){k=new primitives.common.Size(c,d)});var m=null;d.transformRect(0,0,e.size.width,e.size.height,!1,this,function(a,
b,c,d){m=new primitives.common.Size(c,d)});var e=new primitives.common.PaletteItem({lineColor:a.color,lineWidth:a.lineWidth,lineType:a.lineType}),l=!primitives.common.isNullOrEmpty(a.label),i=(new primitives.common.Rect(i)).offset(a.offset),j=(new primitives.common.Rect(j)).offset(a.offset);b.draw(f,e,i,j,6*a.lineWidth,0,k,m,a.connectorShapeType,4,a.labelPlacementType,l,h,function(b){l&&null!=b&&(d.transformRect(b.x,b.y,b.width,b.height,!0,g,function(a,c,d,e){b=new primitives.common.Rect(a,c,d,e)}),
c=new primitives.common.RenderEventArgs,c.context=a,g._graphics.template(b.x,b.y,0,0,0,0,b.width,b.height,g._labelTemplate.template(),g._labelTemplate.getHashCode(),g._labelTemplate.render,c,null))});h.resolve()}f.transform(d,!0);this._graphics.polylinesBuffer(f)};
primitives.connector.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpConnector",new primitives.connector.Controller)}(jQuery);
"undefined"!=typeof jQuery&&function(a){a.widget("ui.famDiagram",new primitives.orgdiagram.Widget(primitives.famdiagram.Config,primitives.famdiagram.TaskManagerFactory,primitives.famdiagram.EventArgsFactory,{AnnotationLabelTemplate:primitives.common.AnnotationLabelTemplate,ButtonsTemplate:primitives.common.jQueryButtonsTemplate,CheckBoxTemplate:primitives.common.CheckBoxTemplate,CursorTemplate:primitives.common.CursorTemplate,DotHighlightTemplate:primitives.common.DotHighlightTemplate,GroupTitleTemplate:primitives.common.GroupTitleTemplate,
HighlightTemplate:primitives.common.HighlightTemplate,ItemTemplate:primitives.common.ItemTemplate,UserTemplate:primitives.common.UserTemplate,LabelAnnotationTemplate:primitives.common.LabelAnnotationTemplate}))}(jQuery);
primitives.shape.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.shapeType=this.orientationType=0;this.position=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4};
primitives.shape.AnnotationLabelTemplate=function(a){var b=["div",{"class":["bp-item","bp-corner-all","bp-connector-label"]}];return{template:function(){return b},getHashCode:function(){return"defaultAnnotationLabelTemplate"},render:function(b,d){d.element.innerHTML=a.label}}};primitives.shape.Controller=function(){this.widgetEventPrefix="bpshape";this.options=new primitives.shape.Config;this._labelTemplate=this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};
primitives.shape.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.shape.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.shape.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.shape.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element[0])};primitives.shape.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.shape.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};
primitives.shape.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.shape.Controller.prototype._redraw=function(){var a="orientationType shapeType offset lineWidth borderColor lineType labelSize labelOffset labelPlacement cornerRadius opacity fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");this.m_shape=new primitives.common.Shape(this.m_graphics);for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.hasLabel=!primitives.common.isNullOrEmpty(this.options.label);this.m_shape.labelTemplate=this._labelTemplate;this.m_shape.panelSize=
new primitives.common.Size(this.m_panelSize.width,this.m_panelSize.height);this.m_shape.draw(this.options.position)};primitives.shape.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpShape",new primitives.shape.Controller)}(jQuery);primitives.text.Config=function(){this.classPrefix="bptext";this.orientation=this.graphicsType=0;this.text="";this.verticalAlignment=1;this.horizontalAlignment=0;this.fontSize="16px";this.fontFamily="Arial";this.color="#000000";this.fontStyle=this.fontWeight="normal"};
primitives.text.Controller=function(){this.widgetEventPrefix="bptext";this.options=new primitives.text.Config;this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.text.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element[0])};primitives.text.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.text.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};
primitives.text.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.text.Controller.prototype._redraw=function(){var a=this.m_graphics.activate("placeholder");this.m_graphics.text(a.rect.x,a.rect.y,a.rect.width,a.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,{fontSize:this.options.fontSize,fontFamily:this.options.fontFamily,fontStyle:this.options.fontStyle,fontWeight:this.options.fontWeight,fontColor:this.options.color})};
primitives.text.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpText",new primitives.text.Controller)}(jQuery);
